diff --git a/language/bazel/visibility/BUILD.bazel b/language/bazel/visibility/BUILD.bazel
index 90389c1ab..443ce0aea 100644
--- a/language/bazel/visibility/BUILD.bazel
+++ b/language/bazel/visibility/BUILD.bazel
@@ -13,6 +13,7 @@ go_library(
         "//config",
         "//label",
         "//language",
+        "//merger",
         "//repo",
         "//resolve",
         "//rule",
diff --git a/language/bazel/visibility/lang.go b/language/bazel/visibility/lang.go
index b4ff82ccf..2971c4f66 100644
--- a/language/bazel/visibility/lang.go
+++ b/language/bazel/visibility/lang.go
@@ -18,6 +18,7 @@ package visibility
 import (
 	"github.com/bazelbuild/bazel-gazelle/config"
 	"github.com/bazelbuild/bazel-gazelle/language"
+	"github.com/bazelbuild/bazel-gazelle/merger"
 	"github.com/bazelbuild/bazel-gazelle/rule"
 )

@@ -66,6 +67,15 @@ func (*visibilityExtension) GenerateRules(args language.GenerateArgs) language.G
 	r := rule.NewRule("package", "")
 	r.SetAttr("default_visibility", cfg.visibilityTargets)

+	insertIndex := 0
+	for _, existingRule := range args.File.Rules {
+		if existingRule.Kind() != "package" {
+			insertIndex = existingRule.Index()
+			break
+		}
+	}
+	r.SetPrivateAttr(merger.UnstableInsertIndexKey, insertIndex)
+
 	res.Gen = append(res.Gen, r)
 	// we have to add a nil to Imports because there is length-matching validation with Gen.
 	res.Imports = append(res.Imports, nil)
