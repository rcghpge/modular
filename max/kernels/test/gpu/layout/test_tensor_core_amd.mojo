# ===----------------------------------------------------------------------=== #
# Copyright (c) 2025, Modular Inc. All rights reserved.
#
# Licensed under the Apache License v2.0 with LLVM Exceptions:
# https://llvm.org/LICENSE.txt
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
# ===----------------------------------------------------------------------=== #

from gpu import WARP_SIZE, lane_id
from gpu.host import DeviceContext
from layout import Layout, LayoutTensor
from layout._fillers import arange
from layout.tensor_builder import LayoutTensorBuild as tb
from layout.tensor_core import TensorCore
from gpu.host.info import MI300X
from test_tensor_core_amd_utils import test_load_and_mma_and_multiply_operands
from utils.index import Index, IndexList

alias fp8_dtype = DType.float8_e4m3fnuz if DeviceContext.default_device_info <= MI300X else DType.float8_e4m3fn
alias bf8_dtype = DType.float8_e5m2fnuz if DeviceContext.default_device_info <= MI300X else DType.float8_e5m2

# CHECK-LABEL: test_load_and_mma_f32_f32_16x16x4
# CHECK-LABEL: test_load_a
# CHECK: 0.0 4.0 8.0 12.0 16.0 20.0 24.0 28.0 32.0 36.0 40.0 44.0 48.0 52.0 56.0 60.0 1.0 5.0 9.0 13.0 17.0 21.0 25.0 29.0 33.0 37.0 41.0 45.0 49.0 53.0 57.0 61.0 2.0 6.0 10.0 14.0 18.0 22.0 26.0 30.0 34.0 38.0 42.0 46.0 50.0 54.0 58.0 62.0 3.0 7.0 11.0 15.0 19.0 23.0 27.0 31.0 35.0 39.0 43.0 47.0 51.0 55.0 59.0 63.0
# CHECK-LABEL: test_load_b
# CHECK: 0.0 1.0 2.0 3.0 4.0 5.0 6.0 7.0 8.0 9.0 10.0 11.0 12.0 13.0 14.0 15.0 16.0 17.0 18.0 19.0 20.0 21.0 22.0 23.0 24.0 25.0 26.0 27.0 28.0 29.0 30.0 31.0 32.0 33.0 34.0 35.0 36.0 37.0 38.0 39.0 40.0 41.0 42.0 43.0 44.0 45.0 46.0 47.0 48.0 49.0 50.0 51.0 52.0 53.0 54.0 55.0 56.0 57.0 58.0 59.0 60.0 61.0 62.0 63.0
# CHECK-LABEL: test_load_c
# CHECK: 0.0 16.0 32.0 48.0
# CHECK: 1.0 17.0 33.0 49.0
# CHECK: 2.0 18.0 34.0 50.0
# CHECK: 3.0 19.0 35.0 51.0
# CHECK: 4.0 20.0 36.0 52.0
# CHECK: 5.0 21.0 37.0 53.0
# CHECK: 6.0 22.0 38.0 54.0
# CHECK: 7.0 23.0 39.0 55.0
# CHECK: 8.0 24.0 40.0 56.0
# CHECK: 9.0 25.0 41.0 57.0
# CHECK: 10.0 26.0 42.0 58.0
# CHECK: 11.0 27.0 43.0 59.0
# CHECK: 12.0 28.0 44.0 60.0
# CHECK: 13.0 29.0 45.0 61.0
# CHECK: 14.0 30.0 46.0 62.0
# CHECK: 15.0 31.0 47.0 63.0
# CHECK: 64.0 80.0 96.0 112.0
# CHECK: 65.0 81.0 97.0 113.0
# CHECK: 66.0 82.0 98.0 114.0
# CHECK: 67.0 83.0 99.0 115.0
# CHECK: 68.0 84.0 100.0 116.0
# CHECK: 69.0 85.0 101.0 117.0
# CHECK: 70.0 86.0 102.0 118.0
# CHECK: 71.0 87.0 103.0 119.0
# CHECK: 72.0 88.0 104.0 120.0
# CHECK: 73.0 89.0 105.0 121.0
# CHECK: 74.0 90.0 106.0 122.0
# CHECK: 75.0 91.0 107.0 123.0
# CHECK: 76.0 92.0 108.0 124.0
# CHECK: 77.0 93.0 109.0 125.0
# CHECK: 78.0 94.0 110.0 126.0
# CHECK: 79.0 95.0 111.0 127.0
# CHECK: 128.0 144.0 160.0 176.0
# CHECK: 129.0 145.0 161.0 177.0
# CHECK: 130.0 146.0 162.0 178.0
# CHECK: 131.0 147.0 163.0 179.0
# CHECK: 132.0 148.0 164.0 180.0
# CHECK: 133.0 149.0 165.0 181.0
# CHECK: 134.0 150.0 166.0 182.0
# CHECK: 135.0 151.0 167.0 183.0
# CHECK: 136.0 152.0 168.0 184.0
# CHECK: 137.0 153.0 169.0 185.0
# CHECK: 138.0 154.0 170.0 186.0
# CHECK: 139.0 155.0 171.0 187.0
# CHECK: 140.0 156.0 172.0 188.0
# CHECK: 141.0 157.0 173.0 189.0
# CHECK: 142.0 158.0 174.0 190.0
# CHECK: 143.0 159.0 175.0 191.0
# CHECK: 192.0 208.0 224.0 240.0
# CHECK: 193.0 209.0 225.0 241.0
# CHECK: 194.0 210.0 226.0 242.0
# CHECK: 195.0 211.0 227.0 243.0
# CHECK: 196.0 212.0 228.0 244.0
# CHECK: 197.0 213.0 229.0 245.0
# CHECK: 198.0 214.0 230.0 246.0
# CHECK: 199.0 215.0 231.0 247.0
# CHECK: 200.0 216.0 232.0 248.0
# CHECK: 201.0 217.0 233.0 249.0
# CHECK: 202.0 218.0 234.0 250.0
# CHECK: 203.0 219.0 235.0 251.0
# CHECK: 204.0 220.0 236.0 252.0
# CHECK: 205.0 221.0 237.0 253.0
# CHECK: 206.0 222.0 238.0 254.0
# CHECK: 207.0 223.0 239.0 255.0
# CHECK-LABEL: test_load_d
# CHECK: 0.0 1.0 2.0 3.0 4.0 5.0 6.0 7.0 8.0 9.0 10.0 11.0 12.0 13.0 14.0 15.0
# CHECK: 0.0 1.0 2.0 3.0 4.0 5.0 6.0 7.0 8.0 9.0 10.0 11.0 12.0 13.0 14.0 15.0
# CHECK: 0.0 1.0 2.0 3.0 4.0 5.0 6.0 7.0 8.0 9.0 10.0 11.0 12.0 13.0 14.0 15.0
# CHECK: 0.0 1.0 2.0 3.0 4.0 5.0 6.0 7.0 8.0 9.0 10.0 11.0 12.0 13.0 14.0 15.0
# CHECK: 16.0 17.0 18.0 19.0 20.0 21.0 22.0 23.0 24.0 25.0 26.0 27.0 28.0 29.0 30.0 31.0
# CHECK: 16.0 17.0 18.0 19.0 20.0 21.0 22.0 23.0 24.0 25.0 26.0 27.0 28.0 29.0 30.0 31.0
# CHECK: 16.0 17.0 18.0 19.0 20.0 21.0 22.0 23.0 24.0 25.0 26.0 27.0 28.0 29.0 30.0 31.0
# CHECK: 16.0 17.0 18.0 19.0 20.0 21.0 22.0 23.0 24.0 25.0 26.0 27.0 28.0 29.0 30.0 31.0
# CHECK: 32.0 33.0 34.0 35.0 36.0 37.0 38.0 39.0 40.0 41.0 42.0 43.0 44.0 45.0 46.0 47.0
# CHECK: 32.0 33.0 34.0 35.0 36.0 37.0 38.0 39.0 40.0 41.0 42.0 43.0 44.0 45.0 46.0 47.0
# CHECK: 32.0 33.0 34.0 35.0 36.0 37.0 38.0 39.0 40.0 41.0 42.0 43.0 44.0 45.0 46.0 47.0
# CHECK: 32.0 33.0 34.0 35.0 36.0 37.0 38.0 39.0 40.0 41.0 42.0 43.0 44.0 45.0 46.0 47.0
# CHECK: 48.0 49.0 50.0 51.0 52.0 53.0 54.0 55.0 56.0 57.0 58.0 59.0 60.0 61.0 62.0 63.0
# CHECK: 48.0 49.0 50.0 51.0 52.0 53.0 54.0 55.0 56.0 57.0 58.0 59.0 60.0 61.0 62.0 63.0
# CHECK: 48.0 49.0 50.0 51.0 52.0 53.0 54.0 55.0 56.0 57.0 58.0 59.0 60.0 61.0 62.0 63.0
# CHECK: 48.0 49.0 50.0 51.0 52.0 53.0 54.0 55.0 56.0 57.0 58.0 59.0 60.0 61.0 62.0 63.0
# CHECK-LABEL: test_mma
# CHECK: 224.0 231.0 238.0 245.0 252.0 259.0 266.0 273.0 280.0 287.0 294.0 301.0 308.0 315.0 322.0 329.0
# CHECK: 624.0 647.0 670.0 693.0 716.0 739.0 762.0 785.0 808.0 831.0 854.0 877.0 900.0 923.0 946.0 969.0
# CHECK: 1024.0 1063.0 1102.0 1141.0 1180.0 1219.0 1258.0 1297.0 1336.0 1375.0 1414.0 1453.0 1492.0 1531.0 1570.0 1609.0
# CHECK: 1424.0 1479.0 1534.0 1589.0 1644.0 1699.0 1754.0 1809.0 1864.0 1919.0 1974.0 2029.0 2084.0 2139.0 2194.0 2249.0
# CHECK: 1824.0 1895.0 1966.0 2037.0 2108.0 2179.0 2250.0 2321.0 2392.0 2463.0 2534.0 2605.0 2676.0 2747.0 2818.0 2889.0
# CHECK: 2224.0 2311.0 2398.0 2485.0 2572.0 2659.0 2746.0 2833.0 2920.0 3007.0 3094.0 3181.0 3268.0 3355.0 3442.0 3529.0
# CHECK: 2624.0 2727.0 2830.0 2933.0 3036.0 3139.0 3242.0 3345.0 3448.0 3551.0 3654.0 3757.0 3860.0 3963.0 4066.0 4169.0
# CHECK: 3024.0 3143.0 3262.0 3381.0 3500.0 3619.0 3738.0 3857.0 3976.0 4095.0 4214.0 4333.0 4452.0 4571.0 4690.0 4809.0
# CHECK: 3424.0 3559.0 3694.0 3829.0 3964.0 4099.0 4234.0 4369.0 4504.0 4639.0 4774.0 4909.0 5044.0 5179.0 5314.0 5449.0
# CHECK: 3824.0 3975.0 4126.0 4277.0 4428.0 4579.0 4730.0 4881.0 5032.0 5183.0 5334.0 5485.0 5636.0 5787.0 5938.0 6089.0
# CHECK: 4224.0 4391.0 4558.0 4725.0 4892.0 5059.0 5226.0 5393.0 5560.0 5727.0 5894.0 6061.0 6228.0 6395.0 6562.0 6729.0
# CHECK: 4624.0 4807.0 4990.0 5173.0 5356.0 5539.0 5722.0 5905.0 6088.0 6271.0 6454.0 6637.0 6820.0 7003.0 7186.0 7369.0
# CHECK: 5024.0 5223.0 5422.0 5621.0 5820.0 6019.0 6218.0 6417.0 6616.0 6815.0 7014.0 7213.0 7412.0 7611.0 7810.0 8009.0
# CHECK: 5424.0 5639.0 5854.0 6069.0 6284.0 6499.0 6714.0 6929.0 7144.0 7359.0 7574.0 7789.0 8004.0 8219.0 8434.0 8649.0
# CHECK: 5824.0 6055.0 6286.0 6517.0 6748.0 6979.0 7210.0 7441.0 7672.0 7903.0 8134.0 8365.0 8596.0 8827.0 9058.0 9289.0
# CHECK: 6224.0 6471.0 6718.0 6965.0 7212.0 7459.0 7706.0 7953.0 8200.0 8447.0 8694.0 8941.0 9188.0 9435.0 9682.0 9929.0


def test_load_and_mma_f32_f32_16x16x4(ctx: DeviceContext):
    print("== test_load_and_mma_f32_f32_16x16x4")
    test_load_and_mma_and_multiply_operands[
        DType.float32, DType.float32, Index(16, 16, 4), False
    ](ctx)


# CHECK-LABEL: test_load_and_mma_f32_f32_16x16x4_k_group_size_4
# CHECK-LABEL: test_load_a
# CHECK: 0.0 16.0 32.0 48.0 64.0 80.0 96.0 112.0 128.0 144.0 160.0 176.0 192.0 208.0 224.0 240.0 4.0 20.0 36.0 52.0 68.0 84.0 100.0 116.0 132.0 148.0 164.0 180.0 196.0 212.0 228.0 244.0 8.0 24.0 40.0 56.0 72.0 88.0 104.0 120.0 136.0 152.0 168.0 184.0 200.0 216.0 232.0 248.0 12.0 28.0 44.0 60.0 76.0 92.0 108.0 124.0 140.0 156.0 172.0 188.0 204.0 220.0 236.0 252.0
# CHECK-LABEL: test_load_b
# CHECK: 0.0 1.0 2.0 3.0 4.0 5.0 6.0 7.0 8.0 9.0 10.0 11.0 12.0 13.0 14.0 15.0 64.0 65.0 66.0 67.0 68.0 69.0 70.0 71.0 72.0 73.0 74.0 75.0 76.0 77.0 78.0 79.0 128.0 129.0 130.0 131.0 132.0 133.0 134.0 135.0 136.0 137.0 138.0 139.0 140.0 141.0 142.0 143.0 192.0 193.0 194.0 195.0 196.0 197.0 198.0 199.0 200.0 201.0 202.0 203.0 204.0 205.0 206.0 207.0
# CHECK-LABEL: test_load_c
# CHECK: 0.0 16.0 32.0 48.0
# CHECK: 1.0 17.0 33.0 49.0
# CHECK: 2.0 18.0 34.0 50.0
# CHECK: 3.0 19.0 35.0 51.0
# CHECK: 4.0 20.0 36.0 52.0
# CHECK: 5.0 21.0 37.0 53.0
# CHECK: 6.0 22.0 38.0 54.0
# CHECK: 7.0 23.0 39.0 55.0
# CHECK: 8.0 24.0 40.0 56.0
# CHECK: 9.0 25.0 41.0 57.0
# CHECK: 10.0 26.0 42.0 58.0
# CHECK: 11.0 27.0 43.0 59.0
# CHECK: 12.0 28.0 44.0 60.0
# CHECK: 13.0 29.0 45.0 61.0
# CHECK: 14.0 30.0 46.0 62.0
# CHECK: 15.0 31.0 47.0 63.0
# CHECK: 64.0 80.0 96.0 112.0
# CHECK: 65.0 81.0 97.0 113.0
# CHECK: 66.0 82.0 98.0 114.0
# CHECK: 67.0 83.0 99.0 115.0
# CHECK: 68.0 84.0 100.0 116.0
# CHECK: 69.0 85.0 101.0 117.0
# CHECK: 70.0 86.0 102.0 118.0
# CHECK: 71.0 87.0 103.0 119.0
# CHECK: 72.0 88.0 104.0 120.0
# CHECK: 73.0 89.0 105.0 121.0
# CHECK: 74.0 90.0 106.0 122.0
# CHECK: 75.0 91.0 107.0 123.0
# CHECK: 76.0 92.0 108.0 124.0
# CHECK: 77.0 93.0 109.0 125.0
# CHECK: 78.0 94.0 110.0 126.0
# CHECK: 79.0 95.0 111.0 127.0
# CHECK: 128.0 144.0 160.0 176.0
# CHECK: 129.0 145.0 161.0 177.0
# CHECK: 130.0 146.0 162.0 178.0
# CHECK: 131.0 147.0 163.0 179.0
# CHECK: 132.0 148.0 164.0 180.0
# CHECK: 133.0 149.0 165.0 181.0
# CHECK: 134.0 150.0 166.0 182.0
# CHECK: 135.0 151.0 167.0 183.0
# CHECK: 136.0 152.0 168.0 184.0
# CHECK: 137.0 153.0 169.0 185.0
# CHECK: 138.0 154.0 170.0 186.0
# CHECK: 139.0 155.0 171.0 187.0
# CHECK: 140.0 156.0 172.0 188.0
# CHECK: 141.0 157.0 173.0 189.0
# CHECK: 142.0 158.0 174.0 190.0
# CHECK: 143.0 159.0 175.0 191.0
# CHECK: 192.0 208.0 224.0 240.0
# CHECK: 193.0 209.0 225.0 241.0
# CHECK: 194.0 210.0 226.0 242.0
# CHECK: 195.0 211.0 227.0 243.0
# CHECK: 196.0 212.0 228.0 244.0
# CHECK: 197.0 213.0 229.0 245.0
# CHECK: 198.0 214.0 230.0 246.0
# CHECK: 199.0 215.0 231.0 247.0
# CHECK: 200.0 216.0 232.0 248.0
# CHECK: 201.0 217.0 233.0 249.0
# CHECK: 202.0 218.0 234.0 250.0
# CHECK: 203.0 219.0 235.0 251.0
# CHECK: 204.0 220.0 236.0 252.0
# CHECK: 205.0 221.0 237.0 253.0
# CHECK: 206.0 222.0 238.0 254.0
# CHECK: 207.0 223.0 239.0 255.0
# CHECK-LABEL: test_load_d
# CHECK: 0.0 1.0 2.0 3.0 4.0 5.0 6.0 7.0 8.0 9.0 10.0 11.0 12.0 13.0 14.0 15.0
# CHECK: 0.0 1.0 2.0 3.0 4.0 5.0 6.0 7.0 8.0 9.0 10.0 11.0 12.0 13.0 14.0 15.0
# CHECK: 0.0 1.0 2.0 3.0 4.0 5.0 6.0 7.0 8.0 9.0 10.0 11.0 12.0 13.0 14.0 15.0
# CHECK: 0.0 1.0 2.0 3.0 4.0 5.0 6.0 7.0 8.0 9.0 10.0 11.0 12.0 13.0 14.0 15.0
# CHECK: 16.0 17.0 18.0 19.0 20.0 21.0 22.0 23.0 24.0 25.0 26.0 27.0 28.0 29.0 30.0 31.0
# CHECK: 16.0 17.0 18.0 19.0 20.0 21.0 22.0 23.0 24.0 25.0 26.0 27.0 28.0 29.0 30.0 31.0
# CHECK: 16.0 17.0 18.0 19.0 20.0 21.0 22.0 23.0 24.0 25.0 26.0 27.0 28.0 29.0 30.0 31.0
# CHECK: 16.0 17.0 18.0 19.0 20.0 21.0 22.0 23.0 24.0 25.0 26.0 27.0 28.0 29.0 30.0 31.0
# CHECK: 32.0 33.0 34.0 35.0 36.0 37.0 38.0 39.0 40.0 41.0 42.0 43.0 44.0 45.0 46.0 47.0
# CHECK: 32.0 33.0 34.0 35.0 36.0 37.0 38.0 39.0 40.0 41.0 42.0 43.0 44.0 45.0 46.0 47.0
# CHECK: 32.0 33.0 34.0 35.0 36.0 37.0 38.0 39.0 40.0 41.0 42.0 43.0 44.0 45.0 46.0 47.0
# CHECK: 32.0 33.0 34.0 35.0 36.0 37.0 38.0 39.0 40.0 41.0 42.0 43.0 44.0 45.0 46.0 47.0
# CHECK: 48.0 49.0 50.0 51.0 52.0 53.0 54.0 55.0 56.0 57.0 58.0 59.0 60.0 61.0 62.0 63.0
# CHECK: 48.0 49.0 50.0 51.0 52.0 53.0 54.0 55.0 56.0 57.0 58.0 59.0 60.0 61.0 62.0 63.0
# CHECK: 48.0 49.0 50.0 51.0 52.0 53.0 54.0 55.0 56.0 57.0 58.0 59.0 60.0 61.0 62.0 63.0
# CHECK: 48.0 49.0 50.0 51.0 52.0 53.0 54.0 55.0 56.0 57.0 58.0 59.0 60.0 61.0 62.0 63.0
# CHECK-LABEL: test_mma
# CHECK: 19840.0 19961.0 20082.0 20203.0 20324.0 20445.0 20566.0 20687.0 20808.0 20929.0 21050.0 21171.0 21292.0 21413.0 21534.0 21655.0
# CHECK: 50576.0 50953.0 51330.0 51707.0 52084.0 52461.0 52838.0 53215.0 53592.0 53969.0 54346.0 54723.0 55100.0 55477.0 55854.0 56231.0
# CHECK: 81312.0 81945.0 82578.0 83211.0 83844.0 84477.0 85110.0 85743.0 86376.0 87009.0 87642.0 88275.0 88908.0 89541.0 90174.0 90807.0
# CHECK: 112048.0 112937.0 113826.0 114715.0 115604.0 116493.0 117382.0 118271.0 119160.0 120049.0 120938.0 121827.0 122716.0 123605.0 124494.0 125383.0
# CHECK: 142784.0 143929.0 145074.0 146219.0 147364.0 148509.0 149654.0 150799.0 151944.0 153089.0 154234.0 155379.0 156524.0 157669.0 158814.0 159959.0
# CHECK: 173520.0 174921.0 176322.0 177723.0 179124.0 180525.0 181926.0 183327.0 184728.0 186129.0 187530.0 188931.0 190332.0 191733.0 193134.0 194535.0
# CHECK: 204256.0 205913.0 207570.0 209227.0 210884.0 212541.0 214198.0 215855.0 217512.0 219169.0 220826.0 222483.0 224140.0 225797.0 227454.0 229111.0
# CHECK: 234992.0 236905.0 238818.0 240731.0 242644.0 244557.0 246470.0 248383.0 250296.0 252209.0 254122.0 256035.0 257948.0 259861.0 261774.0 263687.0
# CHECK: 265728.0 267897.0 270066.0 272235.0 274404.0 276573.0 278742.0 280911.0 283080.0 285249.0 287418.0 289587.0 291756.0 293925.0 296094.0 298263.0
# CHECK: 296464.0 298889.0 301314.0 303739.0 306164.0 308589.0 311014.0 313439.0 315864.0 318289.0 320714.0 323139.0 325564.0 327989.0 330414.0 332839.0
# CHECK: 327200.0 329881.0 332562.0 335243.0 337924.0 340605.0 343286.0 345967.0 348648.0 351329.0 354010.0 356691.0 359372.0 362053.0 364734.0 367415.0
# CHECK: 357936.0 360873.0 363810.0 366747.0 369684.0 372621.0 375558.0 378495.0 381432.0 384369.0 387306.0 390243.0 393180.0 396117.0 399054.0 401991.0
# CHECK: 388672.0 391865.0 395058.0 398251.0 401444.0 404637.0 407830.0 411023.0 414216.0 417409.0 420602.0 423795.0 426988.0 430181.0 433374.0 436567.0
# CHECK: 419408.0 422857.0 426306.0 429755.0 433204.0 436653.0 440102.0 443551.0 447000.0 450449.0 453898.0 457347.0 460796.0 464245.0 467694.0 471143.0
# CHECK: 450144.0 453849.0 457554.0 461259.0 464964.0 468669.0 472374.0 476079.0 479784.0 483489.0 487194.0 490899.0 494604.0 498309.0 502014.0 505719.0
# CHECK: 480880.0 484841.0 488802.0 492763.0 496724.0 500685.0 504646.0 508607.0 512568.0 516529.0 520490.0 524451.0 528412.0 532373.0 536334.0 540295.0


def test_load_and_mma_f32_f32_16x16x4_k_group_size_4(ctx: DeviceContext):
    print("== test_load_and_mma_f32_f32_16x16x4_k_group_size_4")
    test_load_and_mma_and_multiply_operands[
        DType.float32, DType.float32, Index(16, 16, 4), False, 4
    ](ctx)


# CHECK-LABEL: == test_load_and_mma_f32_f32_16x16x4_transpose
# CHECK-LABEL: == test_load_a
# CHECK: 0.0 4.0 8.0 12.0 16.0 20.0 24.0 28.0 32.0 36.0 40.0 44.0 48.0 52.0 56.0 60.0 1.0 5.0 9.0 13.0 17.0 21.0 25.0 29.0 33.0 37.0 41.0 45.0 49.0 53.0 57.0 61.0 2.0 6.0 10.0 14.0 18.0 22.0 26.0 30.0 34.0 38.0 42.0 46.0 50.0 54.0 58.0 62.0 3.0 7.0 11.0 15.0 19.0 23.0 27.0 31.0 35.0 39.0 43.0 47.0 51.0 55.0 59.0 63.0
# CHECK-LABEL: == test_load_b
# CHECK: 0.0 4.0 8.0 12.0 16.0 20.0 24.0 28.0 32.0 36.0 40.0 44.0 48.0 52.0 56.0 60.0 1.0 5.0 9.0 13.0 17.0 21.0 25.0 29.0 33.0 37.0 41.0 45.0 49.0 53.0 57.0 61.0 2.0 6.0 10.0 14.0 18.0 22.0 26.0 30.0 34.0 38.0 42.0 46.0 50.0 54.0 58.0 62.0 3.0 7.0 11.0 15.0 19.0 23.0 27.0 31.0 35.0 39.0 43.0 47.0 51.0 55.0 59.0 63.0
# CHECK-LABEL: == test_load_c
# CHECK: 0.0 16.0 32.0 48.0
# CHECK: 1.0 17.0 33.0 49.0
# CHECK: 2.0 18.0 34.0 50.0
# CHECK: 3.0 19.0 35.0 51.0
# CHECK: 4.0 20.0 36.0 52.0
# CHECK: 5.0 21.0 37.0 53.0
# CHECK: 6.0 22.0 38.0 54.0
# CHECK: 7.0 23.0 39.0 55.0
# CHECK: 8.0 24.0 40.0 56.0
# CHECK: 9.0 25.0 41.0 57.0
# CHECK: 10.0 26.0 42.0 58.0
# CHECK: 11.0 27.0 43.0 59.0
# CHECK: 12.0 28.0 44.0 60.0
# CHECK: 13.0 29.0 45.0 61.0
# CHECK: 14.0 30.0 46.0 62.0
# CHECK: 15.0 31.0 47.0 63.0
# CHECK: 64.0 80.0 96.0 112.0
# CHECK: 65.0 81.0 97.0 113.0
# CHECK: 66.0 82.0 98.0 114.0
# CHECK: 67.0 83.0 99.0 115.0
# CHECK: 68.0 84.0 100.0 116.0
# CHECK: 69.0 85.0 101.0 117.0
# CHECK: 70.0 86.0 102.0 118.0
# CHECK: 71.0 87.0 103.0 119.0
# CHECK: 72.0 88.0 104.0 120.0
# CHECK: 73.0 89.0 105.0 121.0
# CHECK: 74.0 90.0 106.0 122.0
# CHECK: 75.0 91.0 107.0 123.0
# CHECK: 76.0 92.0 108.0 124.0
# CHECK: 77.0 93.0 109.0 125.0
# CHECK: 78.0 94.0 110.0 126.0
# CHECK: 79.0 95.0 111.0 127.0
# CHECK: 128.0 144.0 160.0 176.0
# CHECK: 129.0 145.0 161.0 177.0
# CHECK: 130.0 146.0 162.0 178.0
# CHECK: 131.0 147.0 163.0 179.0
# CHECK: 132.0 148.0 164.0 180.0
# CHECK: 133.0 149.0 165.0 181.0
# CHECK: 134.0 150.0 166.0 182.0
# CHECK: 135.0 151.0 167.0 183.0
# CHECK: 136.0 152.0 168.0 184.0
# CHECK: 137.0 153.0 169.0 185.0
# CHECK: 138.0 154.0 170.0 186.0
# CHECK: 139.0 155.0 171.0 187.0
# CHECK: 140.0 156.0 172.0 188.0
# CHECK: 141.0 157.0 173.0 189.0
# CHECK: 142.0 158.0 174.0 190.0
# CHECK: 143.0 159.0 175.0 191.0
# CHECK: 192.0 208.0 224.0 240.0
# CHECK: 193.0 209.0 225.0 241.0
# CHECK: 194.0 210.0 226.0 242.0
# CHECK: 195.0 211.0 227.0 243.0
# CHECK: 196.0 212.0 228.0 244.0
# CHECK: 197.0 213.0 229.0 245.0
# CHECK: 198.0 214.0 230.0 246.0
# CHECK: 199.0 215.0 231.0 247.0
# CHECK: 200.0 216.0 232.0 248.0
# CHECK: 201.0 217.0 233.0 249.0
# CHECK: 202.0 218.0 234.0 250.0
# CHECK: 203.0 219.0 235.0 251.0
# CHECK: 204.0 220.0 236.0 252.0
# CHECK: 205.0 221.0 237.0 253.0
# CHECK: 206.0 222.0 238.0 254.0
# CHECK: 207.0 223.0 239.0 255.0
# CHECK-LABEL: == test_load_d
# CHECK: 0.0 1.0 2.0 3.0 4.0 5.0 6.0 7.0 8.0 9.0 10.0 11.0 12.0 13.0 14.0 15.0
# CHECK: 0.0 1.0 2.0 3.0 4.0 5.0 6.0 7.0 8.0 9.0 10.0 11.0 12.0 13.0 14.0 15.0
# CHECK: 0.0 1.0 2.0 3.0 4.0 5.0 6.0 7.0 8.0 9.0 10.0 11.0 12.0 13.0 14.0 15.0
# CHECK: 0.0 1.0 2.0 3.0 4.0 5.0 6.0 7.0 8.0 9.0 10.0 11.0 12.0 13.0 14.0 15.0
# CHECK: 16.0 17.0 18.0 19.0 20.0 21.0 22.0 23.0 24.0 25.0 26.0 27.0 28.0 29.0 30.0 31.0
# CHECK: 16.0 17.0 18.0 19.0 20.0 21.0 22.0 23.0 24.0 25.0 26.0 27.0 28.0 29.0 30.0 31.0
# CHECK: 16.0 17.0 18.0 19.0 20.0 21.0 22.0 23.0 24.0 25.0 26.0 27.0 28.0 29.0 30.0 31.0
# CHECK: 16.0 17.0 18.0 19.0 20.0 21.0 22.0 23.0 24.0 25.0 26.0 27.0 28.0 29.0 30.0 31.0
# CHECK: 32.0 33.0 34.0 35.0 36.0 37.0 38.0 39.0 40.0 41.0 42.0 43.0 44.0 45.0 46.0 47.0
# CHECK: 32.0 33.0 34.0 35.0 36.0 37.0 38.0 39.0 40.0 41.0 42.0 43.0 44.0 45.0 46.0 47.0
# CHECK: 32.0 33.0 34.0 35.0 36.0 37.0 38.0 39.0 40.0 41.0 42.0 43.0 44.0 45.0 46.0 47.0
# CHECK: 32.0 33.0 34.0 35.0 36.0 37.0 38.0 39.0 40.0 41.0 42.0 43.0 44.0 45.0 46.0 47.0
# CHECK: 48.0 49.0 50.0 51.0 52.0 53.0 54.0 55.0 56.0 57.0 58.0 59.0 60.0 61.0 62.0 63.0
# CHECK: 48.0 49.0 50.0 51.0 52.0 53.0 54.0 55.0 56.0 57.0 58.0 59.0 60.0 61.0 62.0 63.0
# CHECK: 48.0 49.0 50.0 51.0 52.0 53.0 54.0 55.0 56.0 57.0 58.0 59.0 60.0 61.0 62.0 63.0
# CHECK: 48.0 49.0 50.0 51.0 52.0 53.0 54.0 55.0 56.0 57.0 58.0 59.0 60.0 61.0 62.0 63.0
# CHECK-LABEL: == test_mma
# CHECK: 14.0 39.0 64.0 89.0 114.0 139.0 164.0 189.0 214.0 239.0 264.0 289.0 314.0 339.0 364.0 389.0
# CHECK: 54.0 143.0 232.0 321.0 410.0 499.0 588.0 677.0 766.0 855.0 944.0 1033.0 1122.0 1211.0 1300.0 1389.0
# CHECK: 94.0 247.0 400.0 553.0 706.0 859.0 1012.0 1165.0 1318.0 1471.0 1624.0 1777.0 1930.0 2083.0 2236.0 2389.0
# CHECK: 134.0 351.0 568.0 785.0 1002.0 1219.0 1436.0 1653.0 1870.0 2087.0 2304.0 2521.0 2738.0 2955.0 3172.0 3389.0
# CHECK: 174.0 455.0 736.0 1017.0 1298.0 1579.0 1860.0 2141.0 2422.0 2703.0 2984.0 3265.0 3546.0 3827.0 4108.0 4389.0
# CHECK: 214.0 559.0 904.0 1249.0 1594.0 1939.0 2284.0 2629.0 2974.0 3319.0 3664.0 4009.0 4354.0 4699.0 5044.0 5389.0
# CHECK: 254.0 663.0 1072.0 1481.0 1890.0 2299.0 2708.0 3117.0 3526.0 3935.0 4344.0 4753.0 5162.0 5571.0 5980.0 6389.0
# CHECK: 294.0 767.0 1240.0 1713.0 2186.0 2659.0 3132.0 3605.0 4078.0 4551.0 5024.0 5497.0 5970.0 6443.0 6916.0 7389.0
# CHECK: 334.0 871.0 1408.0 1945.0 2482.0 3019.0 3556.0 4093.0 4630.0 5167.0 5704.0 6241.0 6778.0 7315.0 7852.0 8389.0
# CHECK: 374.0 975.0 1576.0 2177.0 2778.0 3379.0 3980.0 4581.0 5182.0 5783.0 6384.0 6985.0 7586.0 8187.0 8788.0 9389.0
# CHECK: 414.0 1079.0 1744.0 2409.0 3074.0 3739.0 4404.0 5069.0 5734.0 6399.0 7064.0 7729.0 8394.0 9059.0 9724.0 10389.0
# CHECK: 454.0 1183.0 1912.0 2641.0 3370.0 4099.0 4828.0 5557.0 6286.0 7015.0 7744.0 8473.0 9202.0 9931.0 10660.0 11389.0
# CHECK: 494.0 1287.0 2080.0 2873.0 3666.0 4459.0 5252.0 6045.0 6838.0 7631.0 8424.0 9217.0 10010.0 10803.0 11596.0 12389.0
# CHECK: 534.0 1391.0 2248.0 3105.0 3962.0 4819.0 5676.0 6533.0 7390.0 8247.0 9104.0 9961.0 10818.0 11675.0 12532.0 13389.0
# CHECK: 574.0 1495.0 2416.0 3337.0 4258.0 5179.0 6100.0 7021.0 7942.0 8863.0 9784.0 10705.0 11626.0 12547.0 13468.0 14389.0
# CHECK: 614.0 1599.0 2584.0 3569.0 4554.0 5539.0 6524.0 7509.0 8494.0 9479.0 10464.0 11449.0 12434.0 13419.0 14404.0 15389.0
def test_load_and_mma_f32_f32_16x16x4_transpose(ctx: DeviceContext):
    print("== test_load_and_mma_f32_f32_16x16x4_transpose")
    test_load_and_mma_and_multiply_operands[
        DType.float32, DType.float32, Index(16, 16, 4), True
    ](ctx)


# CHECK-LABEL: == test_load_and_mma_f32_f32_16x16x4_transpose_k_group_size_4
# CHECK-LABEL: == test_load_a
# CHECK: 0.0 16.0 32.0 48.0 64.0 80.0 96.0 112.0 128.0 144.0 160.0 176.0 192.0 208.0 224.0 240.0 4.0 20.0 36.0 52.0 68.0 84.0 100.0 116.0 132.0 148.0 164.0 180.0 196.0 212.0 228.0 244.0 8.0 24.0 40.0 56.0 72.0 88.0 104.0 120.0 136.0 152.0 168.0 184.0 200.0 216.0 232.0 248.0 12.0 28.0 44.0 60.0 76.0 92.0 108.0 124.0 140.0 156.0 172.0 188.0 204.0 220.0 236.0 252.0
# CHECK-LABEL: == test_load_b
# CHECK: 0.0 16.0 32.0 48.0 64.0 80.0 96.0 112.0 128.0 144.0 160.0 176.0 192.0 208.0 224.0 240.0 4.0 20.0 36.0 52.0 68.0 84.0 100.0 116.0 132.0 148.0 164.0 180.0 196.0 212.0 228.0 244.0 8.0 24.0 40.0 56.0 72.0 88.0 104.0 120.0 136.0 152.0 168.0 184.0 200.0 216.0 232.0 248.0 12.0 28.0 44.0 60.0 76.0 92.0 108.0 124.0 140.0 156.0 172.0 188.0 204.0 220.0 236.0 252.0
# CHECK-LABEL: == test_load_c
# CHECK: 0.0 16.0 32.0 48.0
# CHECK: 1.0 17.0 33.0 49.0
# CHECK: 2.0 18.0 34.0 50.0
# CHECK: 3.0 19.0 35.0 51.0
# CHECK: 4.0 20.0 36.0 52.0
# CHECK: 5.0 21.0 37.0 53.0
# CHECK: 6.0 22.0 38.0 54.0
# CHECK: 7.0 23.0 39.0 55.0
# CHECK: 8.0 24.0 40.0 56.0
# CHECK: 9.0 25.0 41.0 57.0
# CHECK: 10.0 26.0 42.0 58.0
# CHECK: 11.0 27.0 43.0 59.0
# CHECK: 12.0 28.0 44.0 60.0
# CHECK: 13.0 29.0 45.0 61.0
# CHECK: 14.0 30.0 46.0 62.0
# CHECK: 15.0 31.0 47.0 63.0
# CHECK: 64.0 80.0 96.0 112.0
# CHECK: 65.0 81.0 97.0 113.0
# CHECK: 66.0 82.0 98.0 114.0
# CHECK: 67.0 83.0 99.0 115.0
# CHECK: 68.0 84.0 100.0 116.0
# CHECK: 69.0 85.0 101.0 117.0
# CHECK: 70.0 86.0 102.0 118.0
# CHECK: 71.0 87.0 103.0 119.0
# CHECK: 72.0 88.0 104.0 120.0
# CHECK: 73.0 89.0 105.0 121.0
# CHECK: 74.0 90.0 106.0 122.0
# CHECK: 75.0 91.0 107.0 123.0
# CHECK: 76.0 92.0 108.0 124.0
# CHECK: 77.0 93.0 109.0 125.0
# CHECK: 78.0 94.0 110.0 126.0
# CHECK: 79.0 95.0 111.0 127.0
# CHECK: 128.0 144.0 160.0 176.0
# CHECK: 129.0 145.0 161.0 177.0
# CHECK: 130.0 146.0 162.0 178.0
# CHECK: 131.0 147.0 163.0 179.0
# CHECK: 132.0 148.0 164.0 180.0
# CHECK: 133.0 149.0 165.0 181.0
# CHECK: 134.0 150.0 166.0 182.0
# CHECK: 135.0 151.0 167.0 183.0
# CHECK: 136.0 152.0 168.0 184.0
# CHECK: 137.0 153.0 169.0 185.0
# CHECK: 138.0 154.0 170.0 186.0
# CHECK: 139.0 155.0 171.0 187.0
# CHECK: 140.0 156.0 172.0 188.0
# CHECK: 141.0 157.0 173.0 189.0
# CHECK: 142.0 158.0 174.0 190.0
# CHECK: 143.0 159.0 175.0 191.0
# CHECK: 192.0 208.0 224.0 240.0
# CHECK: 193.0 209.0 225.0 241.0
# CHECK: 194.0 210.0 226.0 242.0
# CHECK: 195.0 211.0 227.0 243.0
# CHECK: 196.0 212.0 228.0 244.0
# CHECK: 197.0 213.0 229.0 245.0
# CHECK: 198.0 214.0 230.0 246.0
# CHECK: 199.0 215.0 231.0 247.0
# CHECK: 200.0 216.0 232.0 248.0
# CHECK: 201.0 217.0 233.0 249.0
# CHECK: 202.0 218.0 234.0 250.0
# CHECK: 203.0 219.0 235.0 251.0
# CHECK: 204.0 220.0 236.0 252.0
# CHECK: 205.0 221.0 237.0 253.0
# CHECK: 206.0 222.0 238.0 254.0
# CHECK: 207.0 223.0 239.0 255.0
# CHECK-LABEL: == test_load_d
# CHECK: 0.0 1.0 2.0 3.0 4.0 5.0 6.0 7.0 8.0 9.0 10.0 11.0 12.0 13.0 14.0 15.0
# CHECK: 0.0 1.0 2.0 3.0 4.0 5.0 6.0 7.0 8.0 9.0 10.0 11.0 12.0 13.0 14.0 15.0
# CHECK: 0.0 1.0 2.0 3.0 4.0 5.0 6.0 7.0 8.0 9.0 10.0 11.0 12.0 13.0 14.0 15.0
# CHECK: 0.0 1.0 2.0 3.0 4.0 5.0 6.0 7.0 8.0 9.0 10.0 11.0 12.0 13.0 14.0 15.0
# CHECK: 16.0 17.0 18.0 19.0 20.0 21.0 22.0 23.0 24.0 25.0 26.0 27.0 28.0 29.0 30.0 31.0
# CHECK: 16.0 17.0 18.0 19.0 20.0 21.0 22.0 23.0 24.0 25.0 26.0 27.0 28.0 29.0 30.0 31.0
# CHECK: 16.0 17.0 18.0 19.0 20.0 21.0 22.0 23.0 24.0 25.0 26.0 27.0 28.0 29.0 30.0 31.0
# CHECK: 16.0 17.0 18.0 19.0 20.0 21.0 22.0 23.0 24.0 25.0 26.0 27.0 28.0 29.0 30.0 31.0
# CHECK: 32.0 33.0 34.0 35.0 36.0 37.0 38.0 39.0 40.0 41.0 42.0 43.0 44.0 45.0 46.0 47.0
# CHECK: 32.0 33.0 34.0 35.0 36.0 37.0 38.0 39.0 40.0 41.0 42.0 43.0 44.0 45.0 46.0 47.0
# CHECK: 32.0 33.0 34.0 35.0 36.0 37.0 38.0 39.0 40.0 41.0 42.0 43.0 44.0 45.0 46.0 47.0
# CHECK: 32.0 33.0 34.0 35.0 36.0 37.0 38.0 39.0 40.0 41.0 42.0 43.0 44.0 45.0 46.0 47.0
# CHECK: 48.0 49.0 50.0 51.0 52.0 53.0 54.0 55.0 56.0 57.0 58.0 59.0 60.0 61.0 62.0 63.0
# CHECK: 48.0 49.0 50.0 51.0 52.0 53.0 54.0 55.0 56.0 57.0 58.0 59.0 60.0 61.0 62.0 63.0
# CHECK: 48.0 49.0 50.0 51.0 52.0 53.0 54.0 55.0 56.0 57.0 58.0 59.0 60.0 61.0 62.0 63.0
# CHECK: 48.0 49.0 50.0 51.0 52.0 53.0 54.0 55.0 56.0 57.0 58.0 59.0 60.0 61.0 62.0 63.0
# CHECK-LABEL: == test_mma
# CHECK: 1240.0 3161.0 5082.0 7003.0 8924.0 10845.0 12766.0 14687.0 16608.0 18529.0 20450.0 22371.0 24292.0 26213.0 28134.0 30055.0
# CHECK: 3176.0 9193.0 15210.0 21227.0 27244.0 33261.0 39278.0 45295.0 51312.0 57329.0 63346.0 69363.0 75380.0 81397.0 87414.0 93431.0
# CHECK: 5112.0 15225.0 25338.0 35451.0 45564.0 55677.0 65790.0 75903.0 86016.0 96129.0 106242.0 116355.0 126468.0 136581.0 146694.0 156807.0
# CHECK: 7048.0 21257.0 35466.0 49675.0 63884.0 78093.0 92302.0 106511.0 120720.0 134929.0 149138.0 163347.0 177556.0 191765.0 205974.0 220183.0
# CHECK: 8984.0 27289.0 45594.0 63899.0 82204.0 100509.0 118814.0 137119.0 155424.0 173729.0 192034.0 210339.0 228644.0 246949.0 265254.0 283559.0
# CHECK: 10920.0 33321.0 55722.0 78123.0 100524.0 122925.0 145326.0 167727.0 190128.0 212529.0 234930.0 257331.0 279732.0 302133.0 324534.0 346935.0
# CHECK: 12856.0 39353.0 65850.0 92347.0 118844.0 145341.0 171838.0 198335.0 224832.0 251329.0 277826.0 304323.0 330820.0 357317.0 383814.0 410311.0
# CHECK: 14792.0 45385.0 75978.0 106571.0 137164.0 167757.0 198350.0 228943.0 259536.0 290129.0 320722.0 351315.0 381908.0 412501.0 443094.0 473687.0
# CHECK: 16728.0 51417.0 86106.0 120795.0 155484.0 190173.0 224862.0 259551.0 294240.0 328929.0 363618.0 398307.0 432996.0 467685.0 502374.0 537063.0
# CHECK: 18664.0 57449.0 96234.0 135019.0 173804.0 212589.0 251374.0 290159.0 328944.0 367729.0 406514.0 445299.0 484084.0 522869.0 561654.0 600439.0
# CHECK: 20600.0 63481.0 106362.0 149243.0 192124.0 235005.0 277886.0 320767.0 363648.0 406529.0 449410.0 492291.0 535172.0 578053.0 620934.0 663815.0
# CHECK: 22536.0 69513.0 116490.0 163467.0 210444.0 257421.0 304398.0 351375.0 398352.0 445329.0 492306.0 539283.0 586260.0 633237.0 680214.0 727191.0
# CHECK: 24472.0 75545.0 126618.0 177691.0 228764.0 279837.0 330910.0 381983.0 433056.0 484129.0 535202.0 586275.0 637348.0 688421.0 739494.0 790567.0
# CHECK: 26408.0 81577.0 136746.0 191915.0 247084.0 302253.0 357422.0 412591.0 467760.0 522929.0 578098.0 633267.0 688436.0 743605.0 798774.0 853943.0
# CHECK: 28344.0 87609.0 146874.0 206139.0 265404.0 324669.0 383934.0 443199.0 502464.0 561729.0 620994.0 680259.0 739524.0 798789.0 858054.0 917319.0
# CHECK: 30280.0 93641.0 157002.0 220363.0 283724.0 347085.0 410446.0 473807.0 537168.0 600529.0 663890.0 727251.0 790612.0 853973.0 917334.0 980695.0
def test_load_and_mma_f32_f32_16x16x4_transpose_k_group_size_4(
    ctx: DeviceContext,
):
    print("== test_load_and_mma_f32_f32_16x16x4_transpose_k_group_size_4")
    test_load_and_mma_and_multiply_operands[
        DType.float32, DType.float32, Index(16, 16, 4), True, 4
    ](ctx)


# CHECK-LABEL: test_load_and_mma_f32_bf16_16x16x16
# CHECK-LABEL: test_load_a
# CHECK: 0.0 16.0 32.0 48.0 64.0 80.0 96.0 112.0 128.0 144.0 160.0 176.0 192.0 208.0 224.0 240.0 4.0 20.0 36.0 52.0 68.0 84.0 100.0 116.0 132.0 148.0 164.0 180.0 196.0 212.0 228.0 244.0 8.0 24.0 40.0 56.0 72.0 88.0 104.0 120.0 136.0 152.0 168.0 184.0 200.0 216.0 232.0 248.0 12.0 28.0 44.0 60.0 76.0 92.0 108.0 124.0 140.0 156.0 172.0 188.0 204.0 220.0 236.0 252.0
# CHECK-LABEL: test_load_b
# CHECK: 0.0 1.0 2.0 3.0 4.0 5.0 6.0 7.0 8.0 9.0 10.0 11.0 12.0 13.0 14.0 15.0 64.0 65.0 66.0 67.0 68.0 69.0 70.0 71.0 72.0 73.0 74.0 75.0 76.0 77.0 78.0 79.0 128.0 129.0 130.0 131.0 132.0 133.0 134.0 135.0 136.0 137.0 138.0 139.0 140.0 141.0 142.0 143.0 192.0 193.0 194.0 195.0 196.0 197.0 198.0 199.0 200.0 201.0 202.0 203.0 204.0 205.0 206.0 207.0
# CHECK-LABEL: test_load_c
# CHECK: 0.0 16.0 32.0 48.0
# CHECK: 1.0 17.0 33.0 49.0
# CHECK: 2.0 18.0 34.0 50.0
# CHECK: 3.0 19.0 35.0 51.0
# CHECK: 4.0 20.0 36.0 52.0
# CHECK: 5.0 21.0 37.0 53.0
# CHECK: 6.0 22.0 38.0 54.0
# CHECK: 7.0 23.0 39.0 55.0
# CHECK: 8.0 24.0 40.0 56.0
# CHECK: 9.0 25.0 41.0 57.0
# CHECK: 10.0 26.0 42.0 58.0
# CHECK: 11.0 27.0 43.0 59.0
# CHECK: 12.0 28.0 44.0 60.0
# CHECK: 13.0 29.0 45.0 61.0
# CHECK: 14.0 30.0 46.0 62.0
# CHECK: 15.0 31.0 47.0 63.0
# CHECK: 64.0 80.0 96.0 112.0
# CHECK: 65.0 81.0 97.0 113.0
# CHECK: 66.0 82.0 98.0 114.0
# CHECK: 67.0 83.0 99.0 115.0
# CHECK: 68.0 84.0 100.0 116.0
# CHECK: 69.0 85.0 101.0 117.0
# CHECK: 70.0 86.0 102.0 118.0
# CHECK: 71.0 87.0 103.0 119.0
# CHECK: 72.0 88.0 104.0 120.0
# CHECK: 73.0 89.0 105.0 121.0
# CHECK: 74.0 90.0 106.0 122.0
# CHECK: 75.0 91.0 107.0 123.0
# CHECK: 76.0 92.0 108.0 124.0
# CHECK: 77.0 93.0 109.0 125.0
# CHECK: 78.0 94.0 110.0 126.0
# CHECK: 79.0 95.0 111.0 127.0
# CHECK: 128.0 144.0 160.0 176.0
# CHECK: 129.0 145.0 161.0 177.0
# CHECK: 130.0 146.0 162.0 178.0
# CHECK: 131.0 147.0 163.0 179.0
# CHECK: 132.0 148.0 164.0 180.0
# CHECK: 133.0 149.0 165.0 181.0
# CHECK: 134.0 150.0 166.0 182.0
# CHECK: 135.0 151.0 167.0 183.0
# CHECK: 136.0 152.0 168.0 184.0
# CHECK: 137.0 153.0 169.0 185.0
# CHECK: 138.0 154.0 170.0 186.0
# CHECK: 139.0 155.0 171.0 187.0
# CHECK: 140.0 156.0 172.0 188.0
# CHECK: 141.0 157.0 173.0 189.0
# CHECK: 142.0 158.0 174.0 190.0
# CHECK: 143.0 159.0 175.0 191.0
# CHECK: 192.0 208.0 224.0 240.0
# CHECK: 193.0 209.0 225.0 241.0
# CHECK: 194.0 210.0 226.0 242.0
# CHECK: 195.0 211.0 227.0 243.0
# CHECK: 196.0 212.0 228.0 244.0
# CHECK: 197.0 213.0 229.0 245.0
# CHECK: 198.0 214.0 230.0 246.0
# CHECK: 199.0 215.0 231.0 247.0
# CHECK: 200.0 216.0 232.0 248.0
# CHECK: 201.0 217.0 233.0 249.0
# CHECK: 202.0 218.0 234.0 250.0
# CHECK: 203.0 219.0 235.0 251.0
# CHECK: 204.0 220.0 236.0 252.0
# CHECK: 205.0 221.0 237.0 253.0
# CHECK: 206.0 222.0 238.0 254.0
# CHECK: 207.0 223.0 239.0 255.0
# CHECK-LABEL: test_load_d
# CHECK: 0.0 1.0 2.0 3.0 4.0 5.0 6.0 7.0 8.0 9.0 10.0 11.0 12.0 13.0 14.0 15.0
# CHECK: 0.0 1.0 2.0 3.0 4.0 5.0 6.0 7.0 8.0 9.0 10.0 11.0 12.0 13.0 14.0 15.0
# CHECK: 0.0 1.0 2.0 3.0 4.0 5.0 6.0 7.0 8.0 9.0 10.0 11.0 12.0 13.0 14.0 15.0
# CHECK: 0.0 1.0 2.0 3.0 4.0 5.0 6.0 7.0 8.0 9.0 10.0 11.0 12.0 13.0 14.0 15.0
# CHECK: 16.0 17.0 18.0 19.0 20.0 21.0 22.0 23.0 24.0 25.0 26.0 27.0 28.0 29.0 30.0 31.0
# CHECK: 16.0 17.0 18.0 19.0 20.0 21.0 22.0 23.0 24.0 25.0 26.0 27.0 28.0 29.0 30.0 31.0
# CHECK: 16.0 17.0 18.0 19.0 20.0 21.0 22.0 23.0 24.0 25.0 26.0 27.0 28.0 29.0 30.0 31.0
# CHECK: 16.0 17.0 18.0 19.0 20.0 21.0 22.0 23.0 24.0 25.0 26.0 27.0 28.0 29.0 30.0 31.0
# CHECK: 32.0 33.0 34.0 35.0 36.0 37.0 38.0 39.0 40.0 41.0 42.0 43.0 44.0 45.0 46.0 47.0
# CHECK: 32.0 33.0 34.0 35.0 36.0 37.0 38.0 39.0 40.0 41.0 42.0 43.0 44.0 45.0 46.0 47.0
# CHECK: 32.0 33.0 34.0 35.0 36.0 37.0 38.0 39.0 40.0 41.0 42.0 43.0 44.0 45.0 46.0 47.0
# CHECK: 32.0 33.0 34.0 35.0 36.0 37.0 38.0 39.0 40.0 41.0 42.0 43.0 44.0 45.0 46.0 47.0
# CHECK: 48.0 49.0 50.0 51.0 52.0 53.0 54.0 55.0 56.0 57.0 58.0 59.0 60.0 61.0 62.0 63.0
# CHECK: 48.0 49.0 50.0 51.0 52.0 53.0 54.0 55.0 56.0 57.0 58.0 59.0 60.0 61.0 62.0 63.0
# CHECK: 48.0 49.0 50.0 51.0 52.0 53.0 54.0 55.0 56.0 57.0 58.0 59.0 60.0 61.0 62.0 63.0
# CHECK: 48.0 49.0 50.0 51.0 52.0 53.0 54.0 55.0 56.0 57.0 58.0 59.0 60.0 61.0 62.0 63.0
# CHECK-LABEL: test_mma
# CHECK: 19840.0 19961.0 20082.0 20203.0 20324.0 20445.0 20566.0 20687.0 20808.0 20929.0 21050.0 21171.0 21292.0 21413.0 21534.0 21655.0
# CHECK: 50576.0 50953.0 51330.0 51707.0 52084.0 52461.0 52838.0 53215.0 53592.0 53969.0 54346.0 54723.0 55100.0 55477.0 55854.0 56231.0
# CHECK: 81312.0 81945.0 82578.0 83211.0 83844.0 84477.0 85110.0 85743.0 86376.0 87009.0 87642.0 88275.0 88908.0 89541.0 90174.0 90807.0
# CHECK: 112048.0 112937.0 113826.0 114715.0 115604.0 116493.0 117382.0 118271.0 119160.0 120049.0 120938.0 121827.0 122716.0 123605.0 124494.0 125383.0
# CHECK: 142784.0 143929.0 145074.0 146219.0 147364.0 148509.0 149654.0 150799.0 151944.0 153089.0 154234.0 155379.0 156524.0 157669.0 158814.0 159959.0
# CHECK: 173520.0 174921.0 176322.0 177723.0 179124.0 180525.0 181926.0 183327.0 184728.0 186129.0 187530.0 188931.0 190332.0 191733.0 193134.0 194535.0
# CHECK: 204256.0 205913.0 207570.0 209227.0 210884.0 212541.0 214198.0 215855.0 217512.0 219169.0 220826.0 222483.0 224140.0 225797.0 227454.0 229111.0
# CHECK: 234992.0 236905.0 238818.0 240731.0 242644.0 244557.0 246470.0 248383.0 250296.0 252209.0 254122.0 256035.0 257948.0 259861.0 261774.0 263687.0
# CHECK: 265728.0 267897.0 270066.0 272235.0 274404.0 276573.0 278742.0 280911.0 283080.0 285249.0 287418.0 289587.0 291756.0 293925.0 296094.0 298263.0
# CHECK: 296464.0 298889.0 301314.0 303739.0 306164.0 308589.0 311014.0 313439.0 315864.0 318289.0 320714.0 323139.0 325564.0 327989.0 330414.0 332839.0
# CHECK: 327200.0 329881.0 332562.0 335243.0 337924.0 340605.0 343286.0 345967.0 348648.0 351329.0 354010.0 356691.0 359372.0 362053.0 364734.0 367415.0
# CHECK: 357936.0 360873.0 363810.0 366747.0 369684.0 372621.0 375558.0 378495.0 381432.0 384369.0 387306.0 390243.0 393180.0 396117.0 399054.0 401991.0
# CHECK: 388672.0 391865.0 395058.0 398251.0 401444.0 404637.0 407830.0 411023.0 414216.0 417409.0 420602.0 423795.0 426988.0 430181.0 433374.0 436567.0
# CHECK: 419408.0 422857.0 426306.0 429755.0 433204.0 436653.0 440102.0 443551.0 447000.0 450449.0 453898.0 457347.0 460796.0 464245.0 467694.0 471143.0
# CHECK: 450144.0 453849.0 457554.0 461259.0 464964.0 468669.0 472374.0 476079.0 479784.0 483489.0 487194.0 490899.0 494604.0 498309.0 502014.0 505719.0
# CHECK: 480880.0 484841.0 488802.0 492763.0 496724.0 500685.0 504646.0 508607.0 512568.0 516529.0 520490.0 524451.0 528412.0 532373.0 536334.0 540295.0
def test_load_and_mma_f32_bf16_16x16x16(ctx: DeviceContext):
    print("== test_load_and_mma_f32_bf16_16x16x16")
    test_load_and_mma_and_multiply_operands[
        DType.float32, DType.bfloat16, Index(16, 16, 16), False
    ](ctx)


# CHECK-LABEL: test_load_and_mma_f32_bf16_16x16x16_k_group_size_4
# CHECK-LABEL: test_load_a
# CHECK: 0.0 64.0 128.0 192.0 256.0 320.0 384.0 448.0 512.0 576.0 640.0 704.0 768.0 832.0 896.0 960.0 16.0 80.0 144.0 208.0 272.0 336.0 400.0 464.0 528.0 592.0 656.0 720.0 784.0 848.0 912.0 976.0 32.0 96.0 160.0 224.0 288.0 352.0 416.0 480.0 544.0 608.0 672.0 736.0 800.0 864.0 928.0 992.0 48.0 112.0 176.0 240.0 304.0 368.0 432.0 496.0 560.0 624.0 688.0 752.0 816.0 880.0 944.0 1008.0
# CHECK-LABEL: test_load_b
# CHECK: 0.0 1.0 2.0 3.0 4.0 5.0 6.0 7.0 8.0 9.0 10.0 11.0 12.0 13.0 14.0 15.0 256.0 256.0 258.0 260.0 260.0 260.0 262.0 264.0 264.0 264.0 266.0 268.0 268.0 268.0 270.0 272.0 512.0 512.0 512.0 516.0 516.0 516.0 520.0 520.0 520.0 520.0 520.0 524.0 524.0 524.0 528.0 528.0 768.0 768.0 768.0 772.0 772.0 772.0 776.0 776.0 776.0 776.0 776.0 780.0 780.0 780.0 784.0 784.0
# CHECK-LABEL: test_load_c
# CHECK: 0.0 16.0 32.0 48.0
# CHECK: 1.0 17.0 33.0 49.0
# CHECK: 2.0 18.0 34.0 50.0
# CHECK: 3.0 19.0 35.0 51.0
# CHECK: 4.0 20.0 36.0 52.0
# CHECK: 5.0 21.0 37.0 53.0
# CHECK: 6.0 22.0 38.0 54.0
# CHECK: 7.0 23.0 39.0 55.0
# CHECK: 8.0 24.0 40.0 56.0
# CHECK: 9.0 25.0 41.0 57.0
# CHECK: 10.0 26.0 42.0 58.0
# CHECK: 11.0 27.0 43.0 59.0
# CHECK: 12.0 28.0 44.0 60.0
# CHECK: 13.0 29.0 45.0 61.0
# CHECK: 14.0 30.0 46.0 62.0
# CHECK: 15.0 31.0 47.0 63.0
# CHECK: 64.0 80.0 96.0 112.0
# CHECK: 65.0 81.0 97.0 113.0
# CHECK: 66.0 82.0 98.0 114.0
# CHECK: 67.0 83.0 99.0 115.0
# CHECK: 68.0 84.0 100.0 116.0
# CHECK: 69.0 85.0 101.0 117.0
# CHECK: 70.0 86.0 102.0 118.0
# CHECK: 71.0 87.0 103.0 119.0
# CHECK: 72.0 88.0 104.0 120.0
# CHECK: 73.0 89.0 105.0 121.0
# CHECK: 74.0 90.0 106.0 122.0
# CHECK: 75.0 91.0 107.0 123.0
# CHECK: 76.0 92.0 108.0 124.0
# CHECK: 77.0 93.0 109.0 125.0
# CHECK: 78.0 94.0 110.0 126.0
# CHECK: 79.0 95.0 111.0 127.0
# CHECK: 128.0 144.0 160.0 176.0
# CHECK: 129.0 145.0 161.0 177.0
# CHECK: 130.0 146.0 162.0 178.0
# CHECK: 131.0 147.0 163.0 179.0
# CHECK: 132.0 148.0 164.0 180.0
# CHECK: 133.0 149.0 165.0 181.0
# CHECK: 134.0 150.0 166.0 182.0
# CHECK: 135.0 151.0 167.0 183.0
# CHECK: 136.0 152.0 168.0 184.0
# CHECK: 137.0 153.0 169.0 185.0
# CHECK: 138.0 154.0 170.0 186.0
# CHECK: 139.0 155.0 171.0 187.0
# CHECK: 140.0 156.0 172.0 188.0
# CHECK: 141.0 157.0 173.0 189.0
# CHECK: 142.0 158.0 174.0 190.0
# CHECK: 143.0 159.0 175.0 191.0
# CHECK: 192.0 208.0 224.0 240.0
# CHECK: 193.0 209.0 225.0 241.0
# CHECK: 194.0 210.0 226.0 242.0
# CHECK: 195.0 211.0 227.0 243.0
# CHECK: 196.0 212.0 228.0 244.0
# CHECK: 197.0 213.0 229.0 245.0
# CHECK: 198.0 214.0 230.0 246.0
# CHECK: 199.0 215.0 231.0 247.0
# CHECK: 200.0 216.0 232.0 248.0
# CHECK: 201.0 217.0 233.0 249.0
# CHECK: 202.0 218.0 234.0 250.0
# CHECK: 203.0 219.0 235.0 251.0
# CHECK: 204.0 220.0 236.0 252.0
# CHECK: 205.0 221.0 237.0 253.0
# CHECK: 206.0 222.0 238.0 254.0
# CHECK: 207.0 223.0 239.0 255.0
# CHECK-LABEL: test_load_d
# CHECK: 0.0 1.0 2.0 3.0 4.0 5.0 6.0 7.0 8.0 9.0 10.0 11.0 12.0 13.0 14.0 15.0
# CHECK: 0.0 1.0 2.0 3.0 4.0 5.0 6.0 7.0 8.0 9.0 10.0 11.0 12.0 13.0 14.0 15.0
# CHECK: 0.0 1.0 2.0 3.0 4.0 5.0 6.0 7.0 8.0 9.0 10.0 11.0 12.0 13.0 14.0 15.0
# CHECK: 0.0 1.0 2.0 3.0 4.0 5.0 6.0 7.0 8.0 9.0 10.0 11.0 12.0 13.0 14.0 15.0
# CHECK: 16.0 17.0 18.0 19.0 20.0 21.0 22.0 23.0 24.0 25.0 26.0 27.0 28.0 29.0 30.0 31.0
# CHECK: 16.0 17.0 18.0 19.0 20.0 21.0 22.0 23.0 24.0 25.0 26.0 27.0 28.0 29.0 30.0 31.0
# CHECK: 16.0 17.0 18.0 19.0 20.0 21.0 22.0 23.0 24.0 25.0 26.0 27.0 28.0 29.0 30.0 31.0
# CHECK: 16.0 17.0 18.0 19.0 20.0 21.0 22.0 23.0 24.0 25.0 26.0 27.0 28.0 29.0 30.0 31.0
# CHECK: 32.0 33.0 34.0 35.0 36.0 37.0 38.0 39.0 40.0 41.0 42.0 43.0 44.0 45.0 46.0 47.0
# CHECK: 32.0 33.0 34.0 35.0 36.0 37.0 38.0 39.0 40.0 41.0 42.0 43.0 44.0 45.0 46.0 47.0
# CHECK: 32.0 33.0 34.0 35.0 36.0 37.0 38.0 39.0 40.0 41.0 42.0 43.0 44.0 45.0 46.0 47.0
# CHECK: 32.0 33.0 34.0 35.0 36.0 37.0 38.0 39.0 40.0 41.0 42.0 43.0 44.0 45.0 46.0 47.0
# CHECK: 48.0 49.0 50.0 51.0 52.0 53.0 54.0 55.0 56.0 57.0 58.0 59.0 60.0 61.0 62.0 63.0
# CHECK: 48.0 49.0 50.0 51.0 52.0 53.0 54.0 55.0 56.0 57.0 58.0 59.0 60.0 61.0 62.0 63.0
# CHECK: 48.0 49.0 50.0 51.0 52.0 53.0 54.0 55.0 56.0 57.0 58.0 59.0 60.0 61.0 62.0 63.0
# CHECK: 48.0 49.0 50.0 51.0 52.0 53.0 54.0 55.0 56.0 57.0 58.0 59.0 60.0 61.0 62.0 63.0
# CHECK-LABEL: test_mma
# CHECK: 1365504.0 1365625.0 1366498.0 1373451.0 1373572.0 1373693.0 1380646.0 1381519.0 1381640.0 1381761.0 1382634.0 1389587.0 1389708.0 1389829.0 1396782.0 1397655.0
# CHECK: 3429904.0 3431049.0 3434994.0 3453211.0 3454356.0 3455501.0 3473718.0 3477663.0 3478808.0 3479953.0 3483898.0 3502115.0 3503260.0 3504405.0 3522622.0 3526567.0
# CHECK: 5494304.0 5496473.0 5503490.0 5532971.0 5535140.0 5537309.0 5566790.0 5573807.0 5575976.0 5578145.0 5585162.0 5614643.0 5616812.0 5618981.0 5648462.0 5655479.0
# CHECK: 7558704.0 7561897.0 7571986.0 7612731.0 7615924.0 7619117.0 7659862.0 7669951.0 7673144.0 7676337.0 7686426.0 7727171.0 7730364.0 7733557.0 7774302.0 7784391.0
# CHECK: 9623616.0 9627833.0 9640994.0 9693003.0 9697220.0 9701437.0 9753446.0 9766607.0 9770824.0 9775041.0 9788202.0 9840211.0 9844428.0 9848645.0 9900654.0 9913815.0
# CHECK: 11688016.0 11693257.0 11709490.0 11772763.0 11778004.0 11783245.0 11846518.0 11862751.0 11867992.0 11873233.0 11889466.0 11952739.0 11957980.0 11963221.0 12026494.0 12042727.0
# CHECK: 13752416.0 13758681.0 13777986.0 13852523.0 13858788.0 13865053.0 13939590.0 13958895.0 13965160.0 13971425.0 13990730.0 14065267.0 14071532.0 14077797.0 14152334.0 14171639.0
# CHECK: 15816816.0 15824105.0 15846482.0 15932283.0 15939572.0 15946861.0 16032662.0 16055039.0 16062328.0 16069617.0 16091994.0 16177795.0 16185084.0 16192373.0 16278174.0 16300551.0
# CHECK: 17882240.0 17890552.0 17916002.0 18013068.0 18021380.0 18029692.0 18126758.0 18152208.0 18160520.0 18168832.0 18194282.0 18291348.0 18299660.0 18307972.0 18405038.0 18430488.0
# CHECK: 19946640.0 19955976.0 19984498.0 20092828.0 20102164.0 20111500.0 20219830.0 20248352.0 20257688.0 20267024.0 20295546.0 20403876.0 20413212.0 20422548.0 20530878.0 20559400.0
# CHECK: 22011040.0 22021400.0 22052994.0 22172588.0 22182948.0 22193308.0 22312902.0 22344496.0 22354856.0 22365216.0 22396810.0 22516404.0 22526764.0 22537124.0 22656718.0 22688312.0
# CHECK: 24075440.0 24086824.0 24121490.0 24252348.0 24263732.0 24275116.0 24405974.0 24440640.0 24452024.0 24463408.0 24498074.0 24628932.0 24640316.0 24651700.0 24782558.0 24817224.0
# CHECK: 26139840.0 26152248.0 26189986.0 26332108.0 26344516.0 26356924.0 26499046.0 26536784.0 26549192.0 26561600.0 26599338.0 26741460.0 26753868.0 26766276.0 26908398.0 26946136.0
# CHECK: 28204240.0 28217672.0 28258482.0 28411868.0 28425300.0 28438732.0 28592118.0 28632928.0 28646360.0 28659792.0 28700602.0 28853988.0 28867420.0 28880852.0 29034238.0 29075048.0
# CHECK: 30268640.0 30283096.0 30326978.0 30491628.0 30506084.0 30520540.0 30685190.0 30729072.0 30743528.0 30757984.0 30801866.0 30966516.0 30980972.0 30995428.0 31160078.0 31203960.0
# CHECK: 32333040.0 32348520.0 32395474.0 32571388.0 32586868.0 32602348.0 32778262.0 32825216.0 32840696.0 32856176.0 32903130.0 33079044.0 33094524.0 33110004.0 33285918.0 33332872.0
def test_load_and_mma_f32_bf16_16x16x16_k_group_size_4(ctx: DeviceContext):
    print("== test_load_and_mma_f32_bf16_16x16x16_k_group_size_4")
    test_load_and_mma_and_multiply_operands[
        DType.float32, DType.bfloat16, Index(16, 16, 16), False, 4
    ](ctx)


# CHECK-LABEL: == test_load_and_mma_f32_bf16_16x16x16_transpose
# CHECK-LABEL: == test_load_a
# CHECK:0.0 16.0 32.0 48.0 64.0 80.0 96.0 112.0 128.0 144.0 160.0 176.0 192.0 208.0 224.0 240.0 4.0 20.0 36.0 52.0 68.0 84.0 100.0 116.0 132.0 148.0 164.0 180.0 196.0 212.0 228.0 244.0 8.0 24.0 40.0 56.0 72.0 88.0 104.0 120.0 136.0 152.0 168.0 184.0 200.0 216.0 232.0 248.0 12.0 28.0 44.0 60.0 76.0 92.0 108.0 124.0 140.0 156.0 172.0 188.0 204.0 220.0 236.0 252.0
# CHECK-LABEL: == test_load_b
# CHECK:0.0 16.0 32.0 48.0 64.0 80.0 96.0 112.0 128.0 144.0 160.0 176.0 192.0 208.0 224.0 240.0 4.0 20.0 36.0 52.0 68.0 84.0 100.0 116.0 132.0 148.0 164.0 180.0 196.0 212.0 228.0 244.0 8.0 24.0 40.0 56.0 72.0 88.0 104.0 120.0 136.0 152.0 168.0 184.0 200.0 216.0 232.0 248.0 12.0 28.0 44.0 60.0 76.0 92.0 108.0 124.0 140.0 156.0 172.0 188.0 204.0 220.0 236.0 252.0
# CHECK-LABEL: == test_load_c
# CHECK: 0.0 16.0 32.0 48.0
# CHECK: 1.0 17.0 33.0 49.0
# CHECK: 2.0 18.0 34.0 50.0
# CHECK: 3.0 19.0 35.0 51.0
# CHECK: 4.0 20.0 36.0 52.0
# CHECK: 5.0 21.0 37.0 53.0
# CHECK: 6.0 22.0 38.0 54.0
# CHECK: 7.0 23.0 39.0 55.0
# CHECK: 8.0 24.0 40.0 56.0
# CHECK: 9.0 25.0 41.0 57.0
# CHECK: 10.0 26.0 42.0 58.0
# CHECK: 11.0 27.0 43.0 59.0
# CHECK: 12.0 28.0 44.0 60.0
# CHECK: 13.0 29.0 45.0 61.0
# CHECK: 14.0 30.0 46.0 62.0
# CHECK: 15.0 31.0 47.0 63.0
# CHECK: 64.0 80.0 96.0 112.0
# CHECK: 65.0 81.0 97.0 113.0
# CHECK: 66.0 82.0 98.0 114.0
# CHECK: 67.0 83.0 99.0 115.0
# CHECK: 68.0 84.0 100.0 116.0
# CHECK: 69.0 85.0 101.0 117.0
# CHECK: 70.0 86.0 102.0 118.0
# CHECK: 71.0 87.0 103.0 119.0
# CHECK: 72.0 88.0 104.0 120.0
# CHECK: 73.0 89.0 105.0 121.0
# CHECK: 74.0 90.0 106.0 122.0
# CHECK: 75.0 91.0 107.0 123.0
# CHECK: 76.0 92.0 108.0 124.0
# CHECK: 77.0 93.0 109.0 125.0
# CHECK: 78.0 94.0 110.0 126.0
# CHECK: 79.0 95.0 111.0 127.0
# CHECK: 128.0 144.0 160.0 176.0
# CHECK: 129.0 145.0 161.0 177.0
# CHECK: 130.0 146.0 162.0 178.0
# CHECK: 131.0 147.0 163.0 179.0
# CHECK: 132.0 148.0 164.0 180.0
# CHECK: 133.0 149.0 165.0 181.0
# CHECK: 134.0 150.0 166.0 182.0
# CHECK: 135.0 151.0 167.0 183.0
# CHECK: 136.0 152.0 168.0 184.0
# CHECK: 137.0 153.0 169.0 185.0
# CHECK: 138.0 154.0 170.0 186.0
# CHECK: 139.0 155.0 171.0 187.0
# CHECK: 140.0 156.0 172.0 188.0
# CHECK: 141.0 157.0 173.0 189.0
# CHECK: 142.0 158.0 174.0 190.0
# CHECK: 143.0 159.0 175.0 191.0
# CHECK: 192.0 208.0 224.0 240.0
# CHECK: 193.0 209.0 225.0 241.0
# CHECK: 194.0 210.0 226.0 242.0
# CHECK: 195.0 211.0 227.0 243.0
# CHECK: 196.0 212.0 228.0 244.0
# CHECK: 197.0 213.0 229.0 245.0
# CHECK: 198.0 214.0 230.0 246.0
# CHECK: 199.0 215.0 231.0 247.0
# CHECK: 200.0 216.0 232.0 248.0
# CHECK: 201.0 217.0 233.0 249.0
# CHECK: 202.0 218.0 234.0 250.0
# CHECK: 203.0 219.0 235.0 251.0
# CHECK: 204.0 220.0 236.0 252.0
# CHECK: 205.0 221.0 237.0 253.0
# CHECK: 206.0 222.0 238.0 254.0
# CHECK: 207.0 223.0 239.0 255.0
# CHECK-LABEL: == test_load_d
# CHECK: 0.0 1.0 2.0 3.0 4.0 5.0 6.0 7.0 8.0 9.0 10.0 11.0 12.0 13.0 14.0 15.0
# CHECK: 0.0 1.0 2.0 3.0 4.0 5.0 6.0 7.0 8.0 9.0 10.0 11.0 12.0 13.0 14.0 15.0
# CHECK: 0.0 1.0 2.0 3.0 4.0 5.0 6.0 7.0 8.0 9.0 10.0 11.0 12.0 13.0 14.0 15.0
# CHECK: 0.0 1.0 2.0 3.0 4.0 5.0 6.0 7.0 8.0 9.0 10.0 11.0 12.0 13.0 14.0 15.0
# CHECK: 16.0 17.0 18.0 19.0 20.0 21.0 22.0 23.0 24.0 25.0 26.0 27.0 28.0 29.0 30.0 31.0
# CHECK: 16.0 17.0 18.0 19.0 20.0 21.0 22.0 23.0 24.0 25.0 26.0 27.0 28.0 29.0 30.0 31.0
# CHECK: 16.0 17.0 18.0 19.0 20.0 21.0 22.0 23.0 24.0 25.0 26.0 27.0 28.0 29.0 30.0 31.0
# CHECK: 16.0 17.0 18.0 19.0 20.0 21.0 22.0 23.0 24.0 25.0 26.0 27.0 28.0 29.0 30.0 31.0
# CHECK: 32.0 33.0 34.0 35.0 36.0 37.0 38.0 39.0 40.0 41.0 42.0 43.0 44.0 45.0 46.0 47.0
# CHECK: 32.0 33.0 34.0 35.0 36.0 37.0 38.0 39.0 40.0 41.0 42.0 43.0 44.0 45.0 46.0 47.0
# CHECK: 32.0 33.0 34.0 35.0 36.0 37.0 38.0 39.0 40.0 41.0 42.0 43.0 44.0 45.0 46.0 47.0
# CHECK: 32.0 33.0 34.0 35.0 36.0 37.0 38.0 39.0 40.0 41.0 42.0 43.0 44.0 45.0 46.0 47.0
# CHECK: 48.0 49.0 50.0 51.0 52.0 53.0 54.0 55.0 56.0 57.0 58.0 59.0 60.0 61.0 62.0 63.0
# CHECK: 48.0 49.0 50.0 51.0 52.0 53.0 54.0 55.0 56.0 57.0 58.0 59.0 60.0 61.0 62.0 63.0
# CHECK: 48.0 49.0 50.0 51.0 52.0 53.0 54.0 55.0 56.0 57.0 58.0 59.0 60.0 61.0 62.0 63.0
# CHECK: 48.0 49.0 50.0 51.0 52.0 53.0 54.0 55.0 56.0 57.0 58.0 59.0 60.0 61.0 62.0 63.0
# CHECK-LABEL: == test_mma
# CHECK: 1240.0 3161.0 5082.0 7003.0 8924.0 10845.0 12766.0 14687.0 16608.0 18529.0 20450.0 22371.0 24292.0 26213.0 28134.0 30055.0
# CHECK: 3176.0 9193.0 15210.0 21227.0 27244.0 33261.0 39278.0 45295.0 51312.0 57329.0 63346.0 69363.0 75380.0 81397.0 87414.0 93431.0
# CHECK: 5112.0 15225.0 25338.0 35451.0 45564.0 55677.0 65790.0 75903.0 86016.0 96129.0 106242.0 116355.0 126468.0 136581.0 146694.0 156807.0
# CHECK: 7048.0 21257.0 35466.0 49675.0 63884.0 78093.0 92302.0 106511.0 120720.0 134929.0 149138.0 163347.0 177556.0 191765.0 205974.0 220183.0
# CHECK: 8984.0 27289.0 45594.0 63899.0 82204.0 100509.0 118814.0 137119.0 155424.0 173729.0 192034.0 210339.0 228644.0 246949.0 265254.0 283559.0
# CHECK: 10920.0 33321.0 55722.0 78123.0 100524.0 122925.0 145326.0 167727.0 190128.0 212529.0 234930.0 257331.0 279732.0 302133.0 324534.0 346935.0
# CHECK: 12856.0 39353.0 65850.0 92347.0 118844.0 145341.0 171838.0 198335.0 224832.0 251329.0 277826.0 304323.0 330820.0 357317.0 383814.0 410311.0
# CHECK: 14792.0 45385.0 75978.0 106571.0 137164.0 167757.0 198350.0 228943.0 259536.0 290129.0 320722.0 351315.0 381908.0 412501.0 443094.0 473687.0
# CHECK: 16728.0 51417.0 86106.0 120795.0 155484.0 190173.0 224862.0 259551.0 294240.0 328929.0 363618.0 398307.0 432996.0 467685.0 502374.0 537063.0
# CHECK: 18664.0 57449.0 96234.0 135019.0 173804.0 212589.0 251374.0 290159.0 328944.0 367729.0 406514.0 445299.0 484084.0 522869.0 561654.0 600439.0
# CHECK: 20600.0 63481.0 106362.0 149243.0 192124.0 235005.0 277886.0 320767.0 363648.0 406529.0 449410.0 492291.0 535172.0 578053.0 620934.0 663815.0
# CHECK: 22536.0 69513.0 116490.0 163467.0 210444.0 257421.0 304398.0 351375.0 398352.0 445329.0 492306.0 539283.0 586260.0 633237.0 680214.0 727191.0
# CHECK: 24472.0 75545.0 126618.0 177691.0 228764.0 279837.0 330910.0 381983.0 433056.0 484129.0 535202.0 586275.0 637348.0 688421.0 739494.0 790567.0
# CHECK: 26408.0 81577.0 136746.0 191915.0 247084.0 302253.0 357422.0 412591.0 467760.0 522929.0 578098.0 633267.0 688436.0 743605.0 798774.0 853943.0
# CHECK: 28344.0 87609.0 146874.0 206139.0 265404.0 324669.0 383934.0 443199.0 502464.0 561729.0 620994.0 680259.0 739524.0 798789.0 858054.0 917319.0
# CHECK: 30280.0 93641.0 157002.0 220363.0 283724.0 347085.0 410446.0 473807.0 537168.0 600529.0 663890.0 727251.0 790612.0 853973.0 917334.0 980695.0
def test_load_and_mma_f32_bf16_16x16x16_transpose(ctx: DeviceContext):
    print("== test_load_and_mma_f32_bf16_16x16x16_transpose")
    test_load_and_mma_and_multiply_operands[
        DType.float32, DType.bfloat16, Index(16, 16, 16), True
    ](ctx)


# CHECK-LABEL: == test_load_and_mma_f32_bf16_16x16x16_transpose_k_group_size_4
# CHECK-LABEL: == test_load_a
# CHECK:0.0 64.0 128.0 192.0 256.0 320.0 384.0 448.0 512.0 576.0 640.0 704.0 768.0 832.0 896.0 960.0 16.0 80.0 144.0 208.0 272.0 336.0 400.0 464.0 528.0 592.0 656.0 720.0 784.0 848.0 912.0 976.0 32.0 96.0 160.0 224.0 288.0 352.0 416.0 480.0 544.0 608.0 672.0 736.0 800.0 864.0 928.0 992.0 48.0 112.0 176.0 240.0 304.0 368.0 432.0 496.0 560.0 624.0 688.0 752.0 816.0 880.0 944.0 1008.0
# CHECK-LABEL: == test_load_b
# CHECK:0.0 64.0 128.0 192.0 256.0 320.0 384.0 448.0 512.0 576.0 640.0 704.0 768.0 832.0 896.0 960.0 16.0 80.0 144.0 208.0 272.0 336.0 400.0 464.0 528.0 592.0 656.0 720.0 784.0 848.0 912.0 976.0 32.0 96.0 160.0 224.0 288.0 352.0 416.0 480.0 544.0 608.0 672.0 736.0 800.0 864.0 928.0 992.0 48.0 112.0 176.0 240.0 304.0 368.0 432.0 496.0 560.0 624.0 688.0 752.0 816.0 880.0 944.0 1008.0
# CHECK-LABEL: == test_load_c
# CHECK: 0.0 16.0 32.0 48.0
# CHECK: 1.0 17.0 33.0 49.0
# CHECK: 2.0 18.0 34.0 50.0
# CHECK: 3.0 19.0 35.0 51.0
# CHECK: 4.0 20.0 36.0 52.0
# CHECK: 5.0 21.0 37.0 53.0
# CHECK: 6.0 22.0 38.0 54.0
# CHECK: 7.0 23.0 39.0 55.0
# CHECK: 8.0 24.0 40.0 56.0
# CHECK: 9.0 25.0 41.0 57.0
# CHECK: 10.0 26.0 42.0 58.0
# CHECK: 11.0 27.0 43.0 59.0
# CHECK: 12.0 28.0 44.0 60.0
# CHECK: 13.0 29.0 45.0 61.0
# CHECK: 14.0 30.0 46.0 62.0
# CHECK: 15.0 31.0 47.0 63.0
# CHECK: 64.0 80.0 96.0 112.0
# CHECK: 65.0 81.0 97.0 113.0
# CHECK: 66.0 82.0 98.0 114.0
# CHECK: 67.0 83.0 99.0 115.0
# CHECK: 68.0 84.0 100.0 116.0
# CHECK: 69.0 85.0 101.0 117.0
# CHECK: 70.0 86.0 102.0 118.0
# CHECK: 71.0 87.0 103.0 119.0
# CHECK: 72.0 88.0 104.0 120.0
# CHECK: 73.0 89.0 105.0 121.0
# CHECK: 74.0 90.0 106.0 122.0
# CHECK: 75.0 91.0 107.0 123.0
# CHECK: 76.0 92.0 108.0 124.0
# CHECK: 77.0 93.0 109.0 125.0
# CHECK: 78.0 94.0 110.0 126.0
# CHECK: 79.0 95.0 111.0 127.0
# CHECK: 128.0 144.0 160.0 176.0
# CHECK: 129.0 145.0 161.0 177.0
# CHECK: 130.0 146.0 162.0 178.0
# CHECK: 131.0 147.0 163.0 179.0
# CHECK: 132.0 148.0 164.0 180.0
# CHECK: 133.0 149.0 165.0 181.0
# CHECK: 134.0 150.0 166.0 182.0
# CHECK: 135.0 151.0 167.0 183.0
# CHECK: 136.0 152.0 168.0 184.0
# CHECK: 137.0 153.0 169.0 185.0
# CHECK: 138.0 154.0 170.0 186.0
# CHECK: 139.0 155.0 171.0 187.0
# CHECK: 140.0 156.0 172.0 188.0
# CHECK: 141.0 157.0 173.0 189.0
# CHECK: 142.0 158.0 174.0 190.0
# CHECK: 143.0 159.0 175.0 191.0
# CHECK: 192.0 208.0 224.0 240.0
# CHECK: 193.0 209.0 225.0 241.0
# CHECK: 194.0 210.0 226.0 242.0
# CHECK: 195.0 211.0 227.0 243.0
# CHECK: 196.0 212.0 228.0 244.0
# CHECK: 197.0 213.0 229.0 245.0
# CHECK: 198.0 214.0 230.0 246.0
# CHECK: 199.0 215.0 231.0 247.0
# CHECK: 200.0 216.0 232.0 248.0
# CHECK: 201.0 217.0 233.0 249.0
# CHECK: 202.0 218.0 234.0 250.0
# CHECK: 203.0 219.0 235.0 251.0
# CHECK: 204.0 220.0 236.0 252.0
# CHECK: 205.0 221.0 237.0 253.0
# CHECK: 206.0 222.0 238.0 254.0
# CHECK: 207.0 223.0 239.0 255.0
# CHECK-LABEL: == test_load_d
# CHECK: 0.0 1.0 2.0 3.0 4.0 5.0 6.0 7.0 8.0 9.0 10.0 11.0 12.0 13.0 14.0 15.0
# CHECK: 0.0 1.0 2.0 3.0 4.0 5.0 6.0 7.0 8.0 9.0 10.0 11.0 12.0 13.0 14.0 15.0
# CHECK: 0.0 1.0 2.0 3.0 4.0 5.0 6.0 7.0 8.0 9.0 10.0 11.0 12.0 13.0 14.0 15.0
# CHECK: 0.0 1.0 2.0 3.0 4.0 5.0 6.0 7.0 8.0 9.0 10.0 11.0 12.0 13.0 14.0 15.0
# CHECK: 16.0 17.0 18.0 19.0 20.0 21.0 22.0 23.0 24.0 25.0 26.0 27.0 28.0 29.0 30.0 31.0
# CHECK: 16.0 17.0 18.0 19.0 20.0 21.0 22.0 23.0 24.0 25.0 26.0 27.0 28.0 29.0 30.0 31.0
# CHECK: 16.0 17.0 18.0 19.0 20.0 21.0 22.0 23.0 24.0 25.0 26.0 27.0 28.0 29.0 30.0 31.0
# CHECK: 16.0 17.0 18.0 19.0 20.0 21.0 22.0 23.0 24.0 25.0 26.0 27.0 28.0 29.0 30.0 31.0
# CHECK: 32.0 33.0 34.0 35.0 36.0 37.0 38.0 39.0 40.0 41.0 42.0 43.0 44.0 45.0 46.0 47.0
# CHECK: 32.0 33.0 34.0 35.0 36.0 37.0 38.0 39.0 40.0 41.0 42.0 43.0 44.0 45.0 46.0 47.0
# CHECK: 32.0 33.0 34.0 35.0 36.0 37.0 38.0 39.0 40.0 41.0 42.0 43.0 44.0 45.0 46.0 47.0
# CHECK: 32.0 33.0 34.0 35.0 36.0 37.0 38.0 39.0 40.0 41.0 42.0 43.0 44.0 45.0 46.0 47.0
# CHECK: 48.0 49.0 50.0 51.0 52.0 53.0 54.0 55.0 56.0 57.0 58.0 59.0 60.0 61.0 62.0 63.0
# CHECK: 48.0 49.0 50.0 51.0 52.0 53.0 54.0 55.0 56.0 57.0 58.0 59.0 60.0 61.0 62.0 63.0
# CHECK: 48.0 49.0 50.0 51.0 52.0 53.0 54.0 55.0 56.0 57.0 58.0 59.0 60.0 61.0 62.0 63.0
# CHECK: 48.0 49.0 50.0 51.0 52.0 53.0 54.0 55.0 56.0 57.0 58.0 59.0 60.0 61.0 62.0 63.0
# CHECK-LABEL: == test_mma
# CHECK: 85344.0 214369.0 343394.0 472419.0 601476.0 730501.0 859526.0 988551.0 1117640.0 1246665.0 1375690.0 1504715.0 1633740.0 1762765.0 1891790.0 2020815.0
# CHECK: 214384.0 605553.0 996722.0 1387891.0 1779092.0 2170261.0 2561430.0 2952599.0 3343832.0 3735001.0 4126170.0 4517339.0 4908508.0 5299677.0 5690846.0 6082015.0
# CHECK: 343424.0 996737.0 1650050.0 2303363.0 2956708.0 3610021.0 4263334.0 4916647.0 5570024.0 6223337.0 6876650.0 7529963.0 8183276.0 8836589.0 9489902.0 10143215.0
# CHECK: 472464.0 1387921.0 2303378.0 3218835.0 4134324.0 5049781.0 5965238.0 6880695.0 7796216.0 8711673.0 9627130.0 10542587.0 11458044.0 12373501.0 13288958.0 14204415.0
# CHECK: 601536.0 1779137.0 2956738.0 4134339.0 5312004.0 6489605.0 7667206.0 8844807.0 10022472.0 11200073.0 12377674.0 13555275.0 14732876.0 15910477.0 17088078.0 18265680.0
# CHECK: 730576.0 2170321.0 3610066.0 5049811.0 6489620.0 7929365.0 9369110.0 10808855.0 12248664.0 13688409.0 15128154.0 16567899.0 18007644.0 19447388.0 20887134.0 22326880.0
# CHECK: 859616.0 2561505.0 4263394.0 5965283.0 7667236.0 9369125.0 11071014.0 12772903.0 14474856.0 16176745.0 17878634.0 19580524.0 21282412.0 22984300.0 24686190.0 26388080.0
# CHECK: 988656.0 2952689.0 4916722.0 6880755.0 8844852.0 10808885.0 12772918.0 14736951.0 16701048.0 18665080.0 20629114.0 22593148.0 24557180.0 26521212.0 28485246.0 30449280.0
# CHECK: 1117760.0 3343937.0 5570114.0 7796291.0 10022532.0 12248709.0 14474886.0 16701063.0 18927368.0 21153544.0 23379722.0 25605900.0 27832076.0 30058252.0 32284430.0 34510610.0
# CHECK: 1246800.0 3735121.0 6223442.0 8711763.0 11200148.0 13688469.0 16176790.0 18665112.0 21153560.0 23641880.0 26130202.0 28618524.0 31106844.0 33595164.0 36083490.0 38571810.0
# CHECK: 1375840.0 4126305.0 6876770.0 9627235.0 12377764.0 15128229.0 17878694.0 20629160.0 23379752.0 26130216.0 28880682.0 31631148.0 34381612.0 37132076.0 39882544.0 42633010.0
# CHECK: 1504880.0 4517489.0 7530098.0 10542707.0 13555380.0 16567989.0 19580598.0 22593208.0 25605944.0 28618552.0 31631162.0 34643772.0 37656380.0 40668990.0 43681600.0 46694210.0
# CHECK: 1633920.0 4908673.0 8183426.0 11458179.0 14732996.0 18007748.0 21282502.0 24557256.0 27832136.0 31106888.0 34381640.0 37656396.0 40931150.0 44205900.0 47480656.0 50755410.0
# CHECK: 1762960.0 5299857.0 8836754.0 12373651.0 15910612.0 19447508.0 22984406.0 26521304.0 30058328.0 33595224.0 37132120.0 40669020.0 44205916.0 47742810.0 51279712.0 54816610.0
# CHECK: 1892000.0 5691041.0 9490082.0 13289123.0 17088228.0 20887268.0 24686310.0 28485352.0 32284520.0 36083560.0 39882600.0 43681644.0 47480684.0 51279724.0 55078770.0 58877810.0
# CHECK: 2021040.0 6082225.0 10143410.0 14204595.0 18265844.0 22327028.0 26388214.0 30449400.0 34510712.0 38571896.0 42633080.0 46694270.0 50755450.0 54816636.0 58877824.0 62939010.0
def test_load_and_mma_f32_bf16_16x16x16_transpose_k_group_size_4(
    ctx: DeviceContext,
):
    print("== test_load_and_mma_f32_bf16_16x16x16_transpose_k_group_size_4")
    test_load_and_mma_and_multiply_operands[
        DType.float32, DType.bfloat16, Index(16, 16, 16), True, 4
    ](ctx)


# CHECK-LABEL: test_load_and_mma_f32_f16_16x16x16
# CHECK-LABEL: test_load_a
# CHECK: 0.0 16.0 32.0 48.0 64.0 80.0 96.0 112.0 128.0 144.0 160.0 176.0 192.0 208.0 224.0 240.0 4.0 20.0 36.0 52.0 68.0 84.0 100.0 116.0 132.0 148.0 164.0 180.0 196.0 212.0 228.0 244.0 8.0 24.0 40.0 56.0 72.0 88.0 104.0 120.0 136.0 152.0 168.0 184.0 200.0 216.0 232.0 248.0 12.0 28.0 44.0 60.0 76.0 92.0 108.0 124.0 140.0 156.0 172.0 188.0 204.0 220.0 236.0 252.0
# CHECK-LABEL: test_load_b
# CHECK: 0.0 1.0 2.0 3.0 4.0 5.0 6.0 7.0 8.0 9.0 10.0 11.0 12.0 13.0 14.0 15.0 64.0 65.0 66.0 67.0 68.0 69.0 70.0 71.0 72.0 73.0 74.0 75.0 76.0 77.0 78.0 79.0 128.0 129.0 130.0 131.0 132.0 133.0 134.0 135.0 136.0 137.0 138.0 139.0 140.0 141.0 142.0 143.0 192.0 193.0 194.0 195.0 196.0 197.0 198.0 199.0 200.0 201.0 202.0 203.0 204.0 205.0 206.0 207.0
# CHECK-LABEL: test_load_c
# CHECK: 0.0 16.0 32.0 48.0
# CHECK: 1.0 17.0 33.0 49.0
# CHECK: 2.0 18.0 34.0 50.0
# CHECK: 3.0 19.0 35.0 51.0
# CHECK: 4.0 20.0 36.0 52.0
# CHECK: 5.0 21.0 37.0 53.0
# CHECK: 6.0 22.0 38.0 54.0
# CHECK: 7.0 23.0 39.0 55.0
# CHECK: 8.0 24.0 40.0 56.0
# CHECK: 9.0 25.0 41.0 57.0
# CHECK: 10.0 26.0 42.0 58.0
# CHECK: 11.0 27.0 43.0 59.0
# CHECK: 12.0 28.0 44.0 60.0
# CHECK: 13.0 29.0 45.0 61.0
# CHECK: 14.0 30.0 46.0 62.0
# CHECK: 15.0 31.0 47.0 63.0
# CHECK: 64.0 80.0 96.0 112.0
# CHECK: 65.0 81.0 97.0 113.0
# CHECK: 66.0 82.0 98.0 114.0
# CHECK: 67.0 83.0 99.0 115.0
# CHECK: 68.0 84.0 100.0 116.0
# CHECK: 69.0 85.0 101.0 117.0
# CHECK: 70.0 86.0 102.0 118.0
# CHECK: 71.0 87.0 103.0 119.0
# CHECK: 72.0 88.0 104.0 120.0
# CHECK: 73.0 89.0 105.0 121.0
# CHECK: 74.0 90.0 106.0 122.0
# CHECK: 75.0 91.0 107.0 123.0
# CHECK: 76.0 92.0 108.0 124.0
# CHECK: 77.0 93.0 109.0 125.0
# CHECK: 78.0 94.0 110.0 126.0
# CHECK: 79.0 95.0 111.0 127.0
# CHECK: 128.0 144.0 160.0 176.0
# CHECK: 129.0 145.0 161.0 177.0
# CHECK: 130.0 146.0 162.0 178.0
# CHECK: 131.0 147.0 163.0 179.0
# CHECK: 132.0 148.0 164.0 180.0
# CHECK: 133.0 149.0 165.0 181.0
# CHECK: 134.0 150.0 166.0 182.0
# CHECK: 135.0 151.0 167.0 183.0
# CHECK: 136.0 152.0 168.0 184.0
# CHECK: 137.0 153.0 169.0 185.0
# CHECK: 138.0 154.0 170.0 186.0
# CHECK: 139.0 155.0 171.0 187.0
# CHECK: 140.0 156.0 172.0 188.0
# CHECK: 141.0 157.0 173.0 189.0
# CHECK: 142.0 158.0 174.0 190.0
# CHECK: 143.0 159.0 175.0 191.0
# CHECK: 192.0 208.0 224.0 240.0
# CHECK: 193.0 209.0 225.0 241.0
# CHECK: 194.0 210.0 226.0 242.0
# CHECK: 195.0 211.0 227.0 243.0
# CHECK: 196.0 212.0 228.0 244.0
# CHECK: 197.0 213.0 229.0 245.0
# CHECK: 198.0 214.0 230.0 246.0
# CHECK: 199.0 215.0 231.0 247.0
# CHECK: 200.0 216.0 232.0 248.0
# CHECK: 201.0 217.0 233.0 249.0
# CHECK: 202.0 218.0 234.0 250.0
# CHECK: 203.0 219.0 235.0 251.0
# CHECK: 204.0 220.0 236.0 252.0
# CHECK: 205.0 221.0 237.0 253.0
# CHECK: 206.0 222.0 238.0 254.0
# CHECK: 207.0 223.0 239.0 255.0
# CHECK-LABEL: test_load_d
# CHECK: 0.0 1.0 2.0 3.0 4.0 5.0 6.0 7.0 8.0 9.0 10.0 11.0 12.0 13.0 14.0 15.0
# CHECK: 0.0 1.0 2.0 3.0 4.0 5.0 6.0 7.0 8.0 9.0 10.0 11.0 12.0 13.0 14.0 15.0
# CHECK: 0.0 1.0 2.0 3.0 4.0 5.0 6.0 7.0 8.0 9.0 10.0 11.0 12.0 13.0 14.0 15.0
# CHECK: 0.0 1.0 2.0 3.0 4.0 5.0 6.0 7.0 8.0 9.0 10.0 11.0 12.0 13.0 14.0 15.0
# CHECK: 16.0 17.0 18.0 19.0 20.0 21.0 22.0 23.0 24.0 25.0 26.0 27.0 28.0 29.0 30.0 31.0
# CHECK: 16.0 17.0 18.0 19.0 20.0 21.0 22.0 23.0 24.0 25.0 26.0 27.0 28.0 29.0 30.0 31.0
# CHECK: 16.0 17.0 18.0 19.0 20.0 21.0 22.0 23.0 24.0 25.0 26.0 27.0 28.0 29.0 30.0 31.0
# CHECK: 16.0 17.0 18.0 19.0 20.0 21.0 22.0 23.0 24.0 25.0 26.0 27.0 28.0 29.0 30.0 31.0
# CHECK: 32.0 33.0 34.0 35.0 36.0 37.0 38.0 39.0 40.0 41.0 42.0 43.0 44.0 45.0 46.0 47.0
# CHECK: 32.0 33.0 34.0 35.0 36.0 37.0 38.0 39.0 40.0 41.0 42.0 43.0 44.0 45.0 46.0 47.0
# CHECK: 32.0 33.0 34.0 35.0 36.0 37.0 38.0 39.0 40.0 41.0 42.0 43.0 44.0 45.0 46.0 47.0
# CHECK: 32.0 33.0 34.0 35.0 36.0 37.0 38.0 39.0 40.0 41.0 42.0 43.0 44.0 45.0 46.0 47.0
# CHECK: 48.0 49.0 50.0 51.0 52.0 53.0 54.0 55.0 56.0 57.0 58.0 59.0 60.0 61.0 62.0 63.0
# CHECK: 48.0 49.0 50.0 51.0 52.0 53.0 54.0 55.0 56.0 57.0 58.0 59.0 60.0 61.0 62.0 63.0
# CHECK: 48.0 49.0 50.0 51.0 52.0 53.0 54.0 55.0 56.0 57.0 58.0 59.0 60.0 61.0 62.0 63.0
# CHECK: 48.0 49.0 50.0 51.0 52.0 53.0 54.0 55.0 56.0 57.0 58.0 59.0 60.0 61.0 62.0 63.0
# CHECK-LABEL: test_mma
# CHECK: 19840.0 19961.0 20082.0 20203.0 20324.0 20445.0 20566.0 20687.0 20808.0 20929.0 21050.0 21171.0 21292.0 21413.0 21534.0 21655.0
# CHECK: 50576.0 50953.0 51330.0 51707.0 52084.0 52461.0 52838.0 53215.0 53592.0 53969.0 54346.0 54723.0 55100.0 55477.0 55854.0 56231.0
# CHECK: 81312.0 81945.0 82578.0 83211.0 83844.0 84477.0 85110.0 85743.0 86376.0 87009.0 87642.0 88275.0 88908.0 89541.0 90174.0 90807.0
# CHECK: 112048.0 112937.0 113826.0 114715.0 115604.0 116493.0 117382.0 118271.0 119160.0 120049.0 120938.0 121827.0 122716.0 123605.0 124494.0 125383.0
# CHECK: 142784.0 143929.0 145074.0 146219.0 147364.0 148509.0 149654.0 150799.0 151944.0 153089.0 154234.0 155379.0 156524.0 157669.0 158814.0 159959.0
# CHECK: 173520.0 174921.0 176322.0 177723.0 179124.0 180525.0 181926.0 183327.0 184728.0 186129.0 187530.0 188931.0 190332.0 191733.0 193134.0 194535.0
# CHECK: 204256.0 205913.0 207570.0 209227.0 210884.0 212541.0 214198.0 215855.0 217512.0 219169.0 220826.0 222483.0 224140.0 225797.0 227454.0 229111.0
# CHECK: 234992.0 236905.0 238818.0 240731.0 242644.0 244557.0 246470.0 248383.0 250296.0 252209.0 254122.0 256035.0 257948.0 259861.0 261774.0 263687.0
# CHECK: 265728.0 267897.0 270066.0 272235.0 274404.0 276573.0 278742.0 280911.0 283080.0 285249.0 287418.0 289587.0 291756.0 293925.0 296094.0 298263.0
# CHECK: 296464.0 298889.0 301314.0 303739.0 306164.0 308589.0 311014.0 313439.0 315864.0 318289.0 320714.0 323139.0 325564.0 327989.0 330414.0 332839.0
# CHECK: 327200.0 329881.0 332562.0 335243.0 337924.0 340605.0 343286.0 345967.0 348648.0 351329.0 354010.0 356691.0 359372.0 362053.0 364734.0 367415.0
# CHECK: 357936.0 360873.0 363810.0 366747.0 369684.0 372621.0 375558.0 378495.0 381432.0 384369.0 387306.0 390243.0 393180.0 396117.0 399054.0 401991.0
# CHECK: 388672.0 391865.0 395058.0 398251.0 401444.0 404637.0 407830.0 411023.0 414216.0 417409.0 420602.0 423795.0 426988.0 430181.0 433374.0 436567.0
# CHECK: 419408.0 422857.0 426306.0 429755.0 433204.0 436653.0 440102.0 443551.0 447000.0 450449.0 453898.0 457347.0 460796.0 464245.0 467694.0 471143.0
# CHECK: 450144.0 453849.0 457554.0 461259.0 464964.0 468669.0 472374.0 476079.0 479784.0 483489.0 487194.0 490899.0 494604.0 498309.0 502014.0 505719.0
# CHECK: 480880.0 484841.0 488802.0 492763.0 496724.0 500685.0 504646.0 508607.0 512568.0 516529.0 520490.0 524451.0 528412.0 532373.0 536334.0 540295.0


def test_load_and_mma_f32_f16_16x16x16(ctx: DeviceContext):
    print("== test_load_and_mma_f32_f16_16x16x16")
    test_load_and_mma_and_multiply_operands[
        DType.float32, DType.float16, Index(16, 16, 16), False
    ](ctx)


# CHECK-LABEL: == test_load_and_mma_f32_f16_16x16x16_transpose
# CHECK-LABEL: == test_load_a
# CHECK:0.0 16.0 32.0 48.0 64.0 80.0 96.0 112.0 128.0 144.0 160.0 176.0 192.0 208.0 224.0 240.0 4.0 20.0 36.0 52.0 68.0 84.0 100.0 116.0 132.0 148.0 164.0 180.0 196.0 212.0 228.0 244.0 8.0 24.0 40.0 56.0 72.0 88.0 104.0 120.0 136.0 152.0 168.0 184.0 200.0 216.0 232.0 248.0 12.0 28.0 44.0 60.0 76.0 92.0 108.0 124.0 140.0 156.0 172.0 188.0 204.0 220.0 236.0 252.0
# CHECK-LABEL: == test_load_b
# CHECK:0.0 16.0 32.0 48.0 64.0 80.0 96.0 112.0 128.0 144.0 160.0 176.0 192.0 208.0 224.0 240.0 4.0 20.0 36.0 52.0 68.0 84.0 100.0 116.0 132.0 148.0 164.0 180.0 196.0 212.0 228.0 244.0 8.0 24.0 40.0 56.0 72.0 88.0 104.0 120.0 136.0 152.0 168.0 184.0 200.0 216.0 232.0 248.0 12.0 28.0 44.0 60.0 76.0 92.0 108.0 124.0 140.0 156.0 172.0 188.0 204.0 220.0 236.0 252.0
# CHECK-LABEL: == test_load_c
# CHECK: 0.0 16.0 32.0 48.0
# CHECK: 1.0 17.0 33.0 49.0
# CHECK: 2.0 18.0 34.0 50.0
# CHECK: 3.0 19.0 35.0 51.0
# CHECK: 4.0 20.0 36.0 52.0
# CHECK: 5.0 21.0 37.0 53.0
# CHECK: 6.0 22.0 38.0 54.0
# CHECK: 7.0 23.0 39.0 55.0
# CHECK: 8.0 24.0 40.0 56.0
# CHECK: 9.0 25.0 41.0 57.0
# CHECK: 10.0 26.0 42.0 58.0
# CHECK: 11.0 27.0 43.0 59.0
# CHECK: 12.0 28.0 44.0 60.0
# CHECK: 13.0 29.0 45.0 61.0
# CHECK: 14.0 30.0 46.0 62.0
# CHECK: 15.0 31.0 47.0 63.0
# CHECK: 64.0 80.0 96.0 112.0
# CHECK: 65.0 81.0 97.0 113.0
# CHECK: 66.0 82.0 98.0 114.0
# CHECK: 67.0 83.0 99.0 115.0
# CHECK: 68.0 84.0 100.0 116.0
# CHECK: 69.0 85.0 101.0 117.0
# CHECK: 70.0 86.0 102.0 118.0
# CHECK: 71.0 87.0 103.0 119.0
# CHECK: 72.0 88.0 104.0 120.0
# CHECK: 73.0 89.0 105.0 121.0
# CHECK: 74.0 90.0 106.0 122.0
# CHECK: 75.0 91.0 107.0 123.0
# CHECK: 76.0 92.0 108.0 124.0
# CHECK: 77.0 93.0 109.0 125.0
# CHECK: 78.0 94.0 110.0 126.0
# CHECK: 79.0 95.0 111.0 127.0
# CHECK: 128.0 144.0 160.0 176.0
# CHECK: 129.0 145.0 161.0 177.0
# CHECK: 130.0 146.0 162.0 178.0
# CHECK: 131.0 147.0 163.0 179.0
# CHECK: 132.0 148.0 164.0 180.0
# CHECK: 133.0 149.0 165.0 181.0
# CHECK: 134.0 150.0 166.0 182.0
# CHECK: 135.0 151.0 167.0 183.0
# CHECK: 136.0 152.0 168.0 184.0
# CHECK: 137.0 153.0 169.0 185.0
# CHECK: 138.0 154.0 170.0 186.0
# CHECK: 139.0 155.0 171.0 187.0
# CHECK: 140.0 156.0 172.0 188.0
# CHECK: 141.0 157.0 173.0 189.0
# CHECK: 142.0 158.0 174.0 190.0
# CHECK: 143.0 159.0 175.0 191.0
# CHECK: 192.0 208.0 224.0 240.0
# CHECK: 193.0 209.0 225.0 241.0
# CHECK: 194.0 210.0 226.0 242.0
# CHECK: 195.0 211.0 227.0 243.0
# CHECK: 196.0 212.0 228.0 244.0
# CHECK: 197.0 213.0 229.0 245.0
# CHECK: 198.0 214.0 230.0 246.0
# CHECK: 199.0 215.0 231.0 247.0
# CHECK: 200.0 216.0 232.0 248.0
# CHECK: 201.0 217.0 233.0 249.0
# CHECK: 202.0 218.0 234.0 250.0
# CHECK: 203.0 219.0 235.0 251.0
# CHECK: 204.0 220.0 236.0 252.0
# CHECK: 205.0 221.0 237.0 253.0
# CHECK: 206.0 222.0 238.0 254.0
# CHECK: 207.0 223.0 239.0 255.0
# CHECK-LABEL: == test_load_d
# CHECK: 0.0 1.0 2.0 3.0 4.0 5.0 6.0 7.0 8.0 9.0 10.0 11.0 12.0 13.0 14.0 15.0
# CHECK: 0.0 1.0 2.0 3.0 4.0 5.0 6.0 7.0 8.0 9.0 10.0 11.0 12.0 13.0 14.0 15.0
# CHECK: 0.0 1.0 2.0 3.0 4.0 5.0 6.0 7.0 8.0 9.0 10.0 11.0 12.0 13.0 14.0 15.0
# CHECK: 0.0 1.0 2.0 3.0 4.0 5.0 6.0 7.0 8.0 9.0 10.0 11.0 12.0 13.0 14.0 15.0
# CHECK: 16.0 17.0 18.0 19.0 20.0 21.0 22.0 23.0 24.0 25.0 26.0 27.0 28.0 29.0 30.0 31.0
# CHECK: 16.0 17.0 18.0 19.0 20.0 21.0 22.0 23.0 24.0 25.0 26.0 27.0 28.0 29.0 30.0 31.0
# CHECK: 16.0 17.0 18.0 19.0 20.0 21.0 22.0 23.0 24.0 25.0 26.0 27.0 28.0 29.0 30.0 31.0
# CHECK: 16.0 17.0 18.0 19.0 20.0 21.0 22.0 23.0 24.0 25.0 26.0 27.0 28.0 29.0 30.0 31.0
# CHECK: 32.0 33.0 34.0 35.0 36.0 37.0 38.0 39.0 40.0 41.0 42.0 43.0 44.0 45.0 46.0 47.0
# CHECK: 32.0 33.0 34.0 35.0 36.0 37.0 38.0 39.0 40.0 41.0 42.0 43.0 44.0 45.0 46.0 47.0
# CHECK: 32.0 33.0 34.0 35.0 36.0 37.0 38.0 39.0 40.0 41.0 42.0 43.0 44.0 45.0 46.0 47.0
# CHECK: 32.0 33.0 34.0 35.0 36.0 37.0 38.0 39.0 40.0 41.0 42.0 43.0 44.0 45.0 46.0 47.0
# CHECK: 48.0 49.0 50.0 51.0 52.0 53.0 54.0 55.0 56.0 57.0 58.0 59.0 60.0 61.0 62.0 63.0
# CHECK: 48.0 49.0 50.0 51.0 52.0 53.0 54.0 55.0 56.0 57.0 58.0 59.0 60.0 61.0 62.0 63.0
# CHECK: 48.0 49.0 50.0 51.0 52.0 53.0 54.0 55.0 56.0 57.0 58.0 59.0 60.0 61.0 62.0 63.0
# CHECK: 48.0 49.0 50.0 51.0 52.0 53.0 54.0 55.0 56.0 57.0 58.0 59.0 60.0 61.0 62.0 63.0
# CHECK-LABEL: == test_mma
# CHECK: 1240.0 3161.0 5082.0 7003.0 8924.0 10845.0 12766.0 14687.0 16608.0 18529.0 20450.0 22371.0 24292.0 26213.0 28134.0 30055.0
# CHECK: 3176.0 9193.0 15210.0 21227.0 27244.0 33261.0 39278.0 45295.0 51312.0 57329.0 63346.0 69363.0 75380.0 81397.0 87414.0 93431.0
# CHECK: 5112.0 15225.0 25338.0 35451.0 45564.0 55677.0 65790.0 75903.0 86016.0 96129.0 106242.0 116355.0 126468.0 136581.0 146694.0 156807.0
# CHECK: 7048.0 21257.0 35466.0 49675.0 63884.0 78093.0 92302.0 106511.0 120720.0 134929.0 149138.0 163347.0 177556.0 191765.0 205974.0 220183.0
# CHECK: 8984.0 27289.0 45594.0 63899.0 82204.0 100509.0 118814.0 137119.0 155424.0 173729.0 192034.0 210339.0 228644.0 246949.0 265254.0 283559.0
# CHECK: 10920.0 33321.0 55722.0 78123.0 100524.0 122925.0 145326.0 167727.0 190128.0 212529.0 234930.0 257331.0 279732.0 302133.0 324534.0 346935.0
# CHECK: 12856.0 39353.0 65850.0 92347.0 118844.0 145341.0 171838.0 198335.0 224832.0 251329.0 277826.0 304323.0 330820.0 357317.0 383814.0 410311.0
# CHECK: 14792.0 45385.0 75978.0 106571.0 137164.0 167757.0 198350.0 228943.0 259536.0 290129.0 320722.0 351315.0 381908.0 412501.0 443094.0 473687.0
# CHECK: 16728.0 51417.0 86106.0 120795.0 155484.0 190173.0 224862.0 259551.0 294240.0 328929.0 363618.0 398307.0 432996.0 467685.0 502374.0 537063.0
# CHECK: 18664.0 57449.0 96234.0 135019.0 173804.0 212589.0 251374.0 290159.0 328944.0 367729.0 406514.0 445299.0 484084.0 522869.0 561654.0 600439.0
# CHECK: 20600.0 63481.0 106362.0 149243.0 192124.0 235005.0 277886.0 320767.0 363648.0 406529.0 449410.0 492291.0 535172.0 578053.0 620934.0 663815.0
# CHECK: 22536.0 69513.0 116490.0 163467.0 210444.0 257421.0 304398.0 351375.0 398352.0 445329.0 492306.0 539283.0 586260.0 633237.0 680214.0 727191.0
# CHECK: 24472.0 75545.0 126618.0 177691.0 228764.0 279837.0 330910.0 381983.0 433056.0 484129.0 535202.0 586275.0 637348.0 688421.0 739494.0 790567.0
# CHECK: 26408.0 81577.0 136746.0 191915.0 247084.0 302253.0 357422.0 412591.0 467760.0 522929.0 578098.0 633267.0 688436.0 743605.0 798774.0 853943.0
# CHECK: 28344.0 87609.0 146874.0 206139.0 265404.0 324669.0 383934.0 443199.0 502464.0 561729.0 620994.0 680259.0 739524.0 798789.0 858054.0 917319.0
# CHECK: 30280.0 93641.0 157002.0 220363.0 283724.0 347085.0 410446.0 473807.0 537168.0 600529.0 663890.0 727251.0 790612.0 853973.0 917334.0 980695.0


def test_load_and_mma_f32_f16_16x16x16_transpose(ctx: DeviceContext):
    print("== test_load_and_mma_f32_f16_16x16x16_transpose")
    test_load_and_mma_and_multiply_operands[
        DType.float32, DType.float16, Index(16, 16, 16), True
    ](ctx)


# CHECK-LABEL: test_load_and_mma_f32_bf16_32x32x8
# CHECK-LABEL: test_load_a
# CHECK: 0.0 8.0 16.0 24.0 32.0 40.0 48.0 56.0 64.0 72.0 80.0 88.0 96.0 104.0 112.0 120.0 128.0 136.0 144.0 152.0 160.0 168.0 176.0 184.0 192.0 200.0 208.0 216.0 224.0 232.0 240.0 248.0 4.0 12.0 20.0 28.0 36.0 44.0 52.0 60.0 68.0 76.0 84.0 92.0 100.0 108.0 116.0 124.0 132.0 140.0 148.0 156.0 164.0 172.0 180.0 188.0 196.0 204.0 212.0 220.0 228.0 236.0 244.0 252.0
# CHECK-LABEL: test_load_b
# CHECK: 0.0 1.0 2.0 3.0 4.0 5.0 6.0 7.0 8.0 9.0 10.0 11.0 12.0 13.0 14.0 15.0 16.0 17.0 18.0 19.0 20.0 21.0 22.0 23.0 24.0 25.0 26.0 27.0 28.0 29.0 30.0 31.0 128.0 129.0 130.0 131.0 132.0 133.0 134.0 135.0 136.0 137.0 138.0 139.0 140.0 141.0 142.0 143.0 144.0 145.0 146.0 147.0 148.0 149.0 150.0 151.0 152.0 153.0 154.0 155.0 156.0 157.0 158.0 159.0
# CHECK-LABEL: test_load_c
# CHECK: 0.0 32.0 64.0 96.0
# CHECK: 1.0 33.0 65.0 97.0
# CHECK: 2.0 34.0 66.0 98.0
# CHECK: 3.0 35.0 67.0 99.0
# CHECK: 4.0 36.0 68.0 100.0
# CHECK: 5.0 37.0 69.0 101.0
# CHECK: 6.0 38.0 70.0 102.0
# CHECK: 7.0 39.0 71.0 103.0
# CHECK: 8.0 40.0 72.0 104.0
# CHECK: 9.0 41.0 73.0 105.0
# CHECK: 10.0 42.0 74.0 106.0
# CHECK: 11.0 43.0 75.0 107.0
# CHECK: 12.0 44.0 76.0 108.0
# CHECK: 13.0 45.0 77.0 109.0
# CHECK: 14.0 46.0 78.0 110.0
# CHECK: 15.0 47.0 79.0 111.0
# CHECK: 16.0 48.0 80.0 112.0
# CHECK: 17.0 49.0 81.0 113.0
# CHECK: 18.0 50.0 82.0 114.0
# CHECK: 19.0 51.0 83.0 115.0
# CHECK: 20.0 52.0 84.0 116.0
# CHECK: 21.0 53.0 85.0 117.0
# CHECK: 22.0 54.0 86.0 118.0
# CHECK: 23.0 55.0 87.0 119.0
# CHECK: 24.0 56.0 88.0 120.0
# CHECK: 25.0 57.0 89.0 121.0
# CHECK: 26.0 58.0 90.0 122.0
# CHECK: 27.0 59.0 91.0 123.0
# CHECK: 28.0 60.0 92.0 124.0
# CHECK: 29.0 61.0 93.0 125.0
# CHECK: 30.0 62.0 94.0 126.0
# CHECK: 31.0 63.0 95.0 127.0
# CHECK: 128.0 160.0 192.0 224.0
# CHECK: 129.0 161.0 193.0 225.0
# CHECK: 130.0 162.0 194.0 226.0
# CHECK: 131.0 163.0 195.0 227.0
# CHECK: 132.0 164.0 196.0 228.0
# CHECK: 133.0 165.0 197.0 229.0
# CHECK: 134.0 166.0 198.0 230.0
# CHECK: 135.0 167.0 199.0 231.0
# CHECK: 136.0 168.0 200.0 232.0
# CHECK: 137.0 169.0 201.0 233.0
# CHECK: 138.0 170.0 202.0 234.0
# CHECK: 139.0 171.0 203.0 235.0
# CHECK: 140.0 172.0 204.0 236.0
# CHECK: 141.0 173.0 205.0 237.0
# CHECK: 142.0 174.0 206.0 238.0
# CHECK: 143.0 175.0 207.0 239.0
# CHECK: 144.0 176.0 208.0 240.0
# CHECK: 145.0 177.0 209.0 241.0
# CHECK: 146.0 178.0 210.0 242.0
# CHECK: 147.0 179.0 211.0 243.0
# CHECK: 148.0 180.0 212.0 244.0
# CHECK: 149.0 181.0 213.0 245.0
# CHECK: 150.0 182.0 214.0 246.0
# CHECK: 151.0 183.0 215.0 247.0
# CHECK: 152.0 184.0 216.0 248.0
# CHECK: 153.0 185.0 217.0 249.0
# CHECK: 154.0 186.0 218.0 250.0
# CHECK: 155.0 187.0 219.0 251.0
# CHECK: 156.0 188.0 220.0 252.0
# CHECK: 157.0 189.0 221.0 253.0
# CHECK: 158.0 190.0 222.0 254.0
# CHECK: 159.0 191.0 223.0 255.0
# CHECK-LABEL: test_load_d
# CHECK: 0.0 1.0 2.0 3.0 4.0 5.0 6.0 7.0 8.0 9.0 10.0 11.0 12.0 13.0 14.0 15.0 16.0 17.0 18.0 19.0 20.0 21.0 22.0 23.0 24.0 25.0 26.0 27.0 28.0 29.0 30.0 31.0
# CHECK: 0.0 1.0 2.0 3.0 4.0 5.0 6.0 7.0 8.0 9.0 10.0 11.0 12.0 13.0 14.0 15.0 16.0 17.0 18.0 19.0 20.0 21.0 22.0 23.0 24.0 25.0 26.0 27.0 28.0 29.0 30.0 31.0
# CHECK: 0.0 1.0 2.0 3.0 4.0 5.0 6.0 7.0 8.0 9.0 10.0 11.0 12.0 13.0 14.0 15.0 16.0 17.0 18.0 19.0 20.0 21.0 22.0 23.0 24.0 25.0 26.0 27.0 28.0 29.0 30.0 31.0
# CHECK: 0.0 1.0 2.0 3.0 4.0 5.0 6.0 7.0 8.0 9.0 10.0 11.0 12.0 13.0 14.0 15.0 16.0 17.0 18.0 19.0 20.0 21.0 22.0 23.0 24.0 25.0 26.0 27.0 28.0 29.0 30.0 31.0
# CHECK: 32.0 33.0 34.0 35.0 36.0 37.0 38.0 39.0 40.0 41.0 42.0 43.0 44.0 45.0 46.0 47.0 48.0 49.0 50.0 51.0 52.0 53.0 54.0 55.0 56.0 57.0 58.0 59.0 60.0 61.0 62.0 63.0
# CHECK: 32.0 33.0 34.0 35.0 36.0 37.0 38.0 39.0 40.0 41.0 42.0 43.0 44.0 45.0 46.0 47.0 48.0 49.0 50.0 51.0 52.0 53.0 54.0 55.0 56.0 57.0 58.0 59.0 60.0 61.0 62.0 63.0
# CHECK: 32.0 33.0 34.0 35.0 36.0 37.0 38.0 39.0 40.0 41.0 42.0 43.0 44.0 45.0 46.0 47.0 48.0 49.0 50.0 51.0 52.0 53.0 54.0 55.0 56.0 57.0 58.0 59.0 60.0 61.0 62.0 63.0
# CHECK: 32.0 33.0 34.0 35.0 36.0 37.0 38.0 39.0 40.0 41.0 42.0 43.0 44.0 45.0 46.0 47.0 48.0 49.0 50.0 51.0 52.0 53.0 54.0 55.0 56.0 57.0 58.0 59.0 60.0 61.0 62.0 63.0
# CHECK: 0.0 1.0 2.0 3.0 4.0 5.0 6.0 7.0 8.0 9.0 10.0 11.0 12.0 13.0 14.0 15.0 16.0 17.0 18.0 19.0 20.0 21.0 22.0 23.0 24.0 25.0 26.0 27.0 28.0 29.0 30.0 31.0
# CHECK: 0.0 1.0 2.0 3.0 4.0 5.0 6.0 7.0 8.0 9.0 10.0 11.0 12.0 13.0 14.0 15.0 16.0 17.0 18.0 19.0 20.0 21.0 22.0 23.0 24.0 25.0 26.0 27.0 28.0 29.0 30.0 31.0
# CHECK: 0.0 1.0 2.0 3.0 4.0 5.0 6.0 7.0 8.0 9.0 10.0 11.0 12.0 13.0 14.0 15.0 16.0 17.0 18.0 19.0 20.0 21.0 22.0 23.0 24.0 25.0 26.0 27.0 28.0 29.0 30.0 31.0
# CHECK: 0.0 1.0 2.0 3.0 4.0 5.0 6.0 7.0 8.0 9.0 10.0 11.0 12.0 13.0 14.0 15.0 16.0 17.0 18.0 19.0 20.0 21.0 22.0 23.0 24.0 25.0 26.0 27.0 28.0 29.0 30.0 31.0
# CHECK: 32.0 33.0 34.0 35.0 36.0 37.0 38.0 39.0 40.0 41.0 42.0 43.0 44.0 45.0 46.0 47.0 48.0 49.0 50.0 51.0 52.0 53.0 54.0 55.0 56.0 57.0 58.0 59.0 60.0 61.0 62.0 63.0
# CHECK: 32.0 33.0 34.0 35.0 36.0 37.0 38.0 39.0 40.0 41.0 42.0 43.0 44.0 45.0 46.0 47.0 48.0 49.0 50.0 51.0 52.0 53.0 54.0 55.0 56.0 57.0 58.0 59.0 60.0 61.0 62.0 63.0
# CHECK: 32.0 33.0 34.0 35.0 36.0 37.0 38.0 39.0 40.0 41.0 42.0 43.0 44.0 45.0 46.0 47.0 48.0 49.0 50.0 51.0 52.0 53.0 54.0 55.0 56.0 57.0 58.0 59.0 60.0 61.0 62.0 63.0
# CHECK: 32.0 33.0 34.0 35.0 36.0 37.0 38.0 39.0 40.0 41.0 42.0 43.0 44.0 45.0 46.0 47.0 48.0 49.0 50.0 51.0 52.0 53.0 54.0 55.0 56.0 57.0 58.0 59.0 60.0 61.0 62.0 63.0
# CHECK: 0.0 1.0 2.0 3.0 4.0 5.0 6.0 7.0 8.0 9.0 10.0 11.0 12.0 13.0 14.0 15.0 16.0 17.0 18.0 19.0 20.0 21.0 22.0 23.0 24.0 25.0 26.0 27.0 28.0 29.0 30.0 31.0
# CHECK: 0.0 1.0 2.0 3.0 4.0 5.0 6.0 7.0 8.0 9.0 10.0 11.0 12.0 13.0 14.0 15.0 16.0 17.0 18.0 19.0 20.0 21.0 22.0 23.0 24.0 25.0 26.0 27.0 28.0 29.0 30.0 31.0
# CHECK: 0.0 1.0 2.0 3.0 4.0 5.0 6.0 7.0 8.0 9.0 10.0 11.0 12.0 13.0 14.0 15.0 16.0 17.0 18.0 19.0 20.0 21.0 22.0 23.0 24.0 25.0 26.0 27.0 28.0 29.0 30.0 31.0
# CHECK: 0.0 1.0 2.0 3.0 4.0 5.0 6.0 7.0 8.0 9.0 10.0 11.0 12.0 13.0 14.0 15.0 16.0 17.0 18.0 19.0 20.0 21.0 22.0 23.0 24.0 25.0 26.0 27.0 28.0 29.0 30.0 31.0
# CHECK: 32.0 33.0 34.0 35.0 36.0 37.0 38.0 39.0 40.0 41.0 42.0 43.0 44.0 45.0 46.0 47.0 48.0 49.0 50.0 51.0 52.0 53.0 54.0 55.0 56.0 57.0 58.0 59.0 60.0 61.0 62.0 63.0
# CHECK: 32.0 33.0 34.0 35.0 36.0 37.0 38.0 39.0 40.0 41.0 42.0 43.0 44.0 45.0 46.0 47.0 48.0 49.0 50.0 51.0 52.0 53.0 54.0 55.0 56.0 57.0 58.0 59.0 60.0 61.0 62.0 63.0
# CHECK: 32.0 33.0 34.0 35.0 36.0 37.0 38.0 39.0 40.0 41.0 42.0 43.0 44.0 45.0 46.0 47.0 48.0 49.0 50.0 51.0 52.0 53.0 54.0 55.0 56.0 57.0 58.0 59.0 60.0 61.0 62.0 63.0
# CHECK: 32.0 33.0 34.0 35.0 36.0 37.0 38.0 39.0 40.0 41.0 42.0 43.0 44.0 45.0 46.0 47.0 48.0 49.0 50.0 51.0 52.0 53.0 54.0 55.0 56.0 57.0 58.0 59.0 60.0 61.0 62.0 63.0
# CHECK: 0.0 1.0 2.0 3.0 4.0 5.0 6.0 7.0 8.0 9.0 10.0 11.0 12.0 13.0 14.0 15.0 16.0 17.0 18.0 19.0 20.0 21.0 22.0 23.0 24.0 25.0 26.0 27.0 28.0 29.0 30.0 31.0
# CHECK: 0.0 1.0 2.0 3.0 4.0 5.0 6.0 7.0 8.0 9.0 10.0 11.0 12.0 13.0 14.0 15.0 16.0 17.0 18.0 19.0 20.0 21.0 22.0 23.0 24.0 25.0 26.0 27.0 28.0 29.0 30.0 31.0
# CHECK: 0.0 1.0 2.0 3.0 4.0 5.0 6.0 7.0 8.0 9.0 10.0 11.0 12.0 13.0 14.0 15.0 16.0 17.0 18.0 19.0 20.0 21.0 22.0 23.0 24.0 25.0 26.0 27.0 28.0 29.0 30.0 31.0
# CHECK: 0.0 1.0 2.0 3.0 4.0 5.0 6.0 7.0 8.0 9.0 10.0 11.0 12.0 13.0 14.0 15.0 16.0 17.0 18.0 19.0 20.0 21.0 22.0 23.0 24.0 25.0 26.0 27.0 28.0 29.0 30.0 31.0
# CHECK: 32.0 33.0 34.0 35.0 36.0 37.0 38.0 39.0 40.0 41.0 42.0 43.0 44.0 45.0 46.0 47.0 48.0 49.0 50.0 51.0 52.0 53.0 54.0 55.0 56.0 57.0 58.0 59.0 60.0 61.0 62.0 63.0
# CHECK: 32.0 33.0 34.0 35.0 36.0 37.0 38.0 39.0 40.0 41.0 42.0 43.0 44.0 45.0 46.0 47.0 48.0 49.0 50.0 51.0 52.0 53.0 54.0 55.0 56.0 57.0 58.0 59.0 60.0 61.0 62.0 63.0
# CHECK: 32.0 33.0 34.0 35.0 36.0 37.0 38.0 39.0 40.0 41.0 42.0 43.0 44.0 45.0 46.0 47.0 48.0 49.0 50.0 51.0 52.0 53.0 54.0 55.0 56.0 57.0 58.0 59.0 60.0 61.0 62.0 63.0
# CHECK: 32.0 33.0 34.0 35.0 36.0 37.0 38.0 39.0 40.0 41.0 42.0 43.0 44.0 45.0 46.0 47.0 48.0 49.0 50.0 51.0 52.0 53.0 54.0 55.0 56.0 57.0 58.0 59.0 60.0 61.0 62.0 63.0
# CHECK-LABEL: test_mma
# CHECK: 4480.0 4509.0 4538.0 4567.0 4596.0 4625.0 4654.0 4683.0 4712.0 4741.0 4770.0 4799.0 4828.0 4857.0 4886.0 4915.0 4944.0 4973.0 5002.0 5031.0 5060.0 5089.0 5118.0 5147.0 5176.0 5205.0 5234.0 5263.0 5292.0 5321.0 5350.0 5379.0
# CHECK: 11680.0 11773.0 11866.0 11959.0 12052.0 12145.0 12238.0 12331.0 12424.0 12517.0 12610.0 12703.0 12796.0 12889.0 12982.0 13075.0 13168.0 13261.0 13354.0 13447.0 13540.0 13633.0 13726.0 13819.0 13912.0 14005.0 14098.0 14191.0 14284.0 14377.0 14470.0 14563.0
# CHECK: 18880.0 19037.0 19194.0 19351.0 19508.0 19665.0 19822.0 19979.0 20136.0 20293.0 20450.0 20607.0 20764.0 20921.0 21078.0 21235.0 21392.0 21549.0 21706.0 21863.0 22020.0 22177.0 22334.0 22491.0 22648.0 22805.0 22962.0 23119.0 23276.0 23433.0 23590.0 23747.0
# CHECK: 26080.0 26301.0 26522.0 26743.0 26964.0 27185.0 27406.0 27627.0 27848.0 28069.0 28290.0 28511.0 28732.0 28953.0 29174.0 29395.0 29616.0 29837.0 30058.0 30279.0 30500.0 30721.0 30942.0 31163.0 31384.0 31605.0 31826.0 32047.0 32268.0 32489.0 32710.0 32931.0
# CHECK: 33280.0 33565.0 33850.0 34135.0 34420.0 34705.0 34990.0 35275.0 35560.0 35845.0 36130.0 36415.0 36700.0 36985.0 37270.0 37555.0 37840.0 38125.0 38410.0 38695.0 38980.0 39265.0 39550.0 39835.0 40120.0 40405.0 40690.0 40975.0 41260.0 41545.0 41830.0 42115.0
# CHECK: 40480.0 40829.0 41178.0 41527.0 41876.0 42225.0 42574.0 42923.0 43272.0 43621.0 43970.0 44319.0 44668.0 45017.0 45366.0 45715.0 46064.0 46413.0 46762.0 47111.0 47460.0 47809.0 48158.0 48507.0 48856.0 49205.0 49554.0 49903.0 50252.0 50601.0 50950.0 51299.0
# CHECK: 47680.0 48093.0 48506.0 48919.0 49332.0 49745.0 50158.0 50571.0 50984.0 51397.0 51810.0 52223.0 52636.0 53049.0 53462.0 53875.0 54288.0 54701.0 55114.0 55527.0 55940.0 56353.0 56766.0 57179.0 57592.0 58005.0 58418.0 58831.0 59244.0 59657.0 60070.0 60483.0
# CHECK: 54880.0 55357.0 55834.0 56311.0 56788.0 57265.0 57742.0 58219.0 58696.0 59173.0 59650.0 60127.0 60604.0 61081.0 61558.0 62035.0 62512.0 62989.0 63466.0 63943.0 64420.0 64897.0 65374.0 65851.0 66328.0 66805.0 67282.0 67759.0 68236.0 68713.0 69190.0 69667.0
# CHECK: 62080.0 62621.0 63162.0 63703.0 64244.0 64785.0 65326.0 65867.0 66408.0 66949.0 67490.0 68031.0 68572.0 69113.0 69654.0 70195.0 70736.0 71277.0 71818.0 72359.0 72900.0 73441.0 73982.0 74523.0 75064.0 75605.0 76146.0 76687.0 77228.0 77769.0 78310.0 78851.0
# CHECK: 69280.0 69885.0 70490.0 71095.0 71700.0 72305.0 72910.0 73515.0 74120.0 74725.0 75330.0 75935.0 76540.0 77145.0 77750.0 78355.0 78960.0 79565.0 80170.0 80775.0 81380.0 81985.0 82590.0 83195.0 83800.0 84405.0 85010.0 85615.0 86220.0 86825.0 87430.0 88035.0
# CHECK: 76480.0 77149.0 77818.0 78487.0 79156.0 79825.0 80494.0 81163.0 81832.0 82501.0 83170.0 83839.0 84508.0 85177.0 85846.0 86515.0 87184.0 87853.0 88522.0 89191.0 89860.0 90529.0 91198.0 91867.0 92536.0 93205.0 93874.0 94543.0 95212.0 95881.0 96550.0 97219.0
# CHECK: 83680.0 84413.0 85146.0 85879.0 86612.0 87345.0 88078.0 88811.0 89544.0 90277.0 91010.0 91743.0 92476.0 93209.0 93942.0 94675.0 95408.0 96141.0 96874.0 97607.0 98340.0 99073.0 99806.0 100539.0 101272.0 102005.0 102738.0 103471.0 104204.0 104937.0 105670.0 106403.0
# CHECK: 90880.0 91677.0 92474.0 93271.0 94068.0 94865.0 95662.0 96459.0 97256.0 98053.0 98850.0 99647.0 100444.0 101241.0 102038.0 102835.0 103632.0 104429.0 105226.0 106023.0 106820.0 107617.0 108414.0 109211.0 110008.0 110805.0 111602.0 112399.0 113196.0 113993.0 114790.0 115587.0
# CHECK: 98080.0 98941.0 99802.0 100663.0 101524.0 102385.0 103246.0 104107.0 104968.0 105829.0 106690.0 107551.0 108412.0 109273.0 110134.0 110995.0 111856.0 112717.0 113578.0 114439.0 115300.0 116161.0 117022.0 117883.0 118744.0 119605.0 120466.0 121327.0 122188.0 123049.0 123910.0 124771.0
# CHECK: 105280.0 106205.0 107130.0 108055.0 108980.0 109905.0 110830.0 111755.0 112680.0 113605.0 114530.0 115455.0 116380.0 117305.0 118230.0 119155.0 120080.0 121005.0 121930.0 122855.0 123780.0 124705.0 125630.0 126555.0 127480.0 128405.0 129330.0 130255.0 131180.0 132105.0 133030.0 133955.0
# CHECK: 112480.0 113469.0 114458.0 115447.0 116436.0 117425.0 118414.0 119403.0 120392.0 121381.0 122370.0 123359.0 124348.0 125337.0 126326.0 127315.0 128304.0 129293.0 130282.0 131271.0 132260.0 133249.0 134238.0 135227.0 136216.0 137205.0 138194.0 139183.0 140172.0 141161.0 142150.0 143139.0
# CHECK: 119680.0 120733.0 121786.0 122839.0 123892.0 124945.0 125998.0 127051.0 128104.0 129157.0 130210.0 131263.0 132316.0 133369.0 134422.0 135475.0 136528.0 137581.0 138634.0 139687.0 140740.0 141793.0 142846.0 143899.0 144952.0 146005.0 147058.0 148111.0 149164.0 150217.0 151270.0 152323.0
# CHECK: 126880.0 127997.0 129114.0 130231.0 131348.0 132465.0 133582.0 134699.0 135816.0 136933.0 138050.0 139167.0 140284.0 141401.0 142518.0 143635.0 144752.0 145869.0 146986.0 148103.0 149220.0 150337.0 151454.0 152571.0 153688.0 154805.0 155922.0 157039.0 158156.0 159273.0 160390.0 161507.0
# CHECK: 134080.0 135261.0 136442.0 137623.0 138804.0 139985.0 141166.0 142347.0 143528.0 144709.0 145890.0 147071.0 148252.0 149433.0 150614.0 151795.0 152976.0 154157.0 155338.0 156519.0 157700.0 158881.0 160062.0 161243.0 162424.0 163605.0 164786.0 165967.0 167148.0 168329.0 169510.0 170691.0
# CHECK: 141280.0 142525.0 143770.0 145015.0 146260.0 147505.0 148750.0 149995.0 151240.0 152485.0 153730.0 154975.0 156220.0 157465.0 158710.0 159955.0 161200.0 162445.0 163690.0 164935.0 166180.0 167425.0 168670.0 169915.0 171160.0 172405.0 173650.0 174895.0 176140.0 177385.0 178630.0 179875.0
# CHECK: 148480.0 149789.0 151098.0 152407.0 153716.0 155025.0 156334.0 157643.0 158952.0 160261.0 161570.0 162879.0 164188.0 165497.0 166806.0 168115.0 169424.0 170733.0 172042.0 173351.0 174660.0 175969.0 177278.0 178587.0 179896.0 181205.0 182514.0 183823.0 185132.0 186441.0 187750.0 189059.0
# CHECK: 155680.0 157053.0 158426.0 159799.0 161172.0 162545.0 163918.0 165291.0 166664.0 168037.0 169410.0 170783.0 172156.0 173529.0 174902.0 176275.0 177648.0 179021.0 180394.0 181767.0 183140.0 184513.0 185886.0 187259.0 188632.0 190005.0 191378.0 192751.0 194124.0 195497.0 196870.0 198243.0
# CHECK: 162880.0 164317.0 165754.0 167191.0 168628.0 170065.0 171502.0 172939.0 174376.0 175813.0 177250.0 178687.0 180124.0 181561.0 182998.0 184435.0 185872.0 187309.0 188746.0 190183.0 191620.0 193057.0 194494.0 195931.0 197368.0 198805.0 200242.0 201679.0 203116.0 204553.0 205990.0 207427.0
# CHECK: 170080.0 171581.0 173082.0 174583.0 176084.0 177585.0 179086.0 180587.0 182088.0 183589.0 185090.0 186591.0 188092.0 189593.0 191094.0 192595.0 194096.0 195597.0 197098.0 198599.0 200100.0 201601.0 203102.0 204603.0 206104.0 207605.0 209106.0 210607.0 212108.0 213609.0 215110.0 216611.0
# CHECK: 177280.0 178845.0 180410.0 181975.0 183540.0 185105.0 186670.0 188235.0 189800.0 191365.0 192930.0 194495.0 196060.0 197625.0 199190.0 200755.0 202320.0 203885.0 205450.0 207015.0 208580.0 210145.0 211710.0 213275.0 214840.0 216405.0 217970.0 219535.0 221100.0 222665.0 224230.0 225795.0
# CHECK: 184480.0 186109.0 187738.0 189367.0 190996.0 192625.0 194254.0 195883.0 197512.0 199141.0 200770.0 202399.0 204028.0 205657.0 207286.0 208915.0 210544.0 212173.0 213802.0 215431.0 217060.0 218689.0 220318.0 221947.0 223576.0 225205.0 226834.0 228463.0 230092.0 231721.0 233350.0 234979.0
# CHECK: 191680.0 193373.0 195066.0 196759.0 198452.0 200145.0 201838.0 203531.0 205224.0 206917.0 208610.0 210303.0 211996.0 213689.0 215382.0 217075.0 218768.0 220461.0 222154.0 223847.0 225540.0 227233.0 228926.0 230619.0 232312.0 234005.0 235698.0 237391.0 239084.0 240777.0 242470.0 244163.0
# CHECK: 198880.0 200637.0 202394.0 204151.0 205908.0 207665.0 209422.0 211179.0 212936.0 214693.0 216450.0 218207.0 219964.0 221721.0 223478.0 225235.0 226992.0 228749.0 230506.0 232263.0 234020.0 235777.0 237534.0 239291.0 241048.0 242805.0 244562.0 246319.0 248076.0 249833.0 251590.0 253347.0
# CHECK: 206080.0 207901.0 209722.0 211543.0 213364.0 215185.0 217006.0 218827.0 220648.0 222469.0 224290.0 226111.0 227932.0 229753.0 231574.0 233395.0 235216.0 237037.0 238858.0 240679.0 242500.0 244321.0 246142.0 247963.0 249784.0 251605.0 253426.0 255247.0 257068.0 258889.0 260710.0 262531.0
# CHECK: 213280.0 215165.0 217050.0 218935.0 220820.0 222705.0 224590.0 226475.0 228360.0 230245.0 232130.0 234015.0 235900.0 237785.0 239670.0 241555.0 243440.0 245325.0 247210.0 249095.0 250980.0 252865.0 254750.0 256635.0 258520.0 260405.0 262290.0 264175.0 266060.0 267945.0 269830.0 271715.0
# CHECK: 220480.0 222429.0 224378.0 226327.0 228276.0 230225.0 232174.0 234123.0 236072.0 238021.0 239970.0 241919.0 243868.0 245817.0 247766.0 249715.0 251664.0 253613.0 255562.0 257511.0 259460.0 261409.0 263358.0 265307.0 267256.0 269205.0 271154.0 273103.0 275052.0 277001.0 278950.0 280899.0
# CHECK: 227680.0 229693.0 231706.0 233719.0 235732.0 237745.0 239758.0 241771.0 243784.0 245797.0 247810.0 249823.0 251836.0 253849.0 255862.0 257875.0 259888.0 261901.0 263914.0 265927.0 267940.0 269953.0 271966.0 273979.0 275992.0 278005.0 280018.0 282031.0 284044.0 286057.0 288070.0 290083.0


def test_load_and_mma_f32_bf16_32x32x8(ctx: DeviceContext):
    print("== test_load_and_mma_f32_bf16_32x32x8")
    test_load_and_mma_and_multiply_operands[
        DType.float32, DType.bfloat16, Index(32, 32, 8), False
    ](ctx)


# CHECK-LABEL: == test_load_and_mma_f32_bf16_32x32x8_transpose
# CHECK-LABEL: == test_load_a
# CHECK:0.0 8.0 16.0 24.0 32.0 40.0 48.0 56.0 64.0 72.0 80.0 88.0 96.0 104.0 112.0 120.0 128.0 136.0 144.0 152.0 160.0 168.0 176.0 184.0 192.0 200.0 208.0 216.0 224.0 232.0 240.0 248.0 4.0 12.0 20.0 28.0 36.0 44.0 52.0 60.0 68.0 76.0 84.0 92.0 100.0 108.0 116.0 124.0 132.0 140.0 148.0 156.0 164.0 172.0 180.0 188.0 196.0 204.0 212.0 220.0 228.0 236.0 244.0 252.0
# CHECK-LABEL: == test_load_b
# CHECK:0.0 8.0 16.0 24.0 32.0 40.0 48.0 56.0 64.0 72.0 80.0 88.0 96.0 104.0 112.0 120.0 128.0 136.0 144.0 152.0 160.0 168.0 176.0 184.0 192.0 200.0 208.0 216.0 224.0 232.0 240.0 248.0 4.0 12.0 20.0 28.0 36.0 44.0 52.0 60.0 68.0 76.0 84.0 92.0 100.0 108.0 116.0 124.0 132.0 140.0 148.0 156.0 164.0 172.0 180.0 188.0 196.0 204.0 212.0 220.0 228.0 236.0 244.0 252.0
# CHECK-LABEL: == test_load_c
# CHECK: 0.0 32.0 64.0 96.0
# CHECK: 1.0 33.0 65.0 97.0
# CHECK: 2.0 34.0 66.0 98.0
# CHECK: 3.0 35.0 67.0 99.0
# CHECK: 4.0 36.0 68.0 100.0
# CHECK: 5.0 37.0 69.0 101.0
# CHECK: 6.0 38.0 70.0 102.0
# CHECK: 7.0 39.0 71.0 103.0
# CHECK: 8.0 40.0 72.0 104.0
# CHECK: 9.0 41.0 73.0 105.0
# CHECK: 10.0 42.0 74.0 106.0
# CHECK: 11.0 43.0 75.0 107.0
# CHECK: 12.0 44.0 76.0 108.0
# CHECK: 13.0 45.0 77.0 109.0
# CHECK: 14.0 46.0 78.0 110.0
# CHECK: 15.0 47.0 79.0 111.0
# CHECK: 16.0 48.0 80.0 112.0
# CHECK: 17.0 49.0 81.0 113.0
# CHECK: 18.0 50.0 82.0 114.0
# CHECK: 19.0 51.0 83.0 115.0
# CHECK: 20.0 52.0 84.0 116.0
# CHECK: 21.0 53.0 85.0 117.0
# CHECK: 22.0 54.0 86.0 118.0
# CHECK: 23.0 55.0 87.0 119.0
# CHECK: 24.0 56.0 88.0 120.0
# CHECK: 25.0 57.0 89.0 121.0
# CHECK: 26.0 58.0 90.0 122.0
# CHECK: 27.0 59.0 91.0 123.0
# CHECK: 28.0 60.0 92.0 124.0
# CHECK: 29.0 61.0 93.0 125.0
# CHECK: 30.0 62.0 94.0 126.0
# CHECK: 31.0 63.0 95.0 127.0
# CHECK: 128.0 160.0 192.0 224.0
# CHECK: 129.0 161.0 193.0 225.0
# CHECK: 130.0 162.0 194.0 226.0
# CHECK: 131.0 163.0 195.0 227.0
# CHECK: 132.0 164.0 196.0 228.0
# CHECK: 133.0 165.0 197.0 229.0
# CHECK: 134.0 166.0 198.0 230.0
# CHECK: 135.0 167.0 199.0 231.0
# CHECK: 136.0 168.0 200.0 232.0
# CHECK: 137.0 169.0 201.0 233.0
# CHECK: 138.0 170.0 202.0 234.0
# CHECK: 139.0 171.0 203.0 235.0
# CHECK: 140.0 172.0 204.0 236.0
# CHECK: 141.0 173.0 205.0 237.0
# CHECK: 142.0 174.0 206.0 238.0
# CHECK: 143.0 175.0 207.0 239.0
# CHECK: 144.0 176.0 208.0 240.0
# CHECK: 145.0 177.0 209.0 241.0
# CHECK: 146.0 178.0 210.0 242.0
# CHECK: 147.0 179.0 211.0 243.0
# CHECK: 148.0 180.0 212.0 244.0
# CHECK: 149.0 181.0 213.0 245.0
# CHECK: 150.0 182.0 214.0 246.0
# CHECK: 151.0 183.0 215.0 247.0
# CHECK: 152.0 184.0 216.0 248.0
# CHECK: 153.0 185.0 217.0 249.0
# CHECK: 154.0 186.0 218.0 250.0
# CHECK: 155.0 187.0 219.0 251.0
# CHECK: 156.0 188.0 220.0 252.0
# CHECK: 157.0 189.0 221.0 253.0
# CHECK: 158.0 190.0 222.0 254.0
# CHECK: 159.0 191.0 223.0 255.0
# CHECK-LABEL: == test_load_d
# CHECK: 0.0 1.0 2.0 3.0 4.0 5.0 6.0 7.0 8.0 9.0 10.0 11.0 12.0 13.0 14.0 15.0 16.0 17.0 18.0 19.0 20.0 21.0 22.0 23.0 24.0 25.0 26.0 27.0 28.0 29.0 30.0 31.0
# CHECK: 0.0 1.0 2.0 3.0 4.0 5.0 6.0 7.0 8.0 9.0 10.0 11.0 12.0 13.0 14.0 15.0 16.0 17.0 18.0 19.0 20.0 21.0 22.0 23.0 24.0 25.0 26.0 27.0 28.0 29.0 30.0 31.0
# CHECK: 0.0 1.0 2.0 3.0 4.0 5.0 6.0 7.0 8.0 9.0 10.0 11.0 12.0 13.0 14.0 15.0 16.0 17.0 18.0 19.0 20.0 21.0 22.0 23.0 24.0 25.0 26.0 27.0 28.0 29.0 30.0 31.0
# CHECK: 0.0 1.0 2.0 3.0 4.0 5.0 6.0 7.0 8.0 9.0 10.0 11.0 12.0 13.0 14.0 15.0 16.0 17.0 18.0 19.0 20.0 21.0 22.0 23.0 24.0 25.0 26.0 27.0 28.0 29.0 30.0 31.0
# CHECK: 32.0 33.0 34.0 35.0 36.0 37.0 38.0 39.0 40.0 41.0 42.0 43.0 44.0 45.0 46.0 47.0 48.0 49.0 50.0 51.0 52.0 53.0 54.0 55.0 56.0 57.0 58.0 59.0 60.0 61.0 62.0 63.0
# CHECK: 32.0 33.0 34.0 35.0 36.0 37.0 38.0 39.0 40.0 41.0 42.0 43.0 44.0 45.0 46.0 47.0 48.0 49.0 50.0 51.0 52.0 53.0 54.0 55.0 56.0 57.0 58.0 59.0 60.0 61.0 62.0 63.0
# CHECK: 32.0 33.0 34.0 35.0 36.0 37.0 38.0 39.0 40.0 41.0 42.0 43.0 44.0 45.0 46.0 47.0 48.0 49.0 50.0 51.0 52.0 53.0 54.0 55.0 56.0 57.0 58.0 59.0 60.0 61.0 62.0 63.0
# CHECK: 32.0 33.0 34.0 35.0 36.0 37.0 38.0 39.0 40.0 41.0 42.0 43.0 44.0 45.0 46.0 47.0 48.0 49.0 50.0 51.0 52.0 53.0 54.0 55.0 56.0 57.0 58.0 59.0 60.0 61.0 62.0 63.0
# CHECK: 0.0 1.0 2.0 3.0 4.0 5.0 6.0 7.0 8.0 9.0 10.0 11.0 12.0 13.0 14.0 15.0 16.0 17.0 18.0 19.0 20.0 21.0 22.0 23.0 24.0 25.0 26.0 27.0 28.0 29.0 30.0 31.0
# CHECK: 0.0 1.0 2.0 3.0 4.0 5.0 6.0 7.0 8.0 9.0 10.0 11.0 12.0 13.0 14.0 15.0 16.0 17.0 18.0 19.0 20.0 21.0 22.0 23.0 24.0 25.0 26.0 27.0 28.0 29.0 30.0 31.0
# CHECK: 0.0 1.0 2.0 3.0 4.0 5.0 6.0 7.0 8.0 9.0 10.0 11.0 12.0 13.0 14.0 15.0 16.0 17.0 18.0 19.0 20.0 21.0 22.0 23.0 24.0 25.0 26.0 27.0 28.0 29.0 30.0 31.0
# CHECK: 0.0 1.0 2.0 3.0 4.0 5.0 6.0 7.0 8.0 9.0 10.0 11.0 12.0 13.0 14.0 15.0 16.0 17.0 18.0 19.0 20.0 21.0 22.0 23.0 24.0 25.0 26.0 27.0 28.0 29.0 30.0 31.0
# CHECK: 32.0 33.0 34.0 35.0 36.0 37.0 38.0 39.0 40.0 41.0 42.0 43.0 44.0 45.0 46.0 47.0 48.0 49.0 50.0 51.0 52.0 53.0 54.0 55.0 56.0 57.0 58.0 59.0 60.0 61.0 62.0 63.0
# CHECK: 32.0 33.0 34.0 35.0 36.0 37.0 38.0 39.0 40.0 41.0 42.0 43.0 44.0 45.0 46.0 47.0 48.0 49.0 50.0 51.0 52.0 53.0 54.0 55.0 56.0 57.0 58.0 59.0 60.0 61.0 62.0 63.0
# CHECK: 32.0 33.0 34.0 35.0 36.0 37.0 38.0 39.0 40.0 41.0 42.0 43.0 44.0 45.0 46.0 47.0 48.0 49.0 50.0 51.0 52.0 53.0 54.0 55.0 56.0 57.0 58.0 59.0 60.0 61.0 62.0 63.0
# CHECK: 32.0 33.0 34.0 35.0 36.0 37.0 38.0 39.0 40.0 41.0 42.0 43.0 44.0 45.0 46.0 47.0 48.0 49.0 50.0 51.0 52.0 53.0 54.0 55.0 56.0 57.0 58.0 59.0 60.0 61.0 62.0 63.0
# CHECK: 0.0 1.0 2.0 3.0 4.0 5.0 6.0 7.0 8.0 9.0 10.0 11.0 12.0 13.0 14.0 15.0 16.0 17.0 18.0 19.0 20.0 21.0 22.0 23.0 24.0 25.0 26.0 27.0 28.0 29.0 30.0 31.0
# CHECK: 0.0 1.0 2.0 3.0 4.0 5.0 6.0 7.0 8.0 9.0 10.0 11.0 12.0 13.0 14.0 15.0 16.0 17.0 18.0 19.0 20.0 21.0 22.0 23.0 24.0 25.0 26.0 27.0 28.0 29.0 30.0 31.0
# CHECK: 0.0 1.0 2.0 3.0 4.0 5.0 6.0 7.0 8.0 9.0 10.0 11.0 12.0 13.0 14.0 15.0 16.0 17.0 18.0 19.0 20.0 21.0 22.0 23.0 24.0 25.0 26.0 27.0 28.0 29.0 30.0 31.0
# CHECK: 0.0 1.0 2.0 3.0 4.0 5.0 6.0 7.0 8.0 9.0 10.0 11.0 12.0 13.0 14.0 15.0 16.0 17.0 18.0 19.0 20.0 21.0 22.0 23.0 24.0 25.0 26.0 27.0 28.0 29.0 30.0 31.0
# CHECK: 32.0 33.0 34.0 35.0 36.0 37.0 38.0 39.0 40.0 41.0 42.0 43.0 44.0 45.0 46.0 47.0 48.0 49.0 50.0 51.0 52.0 53.0 54.0 55.0 56.0 57.0 58.0 59.0 60.0 61.0 62.0 63.0
# CHECK: 32.0 33.0 34.0 35.0 36.0 37.0 38.0 39.0 40.0 41.0 42.0 43.0 44.0 45.0 46.0 47.0 48.0 49.0 50.0 51.0 52.0 53.0 54.0 55.0 56.0 57.0 58.0 59.0 60.0 61.0 62.0 63.0
# CHECK: 32.0 33.0 34.0 35.0 36.0 37.0 38.0 39.0 40.0 41.0 42.0 43.0 44.0 45.0 46.0 47.0 48.0 49.0 50.0 51.0 52.0 53.0 54.0 55.0 56.0 57.0 58.0 59.0 60.0 61.0 62.0 63.0
# CHECK: 32.0 33.0 34.0 35.0 36.0 37.0 38.0 39.0 40.0 41.0 42.0 43.0 44.0 45.0 46.0 47.0 48.0 49.0 50.0 51.0 52.0 53.0 54.0 55.0 56.0 57.0 58.0 59.0 60.0 61.0 62.0 63.0
# CHECK: 0.0 1.0 2.0 3.0 4.0 5.0 6.0 7.0 8.0 9.0 10.0 11.0 12.0 13.0 14.0 15.0 16.0 17.0 18.0 19.0 20.0 21.0 22.0 23.0 24.0 25.0 26.0 27.0 28.0 29.0 30.0 31.0
# CHECK: 0.0 1.0 2.0 3.0 4.0 5.0 6.0 7.0 8.0 9.0 10.0 11.0 12.0 13.0 14.0 15.0 16.0 17.0 18.0 19.0 20.0 21.0 22.0 23.0 24.0 25.0 26.0 27.0 28.0 29.0 30.0 31.0
# CHECK: 0.0 1.0 2.0 3.0 4.0 5.0 6.0 7.0 8.0 9.0 10.0 11.0 12.0 13.0 14.0 15.0 16.0 17.0 18.0 19.0 20.0 21.0 22.0 23.0 24.0 25.0 26.0 27.0 28.0 29.0 30.0 31.0
# CHECK: 0.0 1.0 2.0 3.0 4.0 5.0 6.0 7.0 8.0 9.0 10.0 11.0 12.0 13.0 14.0 15.0 16.0 17.0 18.0 19.0 20.0 21.0 22.0 23.0 24.0 25.0 26.0 27.0 28.0 29.0 30.0 31.0
# CHECK: 32.0 33.0 34.0 35.0 36.0 37.0 38.0 39.0 40.0 41.0 42.0 43.0 44.0 45.0 46.0 47.0 48.0 49.0 50.0 51.0 52.0 53.0 54.0 55.0 56.0 57.0 58.0 59.0 60.0 61.0 62.0 63.0
# CHECK: 32.0 33.0 34.0 35.0 36.0 37.0 38.0 39.0 40.0 41.0 42.0 43.0 44.0 45.0 46.0 47.0 48.0 49.0 50.0 51.0 52.0 53.0 54.0 55.0 56.0 57.0 58.0 59.0 60.0 61.0 62.0 63.0
# CHECK: 32.0 33.0 34.0 35.0 36.0 37.0 38.0 39.0 40.0 41.0 42.0 43.0 44.0 45.0 46.0 47.0 48.0 49.0 50.0 51.0 52.0 53.0 54.0 55.0 56.0 57.0 58.0 59.0 60.0 61.0 62.0 63.0
# CHECK: 32.0 33.0 34.0 35.0 36.0 37.0 38.0 39.0 40.0 41.0 42.0 43.0 44.0 45.0 46.0 47.0 48.0 49.0 50.0 51.0 52.0 53.0 54.0 55.0 56.0 57.0 58.0 59.0 60.0 61.0 62.0 63.0
# CHECK-LABEL: == test_mma
# CHECK: 140.0 365.0 590.0 815.0 1040.0 1265.0 1490.0 1715.0 1940.0 2165.0 2390.0 2615.0 2840.0 3065.0 3290.0 3515.0 3740.0 3965.0 4190.0 4415.0 4640.0 4865.0 5090.0 5315.0 5540.0 5765.0 5990.0 6215.0 6440.0 6665.0 6890.0 7115.0
# CHECK: 396.0 1133.0 1870.0 2607.0 3344.0 4081.0 4818.0 5555.0 6292.0 7029.0 7766.0 8503.0 9240.0 9977.0 10714.0 11451.0 12188.0 12925.0 13662.0 14399.0 15136.0 15873.0 16610.0 17347.0 18084.0 18821.0 19558.0 20295.0 21032.0 21769.0 22506.0 23243.0
# CHECK: 652.0 1901.0 3150.0 4399.0 5648.0 6897.0 8146.0 9395.0 10644.0 11893.0 13142.0 14391.0 15640.0 16889.0 18138.0 19387.0 20636.0 21885.0 23134.0 24383.0 25632.0 26881.0 28130.0 29379.0 30628.0 31877.0 33126.0 34375.0 35624.0 36873.0 38122.0 39371.0
# CHECK: 908.0 2669.0 4430.0 6191.0 7952.0 9713.0 11474.0 13235.0 14996.0 16757.0 18518.0 20279.0 22040.0 23801.0 25562.0 27323.0 29084.0 30845.0 32606.0 34367.0 36128.0 37889.0 39650.0 41411.0 43172.0 44933.0 46694.0 48455.0 50216.0 51977.0 53738.0 55499.0
# CHECK: 1164.0 3437.0 5710.0 7983.0 10256.0 12529.0 14802.0 17075.0 19348.0 21621.0 23894.0 26167.0 28440.0 30713.0 32986.0 35259.0 37532.0 39805.0 42078.0 44351.0 46624.0 48897.0 51170.0 53443.0 55716.0 57989.0 60262.0 62535.0 64808.0 67081.0 69354.0 71627.0
# CHECK: 1420.0 4205.0 6990.0 9775.0 12560.0 15345.0 18130.0 20915.0 23700.0 26485.0 29270.0 32055.0 34840.0 37625.0 40410.0 43195.0 45980.0 48765.0 51550.0 54335.0 57120.0 59905.0 62690.0 65475.0 68260.0 71045.0 73830.0 76615.0 79400.0 82185.0 84970.0 87755.0
# CHECK: 1676.0 4973.0 8270.0 11567.0 14864.0 18161.0 21458.0 24755.0 28052.0 31349.0 34646.0 37943.0 41240.0 44537.0 47834.0 51131.0 54428.0 57725.0 61022.0 64319.0 67616.0 70913.0 74210.0 77507.0 80804.0 84101.0 87398.0 90695.0 93992.0 97289.0 100586.0 103883.0
# CHECK: 1932.0 5741.0 9550.0 13359.0 17168.0 20977.0 24786.0 28595.0 32404.0 36213.0 40022.0 43831.0 47640.0 51449.0 55258.0 59067.0 62876.0 66685.0 70494.0 74303.0 78112.0 81921.0 85730.0 89539.0 93348.0 97157.0 100966.0 104775.0 108584.0 112393.0 116202.0 120011.0
# CHECK: 2188.0 6509.0 10830.0 15151.0 19472.0 23793.0 28114.0 32435.0 36756.0 41077.0 45398.0 49719.0 54040.0 58361.0 62682.0 67003.0 71324.0 75645.0 79966.0 84287.0 88608.0 92929.0 97250.0 101571.0 105892.0 110213.0 114534.0 118855.0 123176.0 127497.0 131818.0 136139.0
# CHECK: 2444.0 7277.0 12110.0 16943.0 21776.0 26609.0 31442.0 36275.0 41108.0 45941.0 50774.0 55607.0 60440.0 65273.0 70106.0 74939.0 79772.0 84605.0 89438.0 94271.0 99104.0 103937.0 108770.0 113603.0 118436.0 123269.0 128102.0 132935.0 137768.0 142601.0 147434.0 152267.0
# CHECK: 2700.0 8045.0 13390.0 18735.0 24080.0 29425.0 34770.0 40115.0 45460.0 50805.0 56150.0 61495.0 66840.0 72185.0 77530.0 82875.0 88220.0 93565.0 98910.0 104255.0 109600.0 114945.0 120290.0 125635.0 130980.0 136325.0 141670.0 147015.0 152360.0 157705.0 163050.0 168395.0
# CHECK: 2956.0 8813.0 14670.0 20527.0 26384.0 32241.0 38098.0 43955.0 49812.0 55669.0 61526.0 67383.0 73240.0 79097.0 84954.0 90811.0 96668.0 102525.0 108382.0 114239.0 120096.0 125953.0 131810.0 137667.0 143524.0 149381.0 155238.0 161095.0 166952.0 172809.0 178666.0 184523.0
# CHECK: 3212.0 9581.0 15950.0 22319.0 28688.0 35057.0 41426.0 47795.0 54164.0 60533.0 66902.0 73271.0 79640.0 86009.0 92378.0 98747.0 105116.0 111485.0 117854.0 124223.0 130592.0 136961.0 143330.0 149699.0 156068.0 162437.0 168806.0 175175.0 181544.0 187913.0 194282.0 200651.0
# CHECK: 3468.0 10349.0 17230.0 24111.0 30992.0 37873.0 44754.0 51635.0 58516.0 65397.0 72278.0 79159.0 86040.0 92921.0 99802.0 106683.0 113564.0 120445.0 127326.0 134207.0 141088.0 147969.0 154850.0 161731.0 168612.0 175493.0 182374.0 189255.0 196136.0 203017.0 209898.0 216779.0
# CHECK: 3724.0 11117.0 18510.0 25903.0 33296.0 40689.0 48082.0 55475.0 62868.0 70261.0 77654.0 85047.0 92440.0 99833.0 107226.0 114619.0 122012.0 129405.0 136798.0 144191.0 151584.0 158977.0 166370.0 173763.0 181156.0 188549.0 195942.0 203335.0 210728.0 218121.0 225514.0 232907.0
# CHECK: 3980.0 11885.0 19790.0 27695.0 35600.0 43505.0 51410.0 59315.0 67220.0 75125.0 83030.0 90935.0 98840.0 106745.0 114650.0 122555.0 130460.0 138365.0 146270.0 154175.0 162080.0 169985.0 177890.0 185795.0 193700.0 201605.0 209510.0 217415.0 225320.0 233225.0 241130.0 249035.0
# CHECK: 4236.0 12653.0 21070.0 29487.0 37904.0 46321.0 54738.0 63155.0 71572.0 79989.0 88406.0 96823.0 105240.0 113657.0 122074.0 130491.0 138908.0 147325.0 155742.0 164159.0 172576.0 180993.0 189410.0 197827.0 206244.0 214661.0 223078.0 231495.0 239912.0 248329.0 256746.0 265163.0
# CHECK: 4492.0 13421.0 22350.0 31279.0 40208.0 49137.0 58066.0 66995.0 75924.0 84853.0 93782.0 102711.0 111640.0 120569.0 129498.0 138427.0 147356.0 156285.0 165214.0 174143.0 183072.0 192001.0 200930.0 209859.0 218788.0 227717.0 236646.0 245575.0 254504.0 263433.0 272362.0 281291.0
# CHECK: 4748.0 14189.0 23630.0 33071.0 42512.0 51953.0 61394.0 70835.0 80276.0 89717.0 99158.0 108599.0 118040.0 127481.0 136922.0 146363.0 155804.0 165245.0 174686.0 184127.0 193568.0 203009.0 212450.0 221891.0 231332.0 240773.0 250214.0 259655.0 269096.0 278537.0 287978.0 297419.0
# CHECK: 5004.0 14957.0 24910.0 34863.0 44816.0 54769.0 64722.0 74675.0 84628.0 94581.0 104534.0 114487.0 124440.0 134393.0 144346.0 154299.0 164252.0 174205.0 184158.0 194111.0 204064.0 214017.0 223970.0 233923.0 243876.0 253829.0 263782.0 273735.0 283688.0 293641.0 303594.0 313547.0
# CHECK: 5260.0 15725.0 26190.0 36655.0 47120.0 57585.0 68050.0 78515.0 88980.0 99445.0 109910.0 120375.0 130840.0 141305.0 151770.0 162235.0 172700.0 183165.0 193630.0 204095.0 214560.0 225025.0 235490.0 245955.0 256420.0 266885.0 277350.0 287815.0 298280.0 308745.0 319210.0 329675.0
# CHECK: 5516.0 16493.0 27470.0 38447.0 49424.0 60401.0 71378.0 82355.0 93332.0 104309.0 115286.0 126263.0 137240.0 148217.0 159194.0 170171.0 181148.0 192125.0 203102.0 214079.0 225056.0 236033.0 247010.0 257987.0 268964.0 279941.0 290918.0 301895.0 312872.0 323849.0 334826.0 345803.0
# CHECK: 5772.0 17261.0 28750.0 40239.0 51728.0 63217.0 74706.0 86195.0 97684.0 109173.0 120662.0 132151.0 143640.0 155129.0 166618.0 178107.0 189596.0 201085.0 212574.0 224063.0 235552.0 247041.0 258530.0 270019.0 281508.0 292997.0 304486.0 315975.0 327464.0 338953.0 350442.0 361931.0
# CHECK: 6028.0 18029.0 30030.0 42031.0 54032.0 66033.0 78034.0 90035.0 102036.0 114037.0 126038.0 138039.0 150040.0 162041.0 174042.0 186043.0 198044.0 210045.0 222046.0 234047.0 246048.0 258049.0 270050.0 282051.0 294052.0 306053.0 318054.0 330055.0 342056.0 354057.0 366058.0 378059.0
# CHECK: 6284.0 18797.0 31310.0 43823.0 56336.0 68849.0 81362.0 93875.0 106388.0 118901.0 131414.0 143927.0 156440.0 168953.0 181466.0 193979.0 206492.0 219005.0 231518.0 244031.0 256544.0 269057.0 281570.0 294083.0 306596.0 319109.0 331622.0 344135.0 356648.0 369161.0 381674.0 394187.0
# CHECK: 6540.0 19565.0 32590.0 45615.0 58640.0 71665.0 84690.0 97715.0 110740.0 123765.0 136790.0 149815.0 162840.0 175865.0 188890.0 201915.0 214940.0 227965.0 240990.0 254015.0 267040.0 280065.0 293090.0 306115.0 319140.0 332165.0 345190.0 358215.0 371240.0 384265.0 397290.0 410315.0
# CHECK: 6796.0 20333.0 33870.0 47407.0 60944.0 74481.0 88018.0 101555.0 115092.0 128629.0 142166.0 155703.0 169240.0 182777.0 196314.0 209851.0 223388.0 236925.0 250462.0 263999.0 277536.0 291073.0 304610.0 318147.0 331684.0 345221.0 358758.0 372295.0 385832.0 399369.0 412906.0 426443.0
# CHECK: 7052.0 21101.0 35150.0 49199.0 63248.0 77297.0 91346.0 105395.0 119444.0 133493.0 147542.0 161591.0 175640.0 189689.0 203738.0 217787.0 231836.0 245885.0 259934.0 273983.0 288032.0 302081.0 316130.0 330179.0 344228.0 358277.0 372326.0 386375.0 400424.0 414473.0 428522.0 442571.0
# CHECK: 7308.0 21869.0 36430.0 50991.0 65552.0 80113.0 94674.0 109235.0 123796.0 138357.0 152918.0 167479.0 182040.0 196601.0 211162.0 225723.0 240284.0 254845.0 269406.0 283967.0 298528.0 313089.0 327650.0 342211.0 356772.0 371333.0 385894.0 400455.0 415016.0 429577.0 444138.0 458699.0
# CHECK: 7564.0 22637.0 37710.0 52783.0 67856.0 82929.0 98002.0 113075.0 128148.0 143221.0 158294.0 173367.0 188440.0 203513.0 218586.0 233659.0 248732.0 263805.0 278878.0 293951.0 309024.0 324097.0 339170.0 354243.0 369316.0 384389.0 399462.0 414535.0 429608.0 444681.0 459754.0 474827.0
# CHECK: 7820.0 23405.0 38990.0 54575.0 70160.0 85745.0 101330.0 116915.0 132500.0 148085.0 163670.0 179255.0 194840.0 210425.0 226010.0 241595.0 257180.0 272765.0 288350.0 303935.0 319520.0 335105.0 350690.0 366275.0 381860.0 397445.0 413030.0 428615.0 444200.0 459785.0 475370.0 490955.0
# CHECK: 8076.0 24173.0 40270.0 56367.0 72464.0 88561.0 104658.0 120755.0 136852.0 152949.0 169046.0 185143.0 201240.0 217337.0 233434.0 249531.0 265628.0 281725.0 297822.0 313919.0 330016.0 346113.0 362210.0 378307.0 394404.0 410501.0 426598.0 442695.0 458792.0 474889.0 490986.0 507083.0


def test_load_and_mma_f32_bf16_32x32x8_transpose(ctx: DeviceContext):
    print("== test_load_and_mma_f32_bf16_32x32x8_transpose")
    test_load_and_mma_and_multiply_operands[
        DType.float32, DType.bfloat16, Index(32, 32, 8), True
    ](ctx)


# CHECK-LABEL: test_load_and_mma_f32_f16_32x32x8
# CHECK-LABEL: test_load_a
# CHECK: 0.0 8.0 16.0 24.0 32.0 40.0 48.0 56.0 64.0 72.0 80.0 88.0 96.0 104.0 112.0 120.0 128.0 136.0 144.0 152.0 160.0 168.0 176.0 184.0 192.0 200.0 208.0 216.0 224.0 232.0 240.0 248.0 4.0 12.0 20.0 28.0 36.0 44.0 52.0 60.0 68.0 76.0 84.0 92.0 100.0 108.0 116.0 124.0 132.0 140.0 148.0 156.0 164.0 172.0 180.0 188.0 196.0 204.0 212.0 220.0 228.0 236.0 244.0 252.0
# CHECK-LABEL: test_load_b
# CHECK: 0.0 1.0 2.0 3.0 4.0 5.0 6.0 7.0 8.0 9.0 10.0 11.0 12.0 13.0 14.0 15.0 16.0 17.0 18.0 19.0 20.0 21.0 22.0 23.0 24.0 25.0 26.0 27.0 28.0 29.0 30.0 31.0 128.0 129.0 130.0 131.0 132.0 133.0 134.0 135.0 136.0 137.0 138.0 139.0 140.0 141.0 142.0 143.0 144.0 145.0 146.0 147.0 148.0 149.0 150.0 151.0 152.0 153.0 154.0 155.0 156.0 157.0 158.0 159.0
# CHECK-LABEL: test_load_c
# CHECK: 0.0 32.0 64.0 96.0
# CHECK: 1.0 33.0 65.0 97.0
# CHECK: 2.0 34.0 66.0 98.0
# CHECK: 3.0 35.0 67.0 99.0
# CHECK: 4.0 36.0 68.0 100.0
# CHECK: 5.0 37.0 69.0 101.0
# CHECK: 6.0 38.0 70.0 102.0
# CHECK: 7.0 39.0 71.0 103.0
# CHECK: 8.0 40.0 72.0 104.0
# CHECK: 9.0 41.0 73.0 105.0
# CHECK: 10.0 42.0 74.0 106.0
# CHECK: 11.0 43.0 75.0 107.0
# CHECK: 12.0 44.0 76.0 108.0
# CHECK: 13.0 45.0 77.0 109.0
# CHECK: 14.0 46.0 78.0 110.0
# CHECK: 15.0 47.0 79.0 111.0
# CHECK: 16.0 48.0 80.0 112.0
# CHECK: 17.0 49.0 81.0 113.0
# CHECK: 18.0 50.0 82.0 114.0
# CHECK: 19.0 51.0 83.0 115.0
# CHECK: 20.0 52.0 84.0 116.0
# CHECK: 21.0 53.0 85.0 117.0
# CHECK: 22.0 54.0 86.0 118.0
# CHECK: 23.0 55.0 87.0 119.0
# CHECK: 24.0 56.0 88.0 120.0
# CHECK: 25.0 57.0 89.0 121.0
# CHECK: 26.0 58.0 90.0 122.0
# CHECK: 27.0 59.0 91.0 123.0
# CHECK: 28.0 60.0 92.0 124.0
# CHECK: 29.0 61.0 93.0 125.0
# CHECK: 30.0 62.0 94.0 126.0
# CHECK: 31.0 63.0 95.0 127.0
# CHECK: 128.0 160.0 192.0 224.0
# CHECK: 129.0 161.0 193.0 225.0
# CHECK: 130.0 162.0 194.0 226.0
# CHECK: 131.0 163.0 195.0 227.0
# CHECK: 132.0 164.0 196.0 228.0
# CHECK: 133.0 165.0 197.0 229.0
# CHECK: 134.0 166.0 198.0 230.0
# CHECK: 135.0 167.0 199.0 231.0
# CHECK: 136.0 168.0 200.0 232.0
# CHECK: 137.0 169.0 201.0 233.0
# CHECK: 138.0 170.0 202.0 234.0
# CHECK: 139.0 171.0 203.0 235.0
# CHECK: 140.0 172.0 204.0 236.0
# CHECK: 141.0 173.0 205.0 237.0
# CHECK: 142.0 174.0 206.0 238.0
# CHECK: 143.0 175.0 207.0 239.0
# CHECK: 144.0 176.0 208.0 240.0
# CHECK: 145.0 177.0 209.0 241.0
# CHECK: 146.0 178.0 210.0 242.0
# CHECK: 147.0 179.0 211.0 243.0
# CHECK: 148.0 180.0 212.0 244.0
# CHECK: 149.0 181.0 213.0 245.0
# CHECK: 150.0 182.0 214.0 246.0
# CHECK: 151.0 183.0 215.0 247.0
# CHECK: 152.0 184.0 216.0 248.0
# CHECK: 153.0 185.0 217.0 249.0
# CHECK: 154.0 186.0 218.0 250.0
# CHECK: 155.0 187.0 219.0 251.0
# CHECK: 156.0 188.0 220.0 252.0
# CHECK: 157.0 189.0 221.0 253.0
# CHECK: 158.0 190.0 222.0 254.0
# CHECK: 159.0 191.0 223.0 255.0
# CHECK-LABEL: test_load_d
# CHECK: 0.0 1.0 2.0 3.0 4.0 5.0 6.0 7.0 8.0 9.0 10.0 11.0 12.0 13.0 14.0 15.0 16.0 17.0 18.0 19.0 20.0 21.0 22.0 23.0 24.0 25.0 26.0 27.0 28.0 29.0 30.0 31.0
# CHECK: 0.0 1.0 2.0 3.0 4.0 5.0 6.0 7.0 8.0 9.0 10.0 11.0 12.0 13.0 14.0 15.0 16.0 17.0 18.0 19.0 20.0 21.0 22.0 23.0 24.0 25.0 26.0 27.0 28.0 29.0 30.0 31.0
# CHECK: 0.0 1.0 2.0 3.0 4.0 5.0 6.0 7.0 8.0 9.0 10.0 11.0 12.0 13.0 14.0 15.0 16.0 17.0 18.0 19.0 20.0 21.0 22.0 23.0 24.0 25.0 26.0 27.0 28.0 29.0 30.0 31.0
# CHECK: 0.0 1.0 2.0 3.0 4.0 5.0 6.0 7.0 8.0 9.0 10.0 11.0 12.0 13.0 14.0 15.0 16.0 17.0 18.0 19.0 20.0 21.0 22.0 23.0 24.0 25.0 26.0 27.0 28.0 29.0 30.0 31.0
# CHECK: 32.0 33.0 34.0 35.0 36.0 37.0 38.0 39.0 40.0 41.0 42.0 43.0 44.0 45.0 46.0 47.0 48.0 49.0 50.0 51.0 52.0 53.0 54.0 55.0 56.0 57.0 58.0 59.0 60.0 61.0 62.0 63.0
# CHECK: 32.0 33.0 34.0 35.0 36.0 37.0 38.0 39.0 40.0 41.0 42.0 43.0 44.0 45.0 46.0 47.0 48.0 49.0 50.0 51.0 52.0 53.0 54.0 55.0 56.0 57.0 58.0 59.0 60.0 61.0 62.0 63.0
# CHECK: 32.0 33.0 34.0 35.0 36.0 37.0 38.0 39.0 40.0 41.0 42.0 43.0 44.0 45.0 46.0 47.0 48.0 49.0 50.0 51.0 52.0 53.0 54.0 55.0 56.0 57.0 58.0 59.0 60.0 61.0 62.0 63.0
# CHECK: 32.0 33.0 34.0 35.0 36.0 37.0 38.0 39.0 40.0 41.0 42.0 43.0 44.0 45.0 46.0 47.0 48.0 49.0 50.0 51.0 52.0 53.0 54.0 55.0 56.0 57.0 58.0 59.0 60.0 61.0 62.0 63.0
# CHECK: 0.0 1.0 2.0 3.0 4.0 5.0 6.0 7.0 8.0 9.0 10.0 11.0 12.0 13.0 14.0 15.0 16.0 17.0 18.0 19.0 20.0 21.0 22.0 23.0 24.0 25.0 26.0 27.0 28.0 29.0 30.0 31.0
# CHECK: 0.0 1.0 2.0 3.0 4.0 5.0 6.0 7.0 8.0 9.0 10.0 11.0 12.0 13.0 14.0 15.0 16.0 17.0 18.0 19.0 20.0 21.0 22.0 23.0 24.0 25.0 26.0 27.0 28.0 29.0 30.0 31.0
# CHECK: 0.0 1.0 2.0 3.0 4.0 5.0 6.0 7.0 8.0 9.0 10.0 11.0 12.0 13.0 14.0 15.0 16.0 17.0 18.0 19.0 20.0 21.0 22.0 23.0 24.0 25.0 26.0 27.0 28.0 29.0 30.0 31.0
# CHECK: 0.0 1.0 2.0 3.0 4.0 5.0 6.0 7.0 8.0 9.0 10.0 11.0 12.0 13.0 14.0 15.0 16.0 17.0 18.0 19.0 20.0 21.0 22.0 23.0 24.0 25.0 26.0 27.0 28.0 29.0 30.0 31.0
# CHECK: 32.0 33.0 34.0 35.0 36.0 37.0 38.0 39.0 40.0 41.0 42.0 43.0 44.0 45.0 46.0 47.0 48.0 49.0 50.0 51.0 52.0 53.0 54.0 55.0 56.0 57.0 58.0 59.0 60.0 61.0 62.0 63.0
# CHECK: 32.0 33.0 34.0 35.0 36.0 37.0 38.0 39.0 40.0 41.0 42.0 43.0 44.0 45.0 46.0 47.0 48.0 49.0 50.0 51.0 52.0 53.0 54.0 55.0 56.0 57.0 58.0 59.0 60.0 61.0 62.0 63.0
# CHECK: 32.0 33.0 34.0 35.0 36.0 37.0 38.0 39.0 40.0 41.0 42.0 43.0 44.0 45.0 46.0 47.0 48.0 49.0 50.0 51.0 52.0 53.0 54.0 55.0 56.0 57.0 58.0 59.0 60.0 61.0 62.0 63.0
# CHECK: 32.0 33.0 34.0 35.0 36.0 37.0 38.0 39.0 40.0 41.0 42.0 43.0 44.0 45.0 46.0 47.0 48.0 49.0 50.0 51.0 52.0 53.0 54.0 55.0 56.0 57.0 58.0 59.0 60.0 61.0 62.0 63.0
# CHECK: 0.0 1.0 2.0 3.0 4.0 5.0 6.0 7.0 8.0 9.0 10.0 11.0 12.0 13.0 14.0 15.0 16.0 17.0 18.0 19.0 20.0 21.0 22.0 23.0 24.0 25.0 26.0 27.0 28.0 29.0 30.0 31.0
# CHECK: 0.0 1.0 2.0 3.0 4.0 5.0 6.0 7.0 8.0 9.0 10.0 11.0 12.0 13.0 14.0 15.0 16.0 17.0 18.0 19.0 20.0 21.0 22.0 23.0 24.0 25.0 26.0 27.0 28.0 29.0 30.0 31.0
# CHECK: 0.0 1.0 2.0 3.0 4.0 5.0 6.0 7.0 8.0 9.0 10.0 11.0 12.0 13.0 14.0 15.0 16.0 17.0 18.0 19.0 20.0 21.0 22.0 23.0 24.0 25.0 26.0 27.0 28.0 29.0 30.0 31.0
# CHECK: 0.0 1.0 2.0 3.0 4.0 5.0 6.0 7.0 8.0 9.0 10.0 11.0 12.0 13.0 14.0 15.0 16.0 17.0 18.0 19.0 20.0 21.0 22.0 23.0 24.0 25.0 26.0 27.0 28.0 29.0 30.0 31.0
# CHECK: 32.0 33.0 34.0 35.0 36.0 37.0 38.0 39.0 40.0 41.0 42.0 43.0 44.0 45.0 46.0 47.0 48.0 49.0 50.0 51.0 52.0 53.0 54.0 55.0 56.0 57.0 58.0 59.0 60.0 61.0 62.0 63.0
# CHECK: 32.0 33.0 34.0 35.0 36.0 37.0 38.0 39.0 40.0 41.0 42.0 43.0 44.0 45.0 46.0 47.0 48.0 49.0 50.0 51.0 52.0 53.0 54.0 55.0 56.0 57.0 58.0 59.0 60.0 61.0 62.0 63.0
# CHECK: 32.0 33.0 34.0 35.0 36.0 37.0 38.0 39.0 40.0 41.0 42.0 43.0 44.0 45.0 46.0 47.0 48.0 49.0 50.0 51.0 52.0 53.0 54.0 55.0 56.0 57.0 58.0 59.0 60.0 61.0 62.0 63.0
# CHECK: 32.0 33.0 34.0 35.0 36.0 37.0 38.0 39.0 40.0 41.0 42.0 43.0 44.0 45.0 46.0 47.0 48.0 49.0 50.0 51.0 52.0 53.0 54.0 55.0 56.0 57.0 58.0 59.0 60.0 61.0 62.0 63.0
# CHECK: 0.0 1.0 2.0 3.0 4.0 5.0 6.0 7.0 8.0 9.0 10.0 11.0 12.0 13.0 14.0 15.0 16.0 17.0 18.0 19.0 20.0 21.0 22.0 23.0 24.0 25.0 26.0 27.0 28.0 29.0 30.0 31.0
# CHECK: 0.0 1.0 2.0 3.0 4.0 5.0 6.0 7.0 8.0 9.0 10.0 11.0 12.0 13.0 14.0 15.0 16.0 17.0 18.0 19.0 20.0 21.0 22.0 23.0 24.0 25.0 26.0 27.0 28.0 29.0 30.0 31.0
# CHECK: 0.0 1.0 2.0 3.0 4.0 5.0 6.0 7.0 8.0 9.0 10.0 11.0 12.0 13.0 14.0 15.0 16.0 17.0 18.0 19.0 20.0 21.0 22.0 23.0 24.0 25.0 26.0 27.0 28.0 29.0 30.0 31.0
# CHECK: 0.0 1.0 2.0 3.0 4.0 5.0 6.0 7.0 8.0 9.0 10.0 11.0 12.0 13.0 14.0 15.0 16.0 17.0 18.0 19.0 20.0 21.0 22.0 23.0 24.0 25.0 26.0 27.0 28.0 29.0 30.0 31.0
# CHECK: 32.0 33.0 34.0 35.0 36.0 37.0 38.0 39.0 40.0 41.0 42.0 43.0 44.0 45.0 46.0 47.0 48.0 49.0 50.0 51.0 52.0 53.0 54.0 55.0 56.0 57.0 58.0 59.0 60.0 61.0 62.0 63.0
# CHECK: 32.0 33.0 34.0 35.0 36.0 37.0 38.0 39.0 40.0 41.0 42.0 43.0 44.0 45.0 46.0 47.0 48.0 49.0 50.0 51.0 52.0 53.0 54.0 55.0 56.0 57.0 58.0 59.0 60.0 61.0 62.0 63.0
# CHECK: 32.0 33.0 34.0 35.0 36.0 37.0 38.0 39.0 40.0 41.0 42.0 43.0 44.0 45.0 46.0 47.0 48.0 49.0 50.0 51.0 52.0 53.0 54.0 55.0 56.0 57.0 58.0 59.0 60.0 61.0 62.0 63.0
# CHECK: 32.0 33.0 34.0 35.0 36.0 37.0 38.0 39.0 40.0 41.0 42.0 43.0 44.0 45.0 46.0 47.0 48.0 49.0 50.0 51.0 52.0 53.0 54.0 55.0 56.0 57.0 58.0 59.0 60.0 61.0 62.0 63.0
# CHECK-LABEL: test_mma
# CHECK: 4480.0 4509.0 4538.0 4567.0 4596.0 4625.0 4654.0 4683.0 4712.0 4741.0 4770.0 4799.0 4828.0 4857.0 4886.0 4915.0 4944.0 4973.0 5002.0 5031.0 5060.0 5089.0 5118.0 5147.0 5176.0 5205.0 5234.0 5263.0 5292.0 5321.0 5350.0 5379.0
# CHECK: 11680.0 11773.0 11866.0 11959.0 12052.0 12145.0 12238.0 12331.0 12424.0 12517.0 12610.0 12703.0 12796.0 12889.0 12982.0 13075.0 13168.0 13261.0 13354.0 13447.0 13540.0 13633.0 13726.0 13819.0 13912.0 14005.0 14098.0 14191.0 14284.0 14377.0 14470.0 14563.0
# CHECK: 18880.0 19037.0 19194.0 19351.0 19508.0 19665.0 19822.0 19979.0 20136.0 20293.0 20450.0 20607.0 20764.0 20921.0 21078.0 21235.0 21392.0 21549.0 21706.0 21863.0 22020.0 22177.0 22334.0 22491.0 22648.0 22805.0 22962.0 23119.0 23276.0 23433.0 23590.0 23747.0
# CHECK: 26080.0 26301.0 26522.0 26743.0 26964.0 27185.0 27406.0 27627.0 27848.0 28069.0 28290.0 28511.0 28732.0 28953.0 29174.0 29395.0 29616.0 29837.0 30058.0 30279.0 30500.0 30721.0 30942.0 31163.0 31384.0 31605.0 31826.0 32047.0 32268.0 32489.0 32710.0 32931.0
# CHECK: 33280.0 33565.0 33850.0 34135.0 34420.0 34705.0 34990.0 35275.0 35560.0 35845.0 36130.0 36415.0 36700.0 36985.0 37270.0 37555.0 37840.0 38125.0 38410.0 38695.0 38980.0 39265.0 39550.0 39835.0 40120.0 40405.0 40690.0 40975.0 41260.0 41545.0 41830.0 42115.0
# CHECK: 40480.0 40829.0 41178.0 41527.0 41876.0 42225.0 42574.0 42923.0 43272.0 43621.0 43970.0 44319.0 44668.0 45017.0 45366.0 45715.0 46064.0 46413.0 46762.0 47111.0 47460.0 47809.0 48158.0 48507.0 48856.0 49205.0 49554.0 49903.0 50252.0 50601.0 50950.0 51299.0
# CHECK: 47680.0 48093.0 48506.0 48919.0 49332.0 49745.0 50158.0 50571.0 50984.0 51397.0 51810.0 52223.0 52636.0 53049.0 53462.0 53875.0 54288.0 54701.0 55114.0 55527.0 55940.0 56353.0 56766.0 57179.0 57592.0 58005.0 58418.0 58831.0 59244.0 59657.0 60070.0 60483.0
# CHECK: 54880.0 55357.0 55834.0 56311.0 56788.0 57265.0 57742.0 58219.0 58696.0 59173.0 59650.0 60127.0 60604.0 61081.0 61558.0 62035.0 62512.0 62989.0 63466.0 63943.0 64420.0 64897.0 65374.0 65851.0 66328.0 66805.0 67282.0 67759.0 68236.0 68713.0 69190.0 69667.0
# CHECK: 62080.0 62621.0 63162.0 63703.0 64244.0 64785.0 65326.0 65867.0 66408.0 66949.0 67490.0 68031.0 68572.0 69113.0 69654.0 70195.0 70736.0 71277.0 71818.0 72359.0 72900.0 73441.0 73982.0 74523.0 75064.0 75605.0 76146.0 76687.0 77228.0 77769.0 78310.0 78851.0
# CHECK: 69280.0 69885.0 70490.0 71095.0 71700.0 72305.0 72910.0 73515.0 74120.0 74725.0 75330.0 75935.0 76540.0 77145.0 77750.0 78355.0 78960.0 79565.0 80170.0 80775.0 81380.0 81985.0 82590.0 83195.0 83800.0 84405.0 85010.0 85615.0 86220.0 86825.0 87430.0 88035.0
# CHECK: 76480.0 77149.0 77818.0 78487.0 79156.0 79825.0 80494.0 81163.0 81832.0 82501.0 83170.0 83839.0 84508.0 85177.0 85846.0 86515.0 87184.0 87853.0 88522.0 89191.0 89860.0 90529.0 91198.0 91867.0 92536.0 93205.0 93874.0 94543.0 95212.0 95881.0 96550.0 97219.0
# CHECK: 83680.0 84413.0 85146.0 85879.0 86612.0 87345.0 88078.0 88811.0 89544.0 90277.0 91010.0 91743.0 92476.0 93209.0 93942.0 94675.0 95408.0 96141.0 96874.0 97607.0 98340.0 99073.0 99806.0 100539.0 101272.0 102005.0 102738.0 103471.0 104204.0 104937.0 105670.0 106403.0
# CHECK: 90880.0 91677.0 92474.0 93271.0 94068.0 94865.0 95662.0 96459.0 97256.0 98053.0 98850.0 99647.0 100444.0 101241.0 102038.0 102835.0 103632.0 104429.0 105226.0 106023.0 106820.0 107617.0 108414.0 109211.0 110008.0 110805.0 111602.0 112399.0 113196.0 113993.0 114790.0 115587.0
# CHECK: 98080.0 98941.0 99802.0 100663.0 101524.0 102385.0 103246.0 104107.0 104968.0 105829.0 106690.0 107551.0 108412.0 109273.0 110134.0 110995.0 111856.0 112717.0 113578.0 114439.0 115300.0 116161.0 117022.0 117883.0 118744.0 119605.0 120466.0 121327.0 122188.0 123049.0 123910.0 124771.0
# CHECK: 105280.0 106205.0 107130.0 108055.0 108980.0 109905.0 110830.0 111755.0 112680.0 113605.0 114530.0 115455.0 116380.0 117305.0 118230.0 119155.0 120080.0 121005.0 121930.0 122855.0 123780.0 124705.0 125630.0 126555.0 127480.0 128405.0 129330.0 130255.0 131180.0 132105.0 133030.0 133955.0
# CHECK: 112480.0 113469.0 114458.0 115447.0 116436.0 117425.0 118414.0 119403.0 120392.0 121381.0 122370.0 123359.0 124348.0 125337.0 126326.0 127315.0 128304.0 129293.0 130282.0 131271.0 132260.0 133249.0 134238.0 135227.0 136216.0 137205.0 138194.0 139183.0 140172.0 141161.0 142150.0 143139.0
# CHECK: 119680.0 120733.0 121786.0 122839.0 123892.0 124945.0 125998.0 127051.0 128104.0 129157.0 130210.0 131263.0 132316.0 133369.0 134422.0 135475.0 136528.0 137581.0 138634.0 139687.0 140740.0 141793.0 142846.0 143899.0 144952.0 146005.0 147058.0 148111.0 149164.0 150217.0 151270.0 152323.0
# CHECK: 126880.0 127997.0 129114.0 130231.0 131348.0 132465.0 133582.0 134699.0 135816.0 136933.0 138050.0 139167.0 140284.0 141401.0 142518.0 143635.0 144752.0 145869.0 146986.0 148103.0 149220.0 150337.0 151454.0 152571.0 153688.0 154805.0 155922.0 157039.0 158156.0 159273.0 160390.0 161507.0
# CHECK: 134080.0 135261.0 136442.0 137623.0 138804.0 139985.0 141166.0 142347.0 143528.0 144709.0 145890.0 147071.0 148252.0 149433.0 150614.0 151795.0 152976.0 154157.0 155338.0 156519.0 157700.0 158881.0 160062.0 161243.0 162424.0 163605.0 164786.0 165967.0 167148.0 168329.0 169510.0 170691.0
# CHECK: 141280.0 142525.0 143770.0 145015.0 146260.0 147505.0 148750.0 149995.0 151240.0 152485.0 153730.0 154975.0 156220.0 157465.0 158710.0 159955.0 161200.0 162445.0 163690.0 164935.0 166180.0 167425.0 168670.0 169915.0 171160.0 172405.0 173650.0 174895.0 176140.0 177385.0 178630.0 179875.0
# CHECK: 148480.0 149789.0 151098.0 152407.0 153716.0 155025.0 156334.0 157643.0 158952.0 160261.0 161570.0 162879.0 164188.0 165497.0 166806.0 168115.0 169424.0 170733.0 172042.0 173351.0 174660.0 175969.0 177278.0 178587.0 179896.0 181205.0 182514.0 183823.0 185132.0 186441.0 187750.0 189059.0
# CHECK: 155680.0 157053.0 158426.0 159799.0 161172.0 162545.0 163918.0 165291.0 166664.0 168037.0 169410.0 170783.0 172156.0 173529.0 174902.0 176275.0 177648.0 179021.0 180394.0 181767.0 183140.0 184513.0 185886.0 187259.0 188632.0 190005.0 191378.0 192751.0 194124.0 195497.0 196870.0 198243.0
# CHECK: 162880.0 164317.0 165754.0 167191.0 168628.0 170065.0 171502.0 172939.0 174376.0 175813.0 177250.0 178687.0 180124.0 181561.0 182998.0 184435.0 185872.0 187309.0 188746.0 190183.0 191620.0 193057.0 194494.0 195931.0 197368.0 198805.0 200242.0 201679.0 203116.0 204553.0 205990.0 207427.0
# CHECK: 170080.0 171581.0 173082.0 174583.0 176084.0 177585.0 179086.0 180587.0 182088.0 183589.0 185090.0 186591.0 188092.0 189593.0 191094.0 192595.0 194096.0 195597.0 197098.0 198599.0 200100.0 201601.0 203102.0 204603.0 206104.0 207605.0 209106.0 210607.0 212108.0 213609.0 215110.0 216611.0
# CHECK: 177280.0 178845.0 180410.0 181975.0 183540.0 185105.0 186670.0 188235.0 189800.0 191365.0 192930.0 194495.0 196060.0 197625.0 199190.0 200755.0 202320.0 203885.0 205450.0 207015.0 208580.0 210145.0 211710.0 213275.0 214840.0 216405.0 217970.0 219535.0 221100.0 222665.0 224230.0 225795.0
# CHECK: 184480.0 186109.0 187738.0 189367.0 190996.0 192625.0 194254.0 195883.0 197512.0 199141.0 200770.0 202399.0 204028.0 205657.0 207286.0 208915.0 210544.0 212173.0 213802.0 215431.0 217060.0 218689.0 220318.0 221947.0 223576.0 225205.0 226834.0 228463.0 230092.0 231721.0 233350.0 234979.0
# CHECK: 191680.0 193373.0 195066.0 196759.0 198452.0 200145.0 201838.0 203531.0 205224.0 206917.0 208610.0 210303.0 211996.0 213689.0 215382.0 217075.0 218768.0 220461.0 222154.0 223847.0 225540.0 227233.0 228926.0 230619.0 232312.0 234005.0 235698.0 237391.0 239084.0 240777.0 242470.0 244163.0
# CHECK: 198880.0 200637.0 202394.0 204151.0 205908.0 207665.0 209422.0 211179.0 212936.0 214693.0 216450.0 218207.0 219964.0 221721.0 223478.0 225235.0 226992.0 228749.0 230506.0 232263.0 234020.0 235777.0 237534.0 239291.0 241048.0 242805.0 244562.0 246319.0 248076.0 249833.0 251590.0 253347.0
# CHECK: 206080.0 207901.0 209722.0 211543.0 213364.0 215185.0 217006.0 218827.0 220648.0 222469.0 224290.0 226111.0 227932.0 229753.0 231574.0 233395.0 235216.0 237037.0 238858.0 240679.0 242500.0 244321.0 246142.0 247963.0 249784.0 251605.0 253426.0 255247.0 257068.0 258889.0 260710.0 262531.0
# CHECK: 213280.0 215165.0 217050.0 218935.0 220820.0 222705.0 224590.0 226475.0 228360.0 230245.0 232130.0 234015.0 235900.0 237785.0 239670.0 241555.0 243440.0 245325.0 247210.0 249095.0 250980.0 252865.0 254750.0 256635.0 258520.0 260405.0 262290.0 264175.0 266060.0 267945.0 269830.0 271715.0
# CHECK: 220480.0 222429.0 224378.0 226327.0 228276.0 230225.0 232174.0 234123.0 236072.0 238021.0 239970.0 241919.0 243868.0 245817.0 247766.0 249715.0 251664.0 253613.0 255562.0 257511.0 259460.0 261409.0 263358.0 265307.0 267256.0 269205.0 271154.0 273103.0 275052.0 277001.0 278950.0 280899.0
# CHECK: 227680.0 229693.0 231706.0 233719.0 235732.0 237745.0 239758.0 241771.0 243784.0 245797.0 247810.0 249823.0 251836.0 253849.0 255862.0 257875.0 259888.0 261901.0 263914.0 265927.0 267940.0 269953.0 271966.0 273979.0 275992.0 278005.0 280018.0 282031.0 284044.0 286057.0 288070.0 290083.0


def test_load_and_mma_f32_f16_32x32x8(ctx: DeviceContext):
    print("== test_load_and_mma_f32_f16_32x32x8")
    test_load_and_mma_and_multiply_operands[
        DType.float32, DType.float16, Index(32, 32, 8), False
    ](ctx)


# CHECK-LABEL: == test_load_and_mma_f32_f16_32x32x8_transpose
# CHECK-LABEL: == test_load_a
# CHECK:0.0 8.0 16.0 24.0 32.0 40.0 48.0 56.0 64.0 72.0 80.0 88.0 96.0 104.0 112.0 120.0 128.0 136.0 144.0 152.0 160.0 168.0 176.0 184.0 192.0 200.0 208.0 216.0 224.0 232.0 240.0 248.0 4.0 12.0 20.0 28.0 36.0 44.0 52.0 60.0 68.0 76.0 84.0 92.0 100.0 108.0 116.0 124.0 132.0 140.0 148.0 156.0 164.0 172.0 180.0 188.0 196.0 204.0 212.0 220.0 228.0 236.0 244.0 252.0
# CHECK-LABEL: == test_load_b
# CHECK:0.0 8.0 16.0 24.0 32.0 40.0 48.0 56.0 64.0 72.0 80.0 88.0 96.0 104.0 112.0 120.0 128.0 136.0 144.0 152.0 160.0 168.0 176.0 184.0 192.0 200.0 208.0 216.0 224.0 232.0 240.0 248.0 4.0 12.0 20.0 28.0 36.0 44.0 52.0 60.0 68.0 76.0 84.0 92.0 100.0 108.0 116.0 124.0 132.0 140.0 148.0 156.0 164.0 172.0 180.0 188.0 196.0 204.0 212.0 220.0 228.0 236.0 244.0 252.0
# CHECK-LABEL: == test_load_c
# CHECK 0.0 32.0 64.0 96.0
# CHECK 1.0 33.0 65.0 97.0
# CHECK 2.0 34.0 66.0 98.0
# CHECK 3.0 35.0 67.0 99.0
# CHECK 4.0 36.0 68.0 100.0
# CHECK 5.0 37.0 69.0 101.0
# CHECK 6.0 38.0 70.0 102.0
# CHECK 7.0 39.0 71.0 103.0
# CHECK 8.0 40.0 72.0 104.0
# CHECK 9.0 41.0 73.0 105.0
# CHECK 10.0 42.0 74.0 106.0
# CHECK 11.0 43.0 75.0 107.0
# CHECK 12.0 44.0 76.0 108.0
# CHECK 13.0 45.0 77.0 109.0
# CHECK 14.0 46.0 78.0 110.0
# CHECK 15.0 47.0 79.0 111.0
# CHECK 16.0 48.0 80.0 112.0
# CHECK 17.0 49.0 81.0 113.0
# CHECK 18.0 50.0 82.0 114.0
# CHECK 19.0 51.0 83.0 115.0
# CHECK 20.0 52.0 84.0 116.0
# CHECK 21.0 53.0 85.0 117.0
# CHECK 22.0 54.0 86.0 118.0
# CHECK 23.0 55.0 87.0 119.0
# CHECK 24.0 56.0 88.0 120.0
# CHECK 25.0 57.0 89.0 121.0
# CHECK 26.0 58.0 90.0 122.0
# CHECK 27.0 59.0 91.0 123.0
# CHECK 28.0 60.0 92.0 124.0
# CHECK 29.0 61.0 93.0 125.0
# CHECK 30.0 62.0 94.0 126.0
# CHECK 31.0 63.0 95.0 127.0
# CHECK 128.0 160.0 192.0 224.0
# CHECK 129.0 161.0 193.0 225.0
# CHECK 130.0 162.0 194.0 226.0
# CHECK 131.0 163.0 195.0 227.0
# CHECK 132.0 164.0 196.0 228.0
# CHECK 133.0 165.0 197.0 229.0
# CHECK 134.0 166.0 198.0 230.0
# CHECK 135.0 167.0 199.0 231.0
# CHECK 136.0 168.0 200.0 232.0
# CHECK 137.0 169.0 201.0 233.0
# CHECK 138.0 170.0 202.0 234.0
# CHECK 139.0 171.0 203.0 235.0
# CHECK 140.0 172.0 204.0 236.0
# CHECK 141.0 173.0 205.0 237.0
# CHECK 142.0 174.0 206.0 238.0
# CHECK 143.0 175.0 207.0 239.0
# CHECK 144.0 176.0 208.0 240.0
# CHECK 145.0 177.0 209.0 241.0
# CHECK 146.0 178.0 210.0 242.0
# CHECK 147.0 179.0 211.0 243.0
# CHECK 148.0 180.0 212.0 244.0
# CHECK 149.0 181.0 213.0 245.0
# CHECK 150.0 182.0 214.0 246.0
# CHECK 151.0 183.0 215.0 247.0
# CHECK 152.0 184.0 216.0 248.0
# CHECK 153.0 185.0 217.0 249.0
# CHECK 154.0 186.0 218.0 250.0
# CHECK 155.0 187.0 219.0 251.0
# CHECK 156.0 188.0 220.0 252.0
# CHECK 157.0 189.0 221.0 253.0
# CHECK 158.0 190.0 222.0 254.0
# CHECK 159.0 191.0 223.0 255.0
# CHECK-LABEL: == test_load_d
# CHECK: 0.0 1.0 2.0 3.0 4.0 5.0 6.0 7.0 8.0 9.0 10.0 11.0 12.0 13.0 14.0 15.0 16.0 17.0 18.0 19.0 20.0 21.0 22.0 23.0 24.0 25.0 26.0 27.0 28.0 29.0 30.0 31.0
# CHECK: 0.0 1.0 2.0 3.0 4.0 5.0 6.0 7.0 8.0 9.0 10.0 11.0 12.0 13.0 14.0 15.0 16.0 17.0 18.0 19.0 20.0 21.0 22.0 23.0 24.0 25.0 26.0 27.0 28.0 29.0 30.0 31.0
# CHECK: 0.0 1.0 2.0 3.0 4.0 5.0 6.0 7.0 8.0 9.0 10.0 11.0 12.0 13.0 14.0 15.0 16.0 17.0 18.0 19.0 20.0 21.0 22.0 23.0 24.0 25.0 26.0 27.0 28.0 29.0 30.0 31.0
# CHECK: 0.0 1.0 2.0 3.0 4.0 5.0 6.0 7.0 8.0 9.0 10.0 11.0 12.0 13.0 14.0 15.0 16.0 17.0 18.0 19.0 20.0 21.0 22.0 23.0 24.0 25.0 26.0 27.0 28.0 29.0 30.0 31.0
# CHECK: 32.0 33.0 34.0 35.0 36.0 37.0 38.0 39.0 40.0 41.0 42.0 43.0 44.0 45.0 46.0 47.0 48.0 49.0 50.0 51.0 52.0 53.0 54.0 55.0 56.0 57.0 58.0 59.0 60.0 61.0 62.0 63.0
# CHECK: 32.0 33.0 34.0 35.0 36.0 37.0 38.0 39.0 40.0 41.0 42.0 43.0 44.0 45.0 46.0 47.0 48.0 49.0 50.0 51.0 52.0 53.0 54.0 55.0 56.0 57.0 58.0 59.0 60.0 61.0 62.0 63.0
# CHECK: 32.0 33.0 34.0 35.0 36.0 37.0 38.0 39.0 40.0 41.0 42.0 43.0 44.0 45.0 46.0 47.0 48.0 49.0 50.0 51.0 52.0 53.0 54.0 55.0 56.0 57.0 58.0 59.0 60.0 61.0 62.0 63.0
# CHECK: 32.0 33.0 34.0 35.0 36.0 37.0 38.0 39.0 40.0 41.0 42.0 43.0 44.0 45.0 46.0 47.0 48.0 49.0 50.0 51.0 52.0 53.0 54.0 55.0 56.0 57.0 58.0 59.0 60.0 61.0 62.0 63.0
# CHECK: 0.0 1.0 2.0 3.0 4.0 5.0 6.0 7.0 8.0 9.0 10.0 11.0 12.0 13.0 14.0 15.0 16.0 17.0 18.0 19.0 20.0 21.0 22.0 23.0 24.0 25.0 26.0 27.0 28.0 29.0 30.0 31.0
# CHECK: 0.0 1.0 2.0 3.0 4.0 5.0 6.0 7.0 8.0 9.0 10.0 11.0 12.0 13.0 14.0 15.0 16.0 17.0 18.0 19.0 20.0 21.0 22.0 23.0 24.0 25.0 26.0 27.0 28.0 29.0 30.0 31.0
# CHECK: 0.0 1.0 2.0 3.0 4.0 5.0 6.0 7.0 8.0 9.0 10.0 11.0 12.0 13.0 14.0 15.0 16.0 17.0 18.0 19.0 20.0 21.0 22.0 23.0 24.0 25.0 26.0 27.0 28.0 29.0 30.0 31.0
# CHECK: 0.0 1.0 2.0 3.0 4.0 5.0 6.0 7.0 8.0 9.0 10.0 11.0 12.0 13.0 14.0 15.0 16.0 17.0 18.0 19.0 20.0 21.0 22.0 23.0 24.0 25.0 26.0 27.0 28.0 29.0 30.0 31.0
# CHECK: 32.0 33.0 34.0 35.0 36.0 37.0 38.0 39.0 40.0 41.0 42.0 43.0 44.0 45.0 46.0 47.0 48.0 49.0 50.0 51.0 52.0 53.0 54.0 55.0 56.0 57.0 58.0 59.0 60.0 61.0 62.0 63.0
# CHECK: 32.0 33.0 34.0 35.0 36.0 37.0 38.0 39.0 40.0 41.0 42.0 43.0 44.0 45.0 46.0 47.0 48.0 49.0 50.0 51.0 52.0 53.0 54.0 55.0 56.0 57.0 58.0 59.0 60.0 61.0 62.0 63.0
# CHECK: 32.0 33.0 34.0 35.0 36.0 37.0 38.0 39.0 40.0 41.0 42.0 43.0 44.0 45.0 46.0 47.0 48.0 49.0 50.0 51.0 52.0 53.0 54.0 55.0 56.0 57.0 58.0 59.0 60.0 61.0 62.0 63.0
# CHECK: 32.0 33.0 34.0 35.0 36.0 37.0 38.0 39.0 40.0 41.0 42.0 43.0 44.0 45.0 46.0 47.0 48.0 49.0 50.0 51.0 52.0 53.0 54.0 55.0 56.0 57.0 58.0 59.0 60.0 61.0 62.0 63.0
# CHECK: 0.0 1.0 2.0 3.0 4.0 5.0 6.0 7.0 8.0 9.0 10.0 11.0 12.0 13.0 14.0 15.0 16.0 17.0 18.0 19.0 20.0 21.0 22.0 23.0 24.0 25.0 26.0 27.0 28.0 29.0 30.0 31.0
# CHECK: 0.0 1.0 2.0 3.0 4.0 5.0 6.0 7.0 8.0 9.0 10.0 11.0 12.0 13.0 14.0 15.0 16.0 17.0 18.0 19.0 20.0 21.0 22.0 23.0 24.0 25.0 26.0 27.0 28.0 29.0 30.0 31.0
# CHECK: 0.0 1.0 2.0 3.0 4.0 5.0 6.0 7.0 8.0 9.0 10.0 11.0 12.0 13.0 14.0 15.0 16.0 17.0 18.0 19.0 20.0 21.0 22.0 23.0 24.0 25.0 26.0 27.0 28.0 29.0 30.0 31.0
# CHECK: 0.0 1.0 2.0 3.0 4.0 5.0 6.0 7.0 8.0 9.0 10.0 11.0 12.0 13.0 14.0 15.0 16.0 17.0 18.0 19.0 20.0 21.0 22.0 23.0 24.0 25.0 26.0 27.0 28.0 29.0 30.0 31.0
# CHECK: 32.0 33.0 34.0 35.0 36.0 37.0 38.0 39.0 40.0 41.0 42.0 43.0 44.0 45.0 46.0 47.0 48.0 49.0 50.0 51.0 52.0 53.0 54.0 55.0 56.0 57.0 58.0 59.0 60.0 61.0 62.0 63.0
# CHECK: 32.0 33.0 34.0 35.0 36.0 37.0 38.0 39.0 40.0 41.0 42.0 43.0 44.0 45.0 46.0 47.0 48.0 49.0 50.0 51.0 52.0 53.0 54.0 55.0 56.0 57.0 58.0 59.0 60.0 61.0 62.0 63.0
# CHECK: 32.0 33.0 34.0 35.0 36.0 37.0 38.0 39.0 40.0 41.0 42.0 43.0 44.0 45.0 46.0 47.0 48.0 49.0 50.0 51.0 52.0 53.0 54.0 55.0 56.0 57.0 58.0 59.0 60.0 61.0 62.0 63.0
# CHECK: 32.0 33.0 34.0 35.0 36.0 37.0 38.0 39.0 40.0 41.0 42.0 43.0 44.0 45.0 46.0 47.0 48.0 49.0 50.0 51.0 52.0 53.0 54.0 55.0 56.0 57.0 58.0 59.0 60.0 61.0 62.0 63.0
# CHECK: 0.0 1.0 2.0 3.0 4.0 5.0 6.0 7.0 8.0 9.0 10.0 11.0 12.0 13.0 14.0 15.0 16.0 17.0 18.0 19.0 20.0 21.0 22.0 23.0 24.0 25.0 26.0 27.0 28.0 29.0 30.0 31.0
# CHECK: 0.0 1.0 2.0 3.0 4.0 5.0 6.0 7.0 8.0 9.0 10.0 11.0 12.0 13.0 14.0 15.0 16.0 17.0 18.0 19.0 20.0 21.0 22.0 23.0 24.0 25.0 26.0 27.0 28.0 29.0 30.0 31.0
# CHECK: 0.0 1.0 2.0 3.0 4.0 5.0 6.0 7.0 8.0 9.0 10.0 11.0 12.0 13.0 14.0 15.0 16.0 17.0 18.0 19.0 20.0 21.0 22.0 23.0 24.0 25.0 26.0 27.0 28.0 29.0 30.0 31.0
# CHECK: 0.0 1.0 2.0 3.0 4.0 5.0 6.0 7.0 8.0 9.0 10.0 11.0 12.0 13.0 14.0 15.0 16.0 17.0 18.0 19.0 20.0 21.0 22.0 23.0 24.0 25.0 26.0 27.0 28.0 29.0 30.0 31.0
# CHECK: 32.0 33.0 34.0 35.0 36.0 37.0 38.0 39.0 40.0 41.0 42.0 43.0 44.0 45.0 46.0 47.0 48.0 49.0 50.0 51.0 52.0 53.0 54.0 55.0 56.0 57.0 58.0 59.0 60.0 61.0 62.0 63.0
# CHECK: 32.0 33.0 34.0 35.0 36.0 37.0 38.0 39.0 40.0 41.0 42.0 43.0 44.0 45.0 46.0 47.0 48.0 49.0 50.0 51.0 52.0 53.0 54.0 55.0 56.0 57.0 58.0 59.0 60.0 61.0 62.0 63.0
# CHECK: 32.0 33.0 34.0 35.0 36.0 37.0 38.0 39.0 40.0 41.0 42.0 43.0 44.0 45.0 46.0 47.0 48.0 49.0 50.0 51.0 52.0 53.0 54.0 55.0 56.0 57.0 58.0 59.0 60.0 61.0 62.0 63.0
# CHECK: 32.0 33.0 34.0 35.0 36.0 37.0 38.0 39.0 40.0 41.0 42.0 43.0 44.0 45.0 46.0 47.0 48.0 49.0 50.0 51.0 52.0 53.0 54.0 55.0 56.0 57.0 58.0 59.0 60.0 61.0 62.0 63.0
# CHECK-LABEL: == test_mma
# CHECK: 140.0 365.0 590.0 815.0 1040.0 1265.0 1490.0 1715.0 1940.0 2165.0 2390.0 2615.0 2840.0 3065.0 3290.0 3515.0 3740.0 3965.0 4190.0 4415.0 4640.0 4865.0 5090.0 5315.0 5540.0 5765.0 5990.0 6215.0 6440.0 6665.0 6890.0 7115.0
# CHECK: 396.0 1133.0 1870.0 2607.0 3344.0 4081.0 4818.0 5555.0 6292.0 7029.0 7766.0 8503.0 9240.0 9977.0 10714.0 11451.0 12188.0 12925.0 13662.0 14399.0 15136.0 15873.0 16610.0 17347.0 18084.0 18821.0 19558.0 20295.0 21032.0 21769.0 22506.0 23243.0
# CHECK: 652.0 1901.0 3150.0 4399.0 5648.0 6897.0 8146.0 9395.0 10644.0 11893.0 13142.0 14391.0 15640.0 16889.0 18138.0 19387.0 20636.0 21885.0 23134.0 24383.0 25632.0 26881.0 28130.0 29379.0 30628.0 31877.0 33126.0 34375.0 35624.0 36873.0 38122.0 39371.0
# CHECK: 908.0 2669.0 4430.0 6191.0 7952.0 9713.0 11474.0 13235.0 14996.0 16757.0 18518.0 20279.0 22040.0 23801.0 25562.0 27323.0 29084.0 30845.0 32606.0 34367.0 36128.0 37889.0 39650.0 41411.0 43172.0 44933.0 46694.0 48455.0 50216.0 51977.0 53738.0 55499.0
# CHECK: 1164.0 3437.0 5710.0 7983.0 10256.0 12529.0 14802.0 17075.0 19348.0 21621.0 23894.0 26167.0 28440.0 30713.0 32986.0 35259.0 37532.0 39805.0 42078.0 44351.0 46624.0 48897.0 51170.0 53443.0 55716.0 57989.0 60262.0 62535.0 64808.0 67081.0 69354.0 71627.0
# CHECK: 1420.0 4205.0 6990.0 9775.0 12560.0 15345.0 18130.0 20915.0 23700.0 26485.0 29270.0 32055.0 34840.0 37625.0 40410.0 43195.0 45980.0 48765.0 51550.0 54335.0 57120.0 59905.0 62690.0 65475.0 68260.0 71045.0 73830.0 76615.0 79400.0 82185.0 84970.0 87755.0
# CHECK: 1676.0 4973.0 8270.0 11567.0 14864.0 18161.0 21458.0 24755.0 28052.0 31349.0 34646.0 37943.0 41240.0 44537.0 47834.0 51131.0 54428.0 57725.0 61022.0 64319.0 67616.0 70913.0 74210.0 77507.0 80804.0 84101.0 87398.0 90695.0 93992.0 97289.0 100586.0 103883.0
# CHECK: 1932.0 5741.0 9550.0 13359.0 17168.0 20977.0 24786.0 28595.0 32404.0 36213.0 40022.0 43831.0 47640.0 51449.0 55258.0 59067.0 62876.0 66685.0 70494.0 74303.0 78112.0 81921.0 85730.0 89539.0 93348.0 97157.0 100966.0 104775.0 108584.0 112393.0 116202.0 120011.0
# CHECK: 2188.0 6509.0 10830.0 15151.0 19472.0 23793.0 28114.0 32435.0 36756.0 41077.0 45398.0 49719.0 54040.0 58361.0 62682.0 67003.0 71324.0 75645.0 79966.0 84287.0 88608.0 92929.0 97250.0 101571.0 105892.0 110213.0 114534.0 118855.0 123176.0 127497.0 131818.0 136139.0
# CHECK: 2444.0 7277.0 12110.0 16943.0 21776.0 26609.0 31442.0 36275.0 41108.0 45941.0 50774.0 55607.0 60440.0 65273.0 70106.0 74939.0 79772.0 84605.0 89438.0 94271.0 99104.0 103937.0 108770.0 113603.0 118436.0 123269.0 128102.0 132935.0 137768.0 142601.0 147434.0 152267.0
# CHECK: 2700.0 8045.0 13390.0 18735.0 24080.0 29425.0 34770.0 40115.0 45460.0 50805.0 56150.0 61495.0 66840.0 72185.0 77530.0 82875.0 88220.0 93565.0 98910.0 104255.0 109600.0 114945.0 120290.0 125635.0 130980.0 136325.0 141670.0 147015.0 152360.0 157705.0 163050.0 168395.0
# CHECK: 2956.0 8813.0 14670.0 20527.0 26384.0 32241.0 38098.0 43955.0 49812.0 55669.0 61526.0 67383.0 73240.0 79097.0 84954.0 90811.0 96668.0 102525.0 108382.0 114239.0 120096.0 125953.0 131810.0 137667.0 143524.0 149381.0 155238.0 161095.0 166952.0 172809.0 178666.0 184523.0
# CHECK: 3212.0 9581.0 15950.0 22319.0 28688.0 35057.0 41426.0 47795.0 54164.0 60533.0 66902.0 73271.0 79640.0 86009.0 92378.0 98747.0 105116.0 111485.0 117854.0 124223.0 130592.0 136961.0 143330.0 149699.0 156068.0 162437.0 168806.0 175175.0 181544.0 187913.0 194282.0 200651.0
# CHECK: 3468.0 10349.0 17230.0 24111.0 30992.0 37873.0 44754.0 51635.0 58516.0 65397.0 72278.0 79159.0 86040.0 92921.0 99802.0 106683.0 113564.0 120445.0 127326.0 134207.0 141088.0 147969.0 154850.0 161731.0 168612.0 175493.0 182374.0 189255.0 196136.0 203017.0 209898.0 216779.0
# CHECK: 3724.0 11117.0 18510.0 25903.0 33296.0 40689.0 48082.0 55475.0 62868.0 70261.0 77654.0 85047.0 92440.0 99833.0 107226.0 114619.0 122012.0 129405.0 136798.0 144191.0 151584.0 158977.0 166370.0 173763.0 181156.0 188549.0 195942.0 203335.0 210728.0 218121.0 225514.0 232907.0
# CHECK: 3980.0 11885.0 19790.0 27695.0 35600.0 43505.0 51410.0 59315.0 67220.0 75125.0 83030.0 90935.0 98840.0 106745.0 114650.0 122555.0 130460.0 138365.0 146270.0 154175.0 162080.0 169985.0 177890.0 185795.0 193700.0 201605.0 209510.0 217415.0 225320.0 233225.0 241130.0 249035.0
# CHECK: 4236.0 12653.0 21070.0 29487.0 37904.0 46321.0 54738.0 63155.0 71572.0 79989.0 88406.0 96823.0 105240.0 113657.0 122074.0 130491.0 138908.0 147325.0 155742.0 164159.0 172576.0 180993.0 189410.0 197827.0 206244.0 214661.0 223078.0 231495.0 239912.0 248329.0 256746.0 265163.0
# CHECK: 4492.0 13421.0 22350.0 31279.0 40208.0 49137.0 58066.0 66995.0 75924.0 84853.0 93782.0 102711.0 111640.0 120569.0 129498.0 138427.0 147356.0 156285.0 165214.0 174143.0 183072.0 192001.0 200930.0 209859.0 218788.0 227717.0 236646.0 245575.0 254504.0 263433.0 272362.0 281291.0
# CHECK: 4748.0 14189.0 23630.0 33071.0 42512.0 51953.0 61394.0 70835.0 80276.0 89717.0 99158.0 108599.0 118040.0 127481.0 136922.0 146363.0 155804.0 165245.0 174686.0 184127.0 193568.0 203009.0 212450.0 221891.0 231332.0 240773.0 250214.0 259655.0 269096.0 278537.0 287978.0 297419.0
# CHECK: 5004.0 14957.0 24910.0 34863.0 44816.0 54769.0 64722.0 74675.0 84628.0 94581.0 104534.0 114487.0 124440.0 134393.0 144346.0 154299.0 164252.0 174205.0 184158.0 194111.0 204064.0 214017.0 223970.0 233923.0 243876.0 253829.0 263782.0 273735.0 283688.0 293641.0 303594.0 313547.0
# CHECK: 5260.0 15725.0 26190.0 36655.0 47120.0 57585.0 68050.0 78515.0 88980.0 99445.0 109910.0 120375.0 130840.0 141305.0 151770.0 162235.0 172700.0 183165.0 193630.0 204095.0 214560.0 225025.0 235490.0 245955.0 256420.0 266885.0 277350.0 287815.0 298280.0 308745.0 319210.0 329675.0
# CHECK: 5516.0 16493.0 27470.0 38447.0 49424.0 60401.0 71378.0 82355.0 93332.0 104309.0 115286.0 126263.0 137240.0 148217.0 159194.0 170171.0 181148.0 192125.0 203102.0 214079.0 225056.0 236033.0 247010.0 257987.0 268964.0 279941.0 290918.0 301895.0 312872.0 323849.0 334826.0 345803.0
# CHECK: 5772.0 17261.0 28750.0 40239.0 51728.0 63217.0 74706.0 86195.0 97684.0 109173.0 120662.0 132151.0 143640.0 155129.0 166618.0 178107.0 189596.0 201085.0 212574.0 224063.0 235552.0 247041.0 258530.0 270019.0 281508.0 292997.0 304486.0 315975.0 327464.0 338953.0 350442.0 361931.0
# CHECK: 6028.0 18029.0 30030.0 42031.0 54032.0 66033.0 78034.0 90035.0 102036.0 114037.0 126038.0 138039.0 150040.0 162041.0 174042.0 186043.0 198044.0 210045.0 222046.0 234047.0 246048.0 258049.0 270050.0 282051.0 294052.0 306053.0 318054.0 330055.0 342056.0 354057.0 366058.0 378059.0
# CHECK: 6284.0 18797.0 31310.0 43823.0 56336.0 68849.0 81362.0 93875.0 106388.0 118901.0 131414.0 143927.0 156440.0 168953.0 181466.0 193979.0 206492.0 219005.0 231518.0 244031.0 256544.0 269057.0 281570.0 294083.0 306596.0 319109.0 331622.0 344135.0 356648.0 369161.0 381674.0 394187.0
# CHECK: 6540.0 19565.0 32590.0 45615.0 58640.0 71665.0 84690.0 97715.0 110740.0 123765.0 136790.0 149815.0 162840.0 175865.0 188890.0 201915.0 214940.0 227965.0 240990.0 254015.0 267040.0 280065.0 293090.0 306115.0 319140.0 332165.0 345190.0 358215.0 371240.0 384265.0 397290.0 410315.0
# CHECK: 6796.0 20333.0 33870.0 47407.0 60944.0 74481.0 88018.0 101555.0 115092.0 128629.0 142166.0 155703.0 169240.0 182777.0 196314.0 209851.0 223388.0 236925.0 250462.0 263999.0 277536.0 291073.0 304610.0 318147.0 331684.0 345221.0 358758.0 372295.0 385832.0 399369.0 412906.0 426443.0
# CHECK: 7052.0 21101.0 35150.0 49199.0 63248.0 77297.0 91346.0 105395.0 119444.0 133493.0 147542.0 161591.0 175640.0 189689.0 203738.0 217787.0 231836.0 245885.0 259934.0 273983.0 288032.0 302081.0 316130.0 330179.0 344228.0 358277.0 372326.0 386375.0 400424.0 414473.0 428522.0 442571.0
# CHECK: 7308.0 21869.0 36430.0 50991.0 65552.0 80113.0 94674.0 109235.0 123796.0 138357.0 152918.0 167479.0 182040.0 196601.0 211162.0 225723.0 240284.0 254845.0 269406.0 283967.0 298528.0 313089.0 327650.0 342211.0 356772.0 371333.0 385894.0 400455.0 415016.0 429577.0 444138.0 458699.0
# CHECK: 7564.0 22637.0 37710.0 52783.0 67856.0 82929.0 98002.0 113075.0 128148.0 143221.0 158294.0 173367.0 188440.0 203513.0 218586.0 233659.0 248732.0 263805.0 278878.0 293951.0 309024.0 324097.0 339170.0 354243.0 369316.0 384389.0 399462.0 414535.0 429608.0 444681.0 459754.0 474827.0
# CHECK: 7820.0 23405.0 38990.0 54575.0 70160.0 85745.0 101330.0 116915.0 132500.0 148085.0 163670.0 179255.0 194840.0 210425.0 226010.0 241595.0 257180.0 272765.0 288350.0 303935.0 319520.0 335105.0 350690.0 366275.0 381860.0 397445.0 413030.0 428615.0 444200.0 459785.0 475370.0 490955.0
# CHECK: 8076.0 24173.0 40270.0 56367.0 72464.0 88561.0 104658.0 120755.0 136852.0 152949.0 169046.0 185143.0 201240.0 217337.0 233434.0 249531.0 265628.0 281725.0 297822.0 313919.0 330016.0 346113.0 362210.0 378307.0 394404.0 410501.0 426598.0 442695.0 458792.0 474889.0 490986.0 507083.0


def test_load_and_mma_f32_f16_32x32x8_transpose(ctx: DeviceContext):
    print("== test_load_and_mma_f32_f16_32x32x8_transpose")
    test_load_and_mma_and_multiply_operands[
        DType.float32, DType.float16, Index(32, 32, 8), True
    ](ctx)


# CHECK-LABEL: == test_load_and_mma_f32_bf8_16x16x32
# CHECK-LABEL: == test_load_a
# CHECK: 0.0 0.09375 0.1875 0.3125 0.375 0.5 0.625 0.75 0.75 0.875 1.0 1.0 1.25 1.25 1.5 1.5 1.5 1.75 1.75 2.0 2.0 2.0 2.0 2.5 2.5 2.5 2.5 2.5 3.0 3.0 3.0 3.0 3.0 3.5 3.5 3.5 3.5 3.5 4.0 4.0 4.0 4.0 4.0 4.0 4.0 4.0 5.0 5.0 5.0 5.0 5.0 5.0 5.0 5.0 5.0 6.0 6.0 6.0 6.0 6.0 6.0 6.0 6.0 6.0
# CHECK-LABEL: == test_load_b
# CHECK: 0.0 0.1875 0.375 0.625 0.75 1.0 1.25 1.5 1.5 1.75 2.0 2.0 2.5 2.5 3.0 3.0 0.75 1.0 1.25 1.5 1.5 1.75 2.0 2.0 2.5 2.5 3.0 3.0 3.0 3.5 3.5 4.0 1.5 1.75 2.0 2.0 2.5 2.5 3.0 3.0 3.0 3.5 3.5 4.0 4.0 4.0 4.0 5.0 2.5 2.5 3.0 3.0 3.0 3.5 3.5 4.0 4.0 4.0 4.0 5.0 5.0 5.0 5.0 5.0
# CHECK-LABEL: == test_load_c
# CHECK: 0.0 16.0 32.0 48.0
# CHECK: 1.0 17.0 33.0 49.0
# CHECK: 2.0 18.0 34.0 50.0
# CHECK: 3.0 19.0 35.0 51.0
# CHECK: 4.0 20.0 36.0 52.0
# CHECK: 5.0 21.0 37.0 53.0
# CHECK: 6.0 22.0 38.0 54.0
# CHECK: 7.0 23.0 39.0 55.0
# CHECK: 8.0 24.0 40.0 56.0
# CHECK: 9.0 25.0 41.0 57.0
# CHECK: 10.0 26.0 42.0 58.0
# CHECK: 11.0 27.0 43.0 59.0
# CHECK: 12.0 28.0 44.0 60.0
# CHECK: 13.0 29.0 45.0 61.0
# CHECK: 14.0 30.0 46.0 62.0
# CHECK: 15.0 31.0 47.0 63.0
# CHECK: 64.0 80.0 96.0 112.0
# CHECK: 65.0 81.0 97.0 113.0
# CHECK: 66.0 82.0 98.0 114.0
# CHECK: 67.0 83.0 99.0 115.0
# CHECK: 68.0 84.0 100.0 116.0
# CHECK: 69.0 85.0 101.0 117.0
# CHECK: 70.0 86.0 102.0 118.0
# CHECK: 71.0 87.0 103.0 119.0
# CHECK: 72.0 88.0 104.0 120.0
# CHECK: 73.0 89.0 105.0 121.0
# CHECK: 74.0 90.0 106.0 122.0
# CHECK: 75.0 91.0 107.0 123.0
# CHECK: 76.0 92.0 108.0 124.0
# CHECK: 77.0 93.0 109.0 125.0
# CHECK: 78.0 94.0 110.0 126.0
# CHECK: 79.0 95.0 111.0 127.0
# CHECK: 128.0 144.0 160.0 176.0
# CHECK: 129.0 145.0 161.0 177.0
# CHECK: 130.0 146.0 162.0 178.0
# CHECK: 131.0 147.0 163.0 179.0
# CHECK: 132.0 148.0 164.0 180.0
# CHECK: 133.0 149.0 165.0 181.0
# CHECK: 134.0 150.0 166.0 182.0
# CHECK: 135.0 151.0 167.0 183.0
# CHECK: 136.0 152.0 168.0 184.0
# CHECK: 137.0 153.0 169.0 185.0
# CHECK: 138.0 154.0 170.0 186.0
# CHECK: 139.0 155.0 171.0 187.0
# CHECK: 140.0 156.0 172.0 188.0
# CHECK: 141.0 157.0 173.0 189.0
# CHECK: 142.0 158.0 174.0 190.0
# CHECK: 143.0 159.0 175.0 191.0
# CHECK: 192.0 208.0 224.0 240.0
# CHECK: 193.0 209.0 225.0 241.0
# CHECK: 194.0 210.0 226.0 242.0
# CHECK: 195.0 211.0 227.0 243.0
# CHECK: 196.0 212.0 228.0 244.0
# CHECK: 197.0 213.0 229.0 245.0
# CHECK: 198.0 214.0 230.0 246.0
# CHECK: 199.0 215.0 231.0 247.0
# CHECK: 200.0 216.0 232.0 248.0
# CHECK: 201.0 217.0 233.0 249.0
# CHECK: 202.0 218.0 234.0 250.0
# CHECK: 203.0 219.0 235.0 251.0
# CHECK: 204.0 220.0 236.0 252.0
# CHECK: 205.0 221.0 237.0 253.0
# CHECK: 206.0 222.0 238.0 254.0
# CHECK: 207.0 223.0 239.0 255.0
# CHECK-LABEL: == test_load_d
# CHECK: 0.0 1.0 2.0 3.0 4.0 5.0 6.0 7.0 8.0 9.0 10.0 11.0 12.0 13.0 14.0 15.0
# CHECK: 0.0 1.0 2.0 3.0 4.0 5.0 6.0 7.0 8.0 9.0 10.0 11.0 12.0 13.0 14.0 15.0
# CHECK: 0.0 1.0 2.0 3.0 4.0 5.0 6.0 7.0 8.0 9.0 10.0 11.0 12.0 13.0 14.0 15.0
# CHECK: 0.0 1.0 2.0 3.0 4.0 5.0 6.0 7.0 8.0 9.0 10.0 11.0 12.0 13.0 14.0 15.0
# CHECK: 16.0 17.0 18.0 19.0 20.0 21.0 22.0 23.0 24.0 25.0 26.0 27.0 28.0 29.0 30.0 31.0
# CHECK: 16.0 17.0 18.0 19.0 20.0 21.0 22.0 23.0 24.0 25.0 26.0 27.0 28.0 29.0 30.0 31.0
# CHECK: 16.0 17.0 18.0 19.0 20.0 21.0 22.0 23.0 24.0 25.0 26.0 27.0 28.0 29.0 30.0 31.0
# CHECK: 16.0 17.0 18.0 19.0 20.0 21.0 22.0 23.0 24.0 25.0 26.0 27.0 28.0 29.0 30.0 31.0
# CHECK: 32.0 33.0 34.0 35.0 36.0 37.0 38.0 39.0 40.0 41.0 42.0 43.0 44.0 45.0 46.0 47.0
# CHECK: 32.0 33.0 34.0 35.0 36.0 37.0 38.0 39.0 40.0 41.0 42.0 43.0 44.0 45.0 46.0 47.0
# CHECK: 32.0 33.0 34.0 35.0 36.0 37.0 38.0 39.0 40.0 41.0 42.0 43.0 44.0 45.0 46.0 47.0
# CHECK: 32.0 33.0 34.0 35.0 36.0 37.0 38.0 39.0 40.0 41.0 42.0 43.0 44.0 45.0 46.0 47.0
# CHECK: 48.0 49.0 50.0 51.0 52.0 53.0 54.0 55.0 56.0 57.0 58.0 59.0 60.0 61.0 62.0 63.0
# CHECK: 48.0 49.0 50.0 51.0 52.0 53.0 54.0 55.0 56.0 57.0 58.0 59.0 60.0 61.0 62.0 63.0
# CHECK: 48.0 49.0 50.0 51.0 52.0 53.0 54.0 55.0 56.0 57.0 58.0 59.0 60.0 61.0 62.0 63.0
# CHECK: 48.0 49.0 50.0 51.0 52.0 53.0 54.0 55.0 56.0 57.0 58.0 59.0 60.0 61.0 62.0 63.0
# CHECK-LABEL: == test_mma
# CHECK: 208.12695 228.23047 249.92187 268.90625 291.28906 312.1875 329.29687 345.125 370.60938 393.875 413.6875 431.84375 453.59375 479.09375 501.8125 521.625
# CHECK: 228.4043 249.47461 271.66016 291.51172 314.4375 335.59375 353.8828 369.95312 395.6875 419.53906 440.75 459.53125 481.51563 507.26563 531.34375 552.03125
# CHECK: 248.26172 270.26172 292.7422 313.64844 336.78125 358.59375 377.57813 393.84375 420.65625 444.82813 466.625 485.625 508.84375 534.90625 559.8125 580.5625
# CHECK: 268.46094 291.40234 314.33594 335.46094 359.60938 381.78125 401.51563 418.375 445.53125 470.29687 493.3125 512.5625 536.34375 562.78125 588.0625 610.0
# CHECK: 291.23047 315.60937 338.67188 360.32813 385.76563 408.125 429.0 446.0625 474.84375 500.28125 523.5 543.3125 568.375 596.125 621.625 644.25
# CHECK: 311.29688 335.875 359.85938 381.96875 408.21875 431.09375 452.1875 470.375 499.34375 525.0 548.75 569.9375 595.5625 623.5 649.25 673.125
# CHECK: 333.7422 358.72656 384.10937 406.48438 434.25 457.3125 479.03125 497.875 528.0 554.71875 578.75 600.5 626.3125 656.4375 682.5 707.125
# CHECK: 353.53516 378.91406 405.1875 427.96875 455.89062 479.9375 501.96875 521.5 552.15625 579.1875 603.75 626.6875 652.6875 683.3125 709.75 734.625
# CHECK: 375.92188 401.67188 429.34375 452.21875 480.625 505.9375 528.125 548.75 579.5625 608.1875 633.375 656.5 683.0 714.875 742.625 767.625
# CHECK: 395.64063 421.72656 449.54687 473.29688 502.09375 528.1875 550.84375 571.625 603.5 632.28125 657.625 681.25 709.0625 741.4375 769.375 794.5
# CHECK: 417.64844 444.17187 472.375 497.5 526.53125 554.125 576.9375 598.3125 630.8125 660.75 687.125 711.0 739.375 771.875 802.0 827.375
# CHECK: 436.6328 463.95313 492.5 518.46875 547.84375 575.5625 599.3125 620.9375 654.0625 684.5 711.125 735.5 765.0 797.625 828.25 853.875
# CHECK: 457.90625 486.32812 515.21875 542.5625 572.0 600.1875 625.1875 646.9375 681.125 711.6875 739.875 764.875 794.5 827.625 859.5 886.375
# CHECK: 479.78125 509.54687 538.75 566.21875 597.0 625.5625 651.3125 673.5 708.8125 740.4375 768.75 793.875 825.0 859.375 891.75 918.75
# CHECK: 500.78125 531.53125 561.09375 588.875 620.9375 649.6875 676.875 699.125 734.9375 767.125 796.5 822.625 853.875 888.75 921.25 950.25
# CHECK: 522.47656 553.5156 584.375 612.5 645.90625 675.0 702.3125 725.5 762.5625 795.375 825.25 851.625 883.375 920.375 953.0 982.5


def test_load_and_mma_f32_bf8_16x16x32(ctx: DeviceContext):
    print("== test_load_and_mma_f32_bf8_16x16x32")
    test_load_and_mma_and_multiply_operands[
        DType.float32, bf8_dtype, Index(16, 16, 32), False
    ](ctx)


# CHECK-LABEL: == test_load_and_mma_f32_bf8_16x16x32_transpose
# CHECK-LABEL: == test_load_a
# CHECK: 0.0 0.09375 0.1875 0.3125 0.375 0.5 0.625 0.75 0.75 0.875 1.0 1.0 1.25 1.25 1.5 1.5 1.5 1.75 1.75 2.0 2.0 2.0 2.0 2.5 2.5 2.5 2.5 2.5 3.0 3.0 3.0 3.0 3.0 3.5 3.5 3.5 3.5 3.5 4.0 4.0 4.0 4.0 4.0 4.0 4.0 4.0 5.0 5.0 5.0 5.0 5.0 5.0 5.0 5.0 5.0 6.0 6.0 6.0 6.0 6.0 6.0 6.0 6.0 6.0
# CHECK-LABEL: == test_load_b
# CHECK: 0.0 0.09375 0.1875 0.3125 0.375 0.5 0.625 0.75 0.75 0.875 1.0 1.0 1.25 1.25 1.5 1.5 1.5 1.75 1.75 2.0 2.0 2.0 2.0 2.5 2.5 2.5 2.5 2.5 3.0 3.0 3.0 3.0 3.0 3.5 3.5 3.5 3.5 3.5 4.0 4.0 4.0 4.0 4.0 4.0 4.0 4.0 5.0 5.0 5.0 5.0 5.0 5.0 5.0 5.0 5.0 6.0 6.0 6.0 6.0 6.0 6.0 6.0 6.0 6.0
# CHECK-LABEL: == test_load_c
# CHECK: 0.0 16.0 32.0 48.0
# CHECK: 1.0 17.0 33.0 49.0
# CHECK: 2.0 18.0 34.0 50.0
# CHECK: 3.0 19.0 35.0 51.0
# CHECK: 4.0 20.0 36.0 52.0
# CHECK: 5.0 21.0 37.0 53.0
# CHECK: 6.0 22.0 38.0 54.0
# CHECK: 7.0 23.0 39.0 55.0
# CHECK: 8.0 24.0 40.0 56.0
# CHECK: 9.0 25.0 41.0 57.0
# CHECK: 10.0 26.0 42.0 58.0
# CHECK: 11.0 27.0 43.0 59.0
# CHECK: 12.0 28.0 44.0 60.0
# CHECK: 13.0 29.0 45.0 61.0
# CHECK: 14.0 30.0 46.0 62.0
# CHECK: 15.0 31.0 47.0 63.0
# CHECK: 64.0 80.0 96.0 112.0
# CHECK: 65.0 81.0 97.0 113.0
# CHECK: 66.0 82.0 98.0 114.0
# CHECK: 67.0 83.0 99.0 115.0
# CHECK: 68.0 84.0 100.0 116.0
# CHECK: 69.0 85.0 101.0 117.0
# CHECK: 70.0 86.0 102.0 118.0
# CHECK: 71.0 87.0 103.0 119.0
# CHECK: 72.0 88.0 104.0 120.0
# CHECK: 73.0 89.0 105.0 121.0
# CHECK: 74.0 90.0 106.0 122.0
# CHECK: 75.0 91.0 107.0 123.0
# CHECK: 76.0 92.0 108.0 124.0
# CHECK: 77.0 93.0 109.0 125.0
# CHECK: 78.0 94.0 110.0 126.0
# CHECK: 79.0 95.0 111.0 127.0
# CHECK: 128.0 144.0 160.0 176.0
# CHECK: 129.0 145.0 161.0 177.0
# CHECK: 130.0 146.0 162.0 178.0
# CHECK: 131.0 147.0 163.0 179.0
# CHECK: 132.0 148.0 164.0 180.0
# CHECK: 133.0 149.0 165.0 181.0
# CHECK: 134.0 150.0 166.0 182.0
# CHECK: 135.0 151.0 167.0 183.0
# CHECK: 136.0 152.0 168.0 184.0
# CHECK: 137.0 153.0 169.0 185.0
# CHECK: 138.0 154.0 170.0 186.0
# CHECK: 139.0 155.0 171.0 187.0
# CHECK: 140.0 156.0 172.0 188.0
# CHECK: 141.0 157.0 173.0 189.0
# CHECK: 142.0 158.0 174.0 190.0
# CHECK: 143.0 159.0 175.0 191.0
# CHECK: 192.0 208.0 224.0 240.0
# CHECK: 193.0 209.0 225.0 241.0
# CHECK: 194.0 210.0 226.0 242.0
# CHECK: 195.0 211.0 227.0 243.0
# CHECK: 196.0 212.0 228.0 244.0
# CHECK: 197.0 213.0 229.0 245.0
# CHECK: 198.0 214.0 230.0 246.0
# CHECK: 199.0 215.0 231.0 247.0
# CHECK: 200.0 216.0 232.0 248.0
# CHECK: 201.0 217.0 233.0 249.0
# CHECK: 202.0 218.0 234.0 250.0
# CHECK: 203.0 219.0 235.0 251.0
# CHECK: 204.0 220.0 236.0 252.0
# CHECK: 205.0 221.0 237.0 253.0
# CHECK: 206.0 222.0 238.0 254.0
# CHECK: 207.0 223.0 239.0 255.0
# CHECK-LABEL: == test_load_d
# CHECK: 0.0 1.0 2.0 3.0 4.0 5.0 6.0 7.0 8.0 9.0 10.0 11.0 12.0 13.0 14.0 15.0
# CHECK: 0.0 1.0 2.0 3.0 4.0 5.0 6.0 7.0 8.0 9.0 10.0 11.0 12.0 13.0 14.0 15.0
# CHECK: 0.0 1.0 2.0 3.0 4.0 5.0 6.0 7.0 8.0 9.0 10.0 11.0 12.0 13.0 14.0 15.0
# CHECK: 0.0 1.0 2.0 3.0 4.0 5.0 6.0 7.0 8.0 9.0 10.0 11.0 12.0 13.0 14.0 15.0
# CHECK: 16.0 17.0 18.0 19.0 20.0 21.0 22.0 23.0 24.0 25.0 26.0 27.0 28.0 29.0 30.0 31.0
# CHECK: 16.0 17.0 18.0 19.0 20.0 21.0 22.0 23.0 24.0 25.0 26.0 27.0 28.0 29.0 30.0 31.0
# CHECK: 16.0 17.0 18.0 19.0 20.0 21.0 22.0 23.0 24.0 25.0 26.0 27.0 28.0 29.0 30.0 31.0
# CHECK: 16.0 17.0 18.0 19.0 20.0 21.0 22.0 23.0 24.0 25.0 26.0 27.0 28.0 29.0 30.0 31.0
# CHECK: 32.0 33.0 34.0 35.0 36.0 37.0 38.0 39.0 40.0 41.0 42.0 43.0 44.0 45.0 46.0 47.0
# CHECK: 32.0 33.0 34.0 35.0 36.0 37.0 38.0 39.0 40.0 41.0 42.0 43.0 44.0 45.0 46.0 47.0
# CHECK: 32.0 33.0 34.0 35.0 36.0 37.0 38.0 39.0 40.0 41.0 42.0 43.0 44.0 45.0 46.0 47.0
# CHECK: 32.0 33.0 34.0 35.0 36.0 37.0 38.0 39.0 40.0 41.0 42.0 43.0 44.0 45.0 46.0 47.0
# CHECK: 48.0 49.0 50.0 51.0 52.0 53.0 54.0 55.0 56.0 57.0 58.0 59.0 60.0 61.0 62.0 63.0
# CHECK: 48.0 49.0 50.0 51.0 52.0 53.0 54.0 55.0 56.0 57.0 58.0 59.0 60.0 61.0 62.0 63.0
# CHECK: 48.0 49.0 50.0 51.0 52.0 53.0 54.0 55.0 56.0 57.0 58.0 59.0 60.0 61.0 62.0 63.0
# CHECK: 48.0 49.0 50.0 51.0 52.0 53.0 54.0 55.0 56.0 57.0 58.0 59.0 60.0 61.0 62.0 63.0
# CHECK-LABEL: == test_mma
# CHECK: 416.2539 425.8086 434.52344 443.92187 458.46094 467.59375 481.48437 490.0703 503.84375 512.28125 525.2969 532.2656 543.8125 556.5625 567.5625 579.9531
# CHECK: 440.8086 452.05957 460.82227 470.3418 484.94922 494.25 508.73047 517.46875 531.3203 539.8008 553.0156 560.2969 573.02344 585.83594 597.3594 610.0
# CHECK: 464.52344 475.82227 486.2539 495.8086 510.52344 519.9219 534.46094 543.59375 557.4844 566.0703 579.84375 588.28125 601.2969 614.2656 625.8125 638.5625
# CHECK: 488.92187 500.3418 510.8086 522.0508 536.8047 546.3125 560.91406 570.2031 584.6719 593.39844 607.25 615.71875 628.9219 642.2031 654.90625 667.71875
# CHECK: 518.46094 529.9492 540.52344 551.8047 569.21875 578.75 593.4531 602.8281 617.34375 626.4531 640.34375 648.90625 662.65625 678.09375 691.0625 704.03125
# CHECK: 542.59375 554.25 564.9219 576.3125 593.75 604.9531 619.6875 629.15625 643.71875 652.96875 667.4375 676.125 689.9375 705.40625 718.53125 731.8125
# CHECK: 571.4844 583.73047 594.46094 605.91406 623.4531 634.6875 652.0781 661.5625 676.21875 685.5469 700.0625 709.125 722.96875 738.53125 752.1875 767.625
# CHECK: 595.0703 607.46875 618.59375 630.2031 647.8281 659.15625 676.5625 687.7031 702.375 711.78125 726.34375 735.53125 749.9375 765.625 779.3125 794.78125
# CHECK: 623.84375 636.3203 647.4844 659.6719 677.34375 688.71875 706.21875 717.375 734.6875 744.09375 758.75 768.0 782.4375 798.5 812.1875 827.75
# CHECK: 647.28125 659.8008 671.0703 683.39844 701.4531 712.96875 730.5469 741.78125 759.09375 770.1406 784.8125 794.125 808.59375 824.78125 839.0 854.6875
# CHECK: 675.2969 688.0156 699.84375 712.25 730.34375 742.4375 760.0625 771.34375 788.75 799.8125 817.125 826.4375 841.0 857.25 871.5 887.5625
# CHECK: 697.2656 710.2969 723.28125 735.71875 753.90625 766.125 784.125 795.53125 813.0 824.125 841.4375 852.375 866.9375 883.25 897.5 913.6875
# CHECK: 723.8125 738.02344 751.2969 763.9219 782.65625 794.9375 812.96875 824.9375 842.4375 853.59375 871.0 881.9375 899.125 915.4375 929.75 946.0
# CHECK: 751.5625 765.83594 779.2656 792.2031 813.09375 825.40625 843.53125 855.625 873.5 884.78125 902.25 913.25 930.4375 949.375 963.6875 980.0
# CHECK: 777.5625 792.3594 805.8125 819.90625 841.0625 853.53125 872.1875 884.3125 902.1875 914.0 931.5 942.5 959.75 978.6875 995.5625 1011.875
# CHECK: 804.9531 820.0 833.5625 847.71875 869.03125 881.8125 902.625 914.78125 932.75 944.6875 962.5625 973.6875 991.0 1010.0 1026.875 1045.8125
def test_load_and_mma_f32_bf8_16x16x32_transpose(ctx: DeviceContext):
    print("== test_load_and_mma_f32_bf8_16x16x32_transpose")
    test_load_and_mma_and_multiply_operands[
        DType.float32, bf8_dtype, Index(16, 16, 32), True
    ](ctx)


# CHECK-LABEL: == test_load_and_mma_f32_bf8_16x16x32_transpose_k_group_size_2
# CHECK-LABEL: == test_load_a
# CHECK: 0.0 0.09375 0.1875 0.3125 0.375 0.5 0.625 0.75 0.75 0.875 1.0 1.0 1.25 1.25 1.5 1.5 3.0 3.5 3.5 3.5 3.5 3.5 4.0 4.0 4.0 4.0 4.0 4.0 4.0 4.0 5.0 5.0 6.0 6.0 7.0 7.0 7.0 7.0 7.0 7.0 7.0 7.0 7.0 8.0 8.0 8.0 8.0 8.0 10.0 10.0 10.0 10.0 10.0 10.0 10.0 10.0 10.0 10.0 10.0 10.0 10.0 10.0 12.0 12.0
# CHECK-LABEL: == test_load_b
# CHECK: 0.0 0.09375 0.1875 0.3125 0.375 0.5 0.625 0.75 0.75 0.875 1.0 1.0 1.25 1.25 1.5 1.5 3.0 3.5 3.5 3.5 3.5 3.5 4.0 4.0 4.0 4.0 4.0 4.0 4.0 4.0 5.0 5.0 6.0 6.0 7.0 7.0 7.0 7.0 7.0 7.0 7.0 7.0 7.0 8.0 8.0 8.0 8.0 8.0 10.0 10.0 10.0 10.0 10.0 10.0 10.0 10.0 10.0 10.0 10.0 10.0 10.0 10.0 12.0 12.0
# CHECK-LABEL: == test_load_c
# CHECK: 0.0 16.0 32.0 48.0
# CHECK: 1.0 17.0 33.0 49.0
# CHECK: 2.0 18.0 34.0 50.0
# CHECK: 3.0 19.0 35.0 51.0
# CHECK: 4.0 20.0 36.0 52.0
# CHECK: 5.0 21.0 37.0 53.0
# CHECK: 6.0 22.0 38.0 54.0
# CHECK: 7.0 23.0 39.0 55.0
# CHECK: 8.0 24.0 40.0 56.0
# CHECK: 9.0 25.0 41.0 57.0
# CHECK: 10.0 26.0 42.0 58.0
# CHECK: 11.0 27.0 43.0 59.0
# CHECK: 12.0 28.0 44.0 60.0
# CHECK: 13.0 29.0 45.0 61.0
# CHECK: 14.0 30.0 46.0 62.0
# CHECK: 15.0 31.0 47.0 63.0
# CHECK: 64.0 80.0 96.0 112.0
# CHECK: 65.0 81.0 97.0 113.0
# CHECK: 66.0 82.0 98.0 114.0
# CHECK: 67.0 83.0 99.0 115.0
# CHECK: 68.0 84.0 100.0 116.0
# CHECK: 69.0 85.0 101.0 117.0
# CHECK: 70.0 86.0 102.0 118.0
# CHECK: 71.0 87.0 103.0 119.0
# CHECK: 72.0 88.0 104.0 120.0
# CHECK: 73.0 89.0 105.0 121.0
# CHECK: 74.0 90.0 106.0 122.0
# CHECK: 75.0 91.0 107.0 123.0
# CHECK: 76.0 92.0 108.0 124.0
# CHECK: 77.0 93.0 109.0 125.0
# CHECK: 78.0 94.0 110.0 126.0
# CHECK: 79.0 95.0 111.0 127.0
# CHECK: 128.0 144.0 160.0 176.0
# CHECK: 129.0 145.0 161.0 177.0
# CHECK: 130.0 146.0 162.0 178.0
# CHECK: 131.0 147.0 163.0 179.0
# CHECK: 132.0 148.0 164.0 180.0
# CHECK: 133.0 149.0 165.0 181.0
# CHECK: 134.0 150.0 166.0 182.0
# CHECK: 135.0 151.0 167.0 183.0
# CHECK: 136.0 152.0 168.0 184.0
# CHECK: 137.0 153.0 169.0 185.0
# CHECK: 138.0 154.0 170.0 186.0
# CHECK: 139.0 155.0 171.0 187.0
# CHECK: 140.0 156.0 172.0 188.0
# CHECK: 141.0 157.0 173.0 189.0
# CHECK: 142.0 158.0 174.0 190.0
# CHECK: 143.0 159.0 175.0 191.0
# CHECK: 192.0 208.0 224.0 240.0
# CHECK: 193.0 209.0 225.0 241.0
# CHECK: 194.0 210.0 226.0 242.0
# CHECK: 195.0 211.0 227.0 243.0
# CHECK: 196.0 212.0 228.0 244.0
# CHECK: 197.0 213.0 229.0 245.0
# CHECK: 198.0 214.0 230.0 246.0
# CHECK: 199.0 215.0 231.0 247.0
# CHECK: 200.0 216.0 232.0 248.0
# CHECK: 201.0 217.0 233.0 249.0
# CHECK: 202.0 218.0 234.0 250.0
# CHECK: 203.0 219.0 235.0 251.0
# CHECK: 204.0 220.0 236.0 252.0
# CHECK: 205.0 221.0 237.0 253.0
# CHECK: 206.0 222.0 238.0 254.0
# CHECK: 207.0 223.0 239.0 255.0
# CHECK-LABEL: == test_load_d
# CHECK: 0.0 1.0 2.0 3.0 4.0 5.0 6.0 7.0 8.0 9.0 10.0 11.0 12.0 13.0 14.0 15.0
# CHECK: 0.0 1.0 2.0 3.0 4.0 5.0 6.0 7.0 8.0 9.0 10.0 11.0 12.0 13.0 14.0 15.0
# CHECK: 0.0 1.0 2.0 3.0 4.0 5.0 6.0 7.0 8.0 9.0 10.0 11.0 12.0 13.0 14.0 15.0
# CHECK: 0.0 1.0 2.0 3.0 4.0 5.0 6.0 7.0 8.0 9.0 10.0 11.0 12.0 13.0 14.0 15.0
# CHECK: 16.0 17.0 18.0 19.0 20.0 21.0 22.0 23.0 24.0 25.0 26.0 27.0 28.0 29.0 30.0 31.0
# CHECK: 16.0 17.0 18.0 19.0 20.0 21.0 22.0 23.0 24.0 25.0 26.0 27.0 28.0 29.0 30.0 31.0
# CHECK: 16.0 17.0 18.0 19.0 20.0 21.0 22.0 23.0 24.0 25.0 26.0 27.0 28.0 29.0 30.0 31.0
# CHECK: 16.0 17.0 18.0 19.0 20.0 21.0 22.0 23.0 24.0 25.0 26.0 27.0 28.0 29.0 30.0 31.0
# CHECK: 32.0 33.0 34.0 35.0 36.0 37.0 38.0 39.0 40.0 41.0 42.0 43.0 44.0 45.0 46.0 47.0
# CHECK: 32.0 33.0 34.0 35.0 36.0 37.0 38.0 39.0 40.0 41.0 42.0 43.0 44.0 45.0 46.0 47.0
# CHECK: 32.0 33.0 34.0 35.0 36.0 37.0 38.0 39.0 40.0 41.0 42.0 43.0 44.0 45.0 46.0 47.0
# CHECK: 32.0 33.0 34.0 35.0 36.0 37.0 38.0 39.0 40.0 41.0 42.0 43.0 44.0 45.0 46.0 47.0
# CHECK: 48.0 49.0 50.0 51.0 52.0 53.0 54.0 55.0 56.0 57.0 58.0 59.0 60.0 61.0 62.0 63.0
# CHECK: 48.0 49.0 50.0 51.0 52.0 53.0 54.0 55.0 56.0 57.0 58.0 59.0 60.0 61.0 62.0 63.0
# CHECK: 48.0 49.0 50.0 51.0 52.0 53.0 54.0 55.0 56.0 57.0 58.0 59.0 60.0 61.0 62.0 63.0
# CHECK: 48.0 49.0 50.0 51.0 52.0 53.0 54.0 55.0 56.0 57.0 58.0 59.0 60.0 61.0 62.0 63.0
# CHECK-LABEL: == test_mma
# CHECK: 3405.254 3437.8086 3472.5234 3504.9219 3539.461 3595.5937 3629.4844 3685.0703 3718.8438 3774.2813 3807.2969 3860.2656 3891.8125 3944.5625 3975.5625 4027.9531
# CHECK: 3452.8086 3492.0596 3526.8223 3559.3418 3593.9492 3650.25 3684.7305 3740.4687 3774.3203 3829.8008 3863.0156 3916.2969 3949.0234 4001.836 4033.3594 4086.0
# CHECK: 3502.5234 3541.8223 3583.254 3615.8086 3650.5234 3706.9219 3741.461 3797.5937 3831.4844 3887.0703 3920.8438 3976.2813 4009.2969 4062.2656 4093.8125 4146.5625
# CHECK: 3549.9219 3589.3418 3630.8086 3670.0508 3704.8047 3761.3125 3795.914 3852.2031 3886.6719 3942.3984 3976.25 4031.7188 4064.9219 4118.203 4150.9062 4203.7188
# CHECK: 3599.461 3638.9492 3680.5234 3719.8047 3761.2187 3817.75 3852.453 3908.828 3943.3437 3999.4531 4033.3438 4088.9063 4122.6562 4178.0937 4211.0625 4264.0313
# CHECK: 3670.5938 3710.25 3751.9219 3791.3125 3832.75 3899.953 3934.6875 3991.1562 4025.7187 4081.9687 4116.4375 4172.125 4205.9375 4261.4063 4294.5312 4347.8125
# CHECK: 3719.4844 3759.7305 3801.461 3840.914 3882.453 3949.6875 3991.078 4047.5625 4082.2187 4138.547 4173.0625 4229.125 4262.9688 4318.5313 4352.1875 4407.625
# CHECK: 3790.0703 3830.4688 3872.5938 3912.2031 3953.828 4021.1562 4062.5625 4129.703 4164.375 4220.7812 4255.3438 4311.5313 4345.9375 4401.625 4435.3125 4490.7812
# CHECK: 3838.8437 3879.3203 3921.4844 3961.6719 4003.3438 4070.7188 4112.2187 4179.375 4220.6875 4277.0937 4311.75 4368.0 4402.4375 4458.5 4492.1875 4547.75
# CHECK: 3909.2812 3949.8008 3992.0703 4032.3984 4074.453 4141.9688 4183.547 4250.7812 4292.0937 4359.1406 4393.8125 4450.125 4484.5937 4540.7812 4575.0 4630.6875
# CHECK: 3957.2969 3998.0156 4040.8437 4081.25 4123.3437 4191.4375 4233.0625 4300.3438 4341.75 4408.8125 4450.125 4506.4375 4541.0 4597.25 4631.5 4687.5625
# CHECK: 4025.2656 4066.2969 4111.2812 4151.7187 4193.9062 4262.125 4304.125 4371.5313 4413.0 4480.125 4521.4375 4588.375 4622.9375 4679.25 4713.5 4769.6875
# CHECK: 4071.8125 4114.0234 4159.297 4199.922 4242.6563 4310.9375 4352.9687 4420.9375 4462.4375 4529.5937 4571.0 4637.9375 4679.125 4735.4375 4769.75 4826.0
# CHECK: 4139.5625 4181.836 4227.2656 4268.203 4313.0938 4381.4062 4423.5312 4491.625 4533.5 4600.7812 4642.25 4709.25 4750.4375 4817.375 4851.6875 4908.0
# CHECK: 4185.5625 4228.3594 4273.8125 4315.9062 4361.0625 4429.5313 4472.1875 4540.3125 4582.1875 4650.0 4691.5 4758.5 4799.75 4866.6875 4907.5625 4963.875
# CHECK: 4252.953 4296.0 4341.5625 4383.7187 4429.0312 4497.8125 4542.625 4610.7813 4652.75 4720.6875 4762.5625 4829.6875 4871.0 4938.0 4978.875 5045.8125


def test_load_and_mma_f32_bf8_16x16x32_transpose_k_group_size_2(
    ctx: DeviceContext,
):
    print("== test_load_and_mma_f32_bf8_16x16x32_transpose_k_group_size_2")
    test_load_and_mma_and_multiply_operands[
        DType.float32, bf8_dtype, Index(16, 16, 32), True, 2
    ](ctx)


def main():
    with DeviceContext() as ctx:
        test_load_and_mma_f32_f32_16x16x4(ctx)
        test_load_and_mma_f32_f32_16x16x4_k_group_size_4(ctx)
        test_load_and_mma_f32_f32_16x16x4_transpose(ctx)
        test_load_and_mma_f32_f32_16x16x4_transpose_k_group_size_4(ctx)
        test_load_and_mma_f32_bf16_16x16x16(ctx)
        test_load_and_mma_f32_bf16_16x16x16_k_group_size_4(ctx)
        test_load_and_mma_f32_bf16_16x16x16_transpose(ctx)
        test_load_and_mma_f32_bf16_16x16x16_transpose_k_group_size_4(ctx)
        test_load_and_mma_f32_f16_16x16x16(ctx)
        test_load_and_mma_f32_f16_16x16x16_transpose(ctx)
        test_load_and_mma_f32_bf16_32x32x8(ctx)
        test_load_and_mma_f32_bf16_32x32x8_transpose(ctx)
        test_load_and_mma_f32_f16_32x32x8(ctx)
        test_load_and_mma_f32_f16_32x32x8_transpose(ctx)

        test_load_and_mma_f32_bf8_16x16x32(ctx)
        test_load_and_mma_f32_bf8_16x16x32_transpose(ctx)
        test_load_and_mma_f32_bf8_16x16x32_transpose_k_group_size_2(ctx)
