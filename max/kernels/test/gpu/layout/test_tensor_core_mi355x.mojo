# ===----------------------------------------------------------------------=== #
# Copyright (c) 2025, Modular Inc. All rights reserved.
#
# Licensed under the Apache License v2.0 with LLVM Exceptions:
# https://llvm.org/LICENSE.txt
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
# ===----------------------------------------------------------------------=== #

from gpu import WARP_SIZE, lane_id
from gpu.host import DeviceContext
from gpu.host.info import MI300X, MI355X
from layout import Layout, LayoutTensor
from layout._fillers import arange
from layout.tensor_core import TensorCore
from test_tensor_core_amd_utils import test_load_and_mma_and_multiply_operands

from utils.index import Index, IndexList

alias fp8_dtype = DType.float8_e4m3fn
alias bf8_dtype = DType.float8_e5m2

# CHECK-LABEL: test_load_and_mma_f32_bf16_32x32x16
# CHECK-LABEL: test_load_a
# CHECK: 0.0 16.0 32.0 48.0 64.0 80.0 96.0 112.0 128.0 144.0 160.0 176.0 192.0 208.0 224.0 240.0 256.0 272.0 288.0 304.0 320.0 336.0 352.0 368.0 384.0 400.0 416.0 432.0 448.0 464.0 480.0 496.0 8.0 24.0 40.0 56.0 72.0 88.0 104.0 120.0 136.0 152.0 168.0 184.0 200.0 216.0 232.0 248.0 264.0 280.0 296.0 312.0 328.0 344.0 360.0 376.0 392.0 408.0 424.0 440.0 456.0 472.0 488.0 504.0
# CHECK-LABEL: test_load_b
# CHECK: 0.0 1.0 2.0 3.0 4.0 5.0 6.0 7.0 8.0 9.0 10.0 11.0 12.0 13.0 14.0 15.0 16.0 17.0 18.0 19.0 20.0 21.0 22.0 23.0 24.0 25.0 26.0 27.0 28.0 29.0 30.0 31.0 256.0 256.0 258.0 260.0 260.0 260.0 262.0 264.0 264.0 264.0 266.0 268.0 268.0 268.0 270.0 272.0 272.0 272.0 274.0 276.0 276.0 276.0 278.0 280.0 280.0 280.0 282.0 284.0 284.0 284.0 286.0 288.0
# CHECK-LABEL: test_load_c
# CHECK: 0.0 32.0 64.0 96.0
# CHECK: 1.0 33.0 65.0 97.0
# CHECK: 2.0 34.0 66.0 98.0
# CHECK: 3.0 35.0 67.0 99.0
# CHECK: 4.0 36.0 68.0 100.0
# CHECK: 5.0 37.0 69.0 101.0
# CHECK: 6.0 38.0 70.0 102.0
# CHECK: 7.0 39.0 71.0 103.0
# CHECK: 8.0 40.0 72.0 104.0
# CHECK: 9.0 41.0 73.0 105.0
# CHECK: 10.0 42.0 74.0 106.0
# CHECK: 11.0 43.0 75.0 107.0
# CHECK: 12.0 44.0 76.0 108.0
# CHECK: 13.0 45.0 77.0 109.0
# CHECK: 14.0 46.0 78.0 110.0
# CHECK: 15.0 47.0 79.0 111.0
# CHECK: 16.0 48.0 80.0 112.0
# CHECK: 17.0 49.0 81.0 113.0
# CHECK: 18.0 50.0 82.0 114.0
# CHECK: 19.0 51.0 83.0 115.0
# CHECK: 20.0 52.0 84.0 116.0
# CHECK: 21.0 53.0 85.0 117.0
# CHECK: 22.0 54.0 86.0 118.0
# CHECK: 23.0 55.0 87.0 119.0
# CHECK: 24.0 56.0 88.0 120.0
# CHECK: 25.0 57.0 89.0 121.0
# CHECK: 26.0 58.0 90.0 122.0
# CHECK: 27.0 59.0 91.0 123.0
# CHECK: 28.0 60.0 92.0 124.0
# CHECK: 29.0 61.0 93.0 125.0
# CHECK: 30.0 62.0 94.0 126.0
# CHECK: 31.0 63.0 95.0 127.0
# CHECK: 128.0 160.0 192.0 224.0
# CHECK: 129.0 161.0 193.0 225.0
# CHECK: 130.0 162.0 194.0 226.0
# CHECK: 131.0 163.0 195.0 227.0
# CHECK: 132.0 164.0 196.0 228.0
# CHECK: 133.0 165.0 197.0 229.0
# CHECK: 134.0 166.0 198.0 230.0
# CHECK: 135.0 167.0 199.0 231.0
# CHECK: 136.0 168.0 200.0 232.0
# CHECK: 137.0 169.0 201.0 233.0
# CHECK: 138.0 170.0 202.0 234.0
# CHECK: 139.0 171.0 203.0 235.0
# CHECK: 140.0 172.0 204.0 236.0
# CHECK: 141.0 173.0 205.0 237.0
# CHECK: 142.0 174.0 206.0 238.0
# CHECK: 143.0 175.0 207.0 239.0
# CHECK: 144.0 176.0 208.0 240.0
# CHECK: 145.0 177.0 209.0 241.0
# CHECK: 146.0 178.0 210.0 242.0
# CHECK: 147.0 179.0 211.0 243.0
# CHECK: 148.0 180.0 212.0 244.0
# CHECK: 149.0 181.0 213.0 245.0
# CHECK: 150.0 182.0 214.0 246.0
# CHECK: 151.0 183.0 215.0 247.0
# CHECK: 152.0 184.0 216.0 248.0
# CHECK: 153.0 185.0 217.0 249.0
# CHECK: 154.0 186.0 218.0 250.0
# CHECK: 155.0 187.0 219.0 251.0
# CHECK: 156.0 188.0 220.0 252.0
# CHECK: 157.0 189.0 221.0 253.0
# CHECK: 158.0 190.0 222.0 254.0
# CHECK: 159.0 191.0 223.0 255.0
# CHECK-LABEL: test_load_d
# CHECK: 0.0 1.0 2.0 3.0 4.0 5.0 6.0 7.0 8.0 9.0 10.0 11.0 12.0 13.0 14.0 15.0 16.0 17.0 18.0 19.0 20.0 21.0 22.0 23.0 24.0 25.0 26.0 27.0 28.0 29.0 30.0 31.0
# CHECK: 0.0 1.0 2.0 3.0 4.0 5.0 6.0 7.0 8.0 9.0 10.0 11.0 12.0 13.0 14.0 15.0 16.0 17.0 18.0 19.0 20.0 21.0 22.0 23.0 24.0 25.0 26.0 27.0 28.0 29.0 30.0 31.0
# CHECK: 0.0 1.0 2.0 3.0 4.0 5.0 6.0 7.0 8.0 9.0 10.0 11.0 12.0 13.0 14.0 15.0 16.0 17.0 18.0 19.0 20.0 21.0 22.0 23.0 24.0 25.0 26.0 27.0 28.0 29.0 30.0 31.0
# CHECK: 0.0 1.0 2.0 3.0 4.0 5.0 6.0 7.0 8.0 9.0 10.0 11.0 12.0 13.0 14.0 15.0 16.0 17.0 18.0 19.0 20.0 21.0 22.0 23.0 24.0 25.0 26.0 27.0 28.0 29.0 30.0 31.0
# CHECK: 32.0 33.0 34.0 35.0 36.0 37.0 38.0 39.0 40.0 41.0 42.0 43.0 44.0 45.0 46.0 47.0 48.0 49.0 50.0 51.0 52.0 53.0 54.0 55.0 56.0 57.0 58.0 59.0 60.0 61.0 62.0 63.0
# CHECK: 32.0 33.0 34.0 35.0 36.0 37.0 38.0 39.0 40.0 41.0 42.0 43.0 44.0 45.0 46.0 47.0 48.0 49.0 50.0 51.0 52.0 53.0 54.0 55.0 56.0 57.0 58.0 59.0 60.0 61.0 62.0 63.0
# CHECK: 32.0 33.0 34.0 35.0 36.0 37.0 38.0 39.0 40.0 41.0 42.0 43.0 44.0 45.0 46.0 47.0 48.0 49.0 50.0 51.0 52.0 53.0 54.0 55.0 56.0 57.0 58.0 59.0 60.0 61.0 62.0 63.0
# CHECK: 32.0 33.0 34.0 35.0 36.0 37.0 38.0 39.0 40.0 41.0 42.0 43.0 44.0 45.0 46.0 47.0 48.0 49.0 50.0 51.0 52.0 53.0 54.0 55.0 56.0 57.0 58.0 59.0 60.0 61.0 62.0 63.0
# CHECK: 0.0 1.0 2.0 3.0 4.0 5.0 6.0 7.0 8.0 9.0 10.0 11.0 12.0 13.0 14.0 15.0 16.0 17.0 18.0 19.0 20.0 21.0 22.0 23.0 24.0 25.0 26.0 27.0 28.0 29.0 30.0 31.0
# CHECK: 0.0 1.0 2.0 3.0 4.0 5.0 6.0 7.0 8.0 9.0 10.0 11.0 12.0 13.0 14.0 15.0 16.0 17.0 18.0 19.0 20.0 21.0 22.0 23.0 24.0 25.0 26.0 27.0 28.0 29.0 30.0 31.0
# CHECK: 0.0 1.0 2.0 3.0 4.0 5.0 6.0 7.0 8.0 9.0 10.0 11.0 12.0 13.0 14.0 15.0 16.0 17.0 18.0 19.0 20.0 21.0 22.0 23.0 24.0 25.0 26.0 27.0 28.0 29.0 30.0 31.0
# CHECK: 0.0 1.0 2.0 3.0 4.0 5.0 6.0 7.0 8.0 9.0 10.0 11.0 12.0 13.0 14.0 15.0 16.0 17.0 18.0 19.0 20.0 21.0 22.0 23.0 24.0 25.0 26.0 27.0 28.0 29.0 30.0 31.0
# CHECK: 32.0 33.0 34.0 35.0 36.0 37.0 38.0 39.0 40.0 41.0 42.0 43.0 44.0 45.0 46.0 47.0 48.0 49.0 50.0 51.0 52.0 53.0 54.0 55.0 56.0 57.0 58.0 59.0 60.0 61.0 62.0 63.0
# CHECK: 32.0 33.0 34.0 35.0 36.0 37.0 38.0 39.0 40.0 41.0 42.0 43.0 44.0 45.0 46.0 47.0 48.0 49.0 50.0 51.0 52.0 53.0 54.0 55.0 56.0 57.0 58.0 59.0 60.0 61.0 62.0 63.0
# CHECK: 32.0 33.0 34.0 35.0 36.0 37.0 38.0 39.0 40.0 41.0 42.0 43.0 44.0 45.0 46.0 47.0 48.0 49.0 50.0 51.0 52.0 53.0 54.0 55.0 56.0 57.0 58.0 59.0 60.0 61.0 62.0 63.0
# CHECK: 32.0 33.0 34.0 35.0 36.0 37.0 38.0 39.0 40.0 41.0 42.0 43.0 44.0 45.0 46.0 47.0 48.0 49.0 50.0 51.0 52.0 53.0 54.0 55.0 56.0 57.0 58.0 59.0 60.0 61.0 62.0 63.0
# CHECK: 0.0 1.0 2.0 3.0 4.0 5.0 6.0 7.0 8.0 9.0 10.0 11.0 12.0 13.0 14.0 15.0 16.0 17.0 18.0 19.0 20.0 21.0 22.0 23.0 24.0 25.0 26.0 27.0 28.0 29.0 30.0 31.0
# CHECK: 0.0 1.0 2.0 3.0 4.0 5.0 6.0 7.0 8.0 9.0 10.0 11.0 12.0 13.0 14.0 15.0 16.0 17.0 18.0 19.0 20.0 21.0 22.0 23.0 24.0 25.0 26.0 27.0 28.0 29.0 30.0 31.0
# CHECK: 0.0 1.0 2.0 3.0 4.0 5.0 6.0 7.0 8.0 9.0 10.0 11.0 12.0 13.0 14.0 15.0 16.0 17.0 18.0 19.0 20.0 21.0 22.0 23.0 24.0 25.0 26.0 27.0 28.0 29.0 30.0 31.0
# CHECK: 0.0 1.0 2.0 3.0 4.0 5.0 6.0 7.0 8.0 9.0 10.0 11.0 12.0 13.0 14.0 15.0 16.0 17.0 18.0 19.0 20.0 21.0 22.0 23.0 24.0 25.0 26.0 27.0 28.0 29.0 30.0 31.0
# CHECK: 32.0 33.0 34.0 35.0 36.0 37.0 38.0 39.0 40.0 41.0 42.0 43.0 44.0 45.0 46.0 47.0 48.0 49.0 50.0 51.0 52.0 53.0 54.0 55.0 56.0 57.0 58.0 59.0 60.0 61.0 62.0 63.0
# CHECK: 32.0 33.0 34.0 35.0 36.0 37.0 38.0 39.0 40.0 41.0 42.0 43.0 44.0 45.0 46.0 47.0 48.0 49.0 50.0 51.0 52.0 53.0 54.0 55.0 56.0 57.0 58.0 59.0 60.0 61.0 62.0 63.0
# CHECK: 32.0 33.0 34.0 35.0 36.0 37.0 38.0 39.0 40.0 41.0 42.0 43.0 44.0 45.0 46.0 47.0 48.0 49.0 50.0 51.0 52.0 53.0 54.0 55.0 56.0 57.0 58.0 59.0 60.0 61.0 62.0 63.0
# CHECK: 32.0 33.0 34.0 35.0 36.0 37.0 38.0 39.0 40.0 41.0 42.0 43.0 44.0 45.0 46.0 47.0 48.0 49.0 50.0 51.0 52.0 53.0 54.0 55.0 56.0 57.0 58.0 59.0 60.0 61.0 62.0 63.0
# CHECK: 0.0 1.0 2.0 3.0 4.0 5.0 6.0 7.0 8.0 9.0 10.0 11.0 12.0 13.0 14.0 15.0 16.0 17.0 18.0 19.0 20.0 21.0 22.0 23.0 24.0 25.0 26.0 27.0 28.0 29.0 30.0 31.0
# CHECK: 0.0 1.0 2.0 3.0 4.0 5.0 6.0 7.0 8.0 9.0 10.0 11.0 12.0 13.0 14.0 15.0 16.0 17.0 18.0 19.0 20.0 21.0 22.0 23.0 24.0 25.0 26.0 27.0 28.0 29.0 30.0 31.0
# CHECK: 0.0 1.0 2.0 3.0 4.0 5.0 6.0 7.0 8.0 9.0 10.0 11.0 12.0 13.0 14.0 15.0 16.0 17.0 18.0 19.0 20.0 21.0 22.0 23.0 24.0 25.0 26.0 27.0 28.0 29.0 30.0 31.0
# CHECK: 0.0 1.0 2.0 3.0 4.0 5.0 6.0 7.0 8.0 9.0 10.0 11.0 12.0 13.0 14.0 15.0 16.0 17.0 18.0 19.0 20.0 21.0 22.0 23.0 24.0 25.0 26.0 27.0 28.0 29.0 30.0 31.0
# CHECK: 32.0 33.0 34.0 35.0 36.0 37.0 38.0 39.0 40.0 41.0 42.0 43.0 44.0 45.0 46.0 47.0 48.0 49.0 50.0 51.0 52.0 53.0 54.0 55.0 56.0 57.0 58.0 59.0 60.0 61.0 62.0 63.0
# CHECK: 32.0 33.0 34.0 35.0 36.0 37.0 38.0 39.0 40.0 41.0 42.0 43.0 44.0 45.0 46.0 47.0 48.0 49.0 50.0 51.0 52.0 53.0 54.0 55.0 56.0 57.0 58.0 59.0 60.0 61.0 62.0 63.0
# CHECK: 32.0 33.0 34.0 35.0 36.0 37.0 38.0 39.0 40.0 41.0 42.0 43.0 44.0 45.0 46.0 47.0 48.0 49.0 50.0 51.0 52.0 53.0 54.0 55.0 56.0 57.0 58.0 59.0 60.0 61.0 62.0 63.0
# CHECK: 32.0 33.0 34.0 35.0 36.0 37.0 38.0 39.0 40.0 41.0 42.0 43.0 44.0 45.0 46.0 47.0 48.0 49.0 50.0 51.0 52.0 53.0 54.0 55.0 56.0 57.0 58.0 59.0 60.0 61.0 62.0 63.0
# CHECK-LABEL: test_mma
# CHECK: 39680.0 39709.0 39922.0 40135.0 40164.0 40193.0 40406.0 40619.0 40648.0 40677.0 40890.0 41103.0 41132.0 41161.0 41374.0 41587.0 41616.0 41645.0 41858.0 42071.0 42100.0 42129.0 42342.0 42555.0 42584.0 42613.0 42826.0 43039.0 43068.0 43097.0 43310.0 43523.0
# CHECK: 101152.0 101309.0 101906.0 102503.0 102660.0 102817.0 103414.0 104011.0 104168.0 104325.0 104922.0 105519.0 105676.0 105833.0 106430.0 107027.0 107184.0 107341.0 107938.0 108535.0 108692.0 108849.0 109446.0 110043.0 110200.0 110357.0 110954.0 111551.0 111708.0 111865.0 112462.0 113059.0
# CHECK: 162624.0 162909.0 163890.0 164871.0 165156.0 165441.0 166422.0 167403.0 167688.0 167973.0 168954.0 169935.0 170220.0 170505.0 171486.0 172467.0 172752.0 173037.0 174018.0 174999.0 175284.0 175569.0 176550.0 177531.0 177816.0 178101.0 179082.0 180063.0 180348.0 180633.0 181614.0 182595.0
# CHECK: 224096.0 224509.0 225874.0 227239.0 227652.0 228065.0 229430.0 230795.0 231208.0 231621.0 232986.0 234351.0 234764.0 235177.0 236542.0 237907.0 238320.0 238733.0 240098.0 241463.0 241876.0 242289.0 243654.0 245019.0 245432.0 245845.0 247210.0 248575.0 248988.0 249401.0 250766.0 252131.0
# CHECK: 285568.0 286109.0 287858.0 289607.0 290148.0 290689.0 292438.0 294187.0 294728.0 295269.0 297018.0 298767.0 299308.0 299849.0 301598.0 303347.0 303888.0 304429.0 306178.0 307927.0 308468.0 309009.0 310758.0 312507.0 313048.0 313589.0 315338.0 317087.0 317628.0 318169.0 319918.0 321667.0
# CHECK: 347040.0 347709.0 349842.0 351975.0 352644.0 353313.0 355446.0 357579.0 358248.0 358917.0 361050.0 363183.0 363852.0 364521.0 366654.0 368787.0 369456.0 370125.0 372258.0 374391.0 375060.0 375729.0 377862.0 379995.0 380664.0 381333.0 383466.0 385599.0 386268.0 386937.0 389070.0 391203.0
# CHECK: 408512.0 409309.0 411826.0 414343.0 415140.0 415937.0 418454.0 420971.0 421768.0 422565.0 425082.0 427599.0 428396.0 429193.0 431710.0 434227.0 435024.0 435821.0 438338.0 440855.0 441652.0 442449.0 444966.0 447483.0 448280.0 449077.0 451594.0 454111.0 454908.0 455705.0 458222.0 460739.0
# CHECK: 469984.0 470909.0 473810.0 476711.0 477636.0 478561.0 481462.0 484363.0 485288.0 486213.0 489114.0 492015.0 492940.0 493865.0 496766.0 499667.0 500592.0 501517.0 504418.0 507319.0 508244.0 509169.0 512070.0 514971.0 515896.0 516821.0 519722.0 522623.0 523548.0 524473.0 527374.0 530275.0
# CHECK: 531456.0 532509.0 535794.0 539079.0 540132.0 541185.0 544470.0 547755.0 548808.0 549861.0 553146.0 556431.0 557484.0 558537.0 561822.0 565107.0 566160.0 567213.0 570498.0 573783.0 574836.0 575889.0 579174.0 582459.0 583512.0 584565.0 587850.0 591135.0 592188.0 593241.0 596526.0 599811.0
# CHECK: 592928.0 594109.0 597778.0 601447.0 602628.0 603809.0 607478.0 611147.0 612328.0 613509.0 617178.0 620847.0 622028.0 623209.0 626878.0 630547.0 631728.0 632909.0 636578.0 640247.0 641428.0 642609.0 646278.0 649947.0 651128.0 652309.0 655978.0 659647.0 660828.0 662009.0 665678.0 669347.0
# CHECK: 654400.0 655709.0 659762.0 663815.0 665124.0 666433.0 670486.0 674539.0 675848.0 677157.0 681210.0 685263.0 686572.0 687881.0 691934.0 695987.0 697296.0 698605.0 702658.0 706711.0 708020.0 709329.0 713382.0 717435.0 718744.0 720053.0 724106.0 728159.0 729468.0 730777.0 734830.0 738883.0
# CHECK: 715872.0 717309.0 721746.0 726183.0 727620.0 729057.0 733494.0 737931.0 739368.0 740805.0 745242.0 749679.0 751116.0 752553.0 756990.0 761427.0 762864.0 764301.0 768738.0 773175.0 774612.0 776049.0 780486.0 784923.0 786360.0 787797.0 792234.0 796671.0 798108.0 799545.0 803982.0 808419.0
# CHECK: 777344.0 778909.0 783730.0 788551.0 790116.0 791681.0 796502.0 801323.0 802888.0 804453.0 809274.0 814095.0 815660.0 817225.0 822046.0 826867.0 828432.0 829997.0 834818.0 839639.0 841204.0 842769.0 847590.0 852411.0 853976.0 855541.0 860362.0 865183.0 866748.0 868313.0 873134.0 877955.0
# CHECK: 838816.0 840509.0 845714.0 850919.0 852612.0 854305.0 859510.0 864715.0 866408.0 868101.0 873306.0 878511.0 880204.0 881897.0 887102.0 892307.0 894000.0 895693.0 900898.0 906103.0 907796.0 909489.0 914694.0 919899.0 921592.0 923285.0 928490.0 933695.0 935388.0 937081.0 942286.0 947491.0
# CHECK: 900288.0 902109.0 907698.0 913287.0 915108.0 916929.0 922518.0 928107.0 929928.0 931749.0 937338.0 942927.0 944748.0 946569.0 952158.0 957747.0 959568.0 961389.0 966978.0 972567.0 974388.0 976209.0 981798.0 987387.0 989208.0 991029.0 996618.0 1002207.0 1004028.0 1005849.0 1011438.0 1017027.0
# CHECK: 961760.0 963709.0 969682.0 975655.0 977604.0 979553.0 985526.0 991499.0 993448.0 995397.0 1001370.0 1007343.0 1009292.0 1011241.0 1017214.0 1023187.0 1025136.0 1027085.0 1033058.0 1039031.0 1040980.0 1042929.0 1048902.0 1054875.0 1056824.0 1058773.0 1064746.0 1070719.0 1072668.0 1074617.0 1080590.0 1086563.0
# CHECK: 1023488.0 1025565.0 1031922.0 1038279.0 1040356.0 1042433.0 1048790.0 1055147.0 1057224.0 1059301.0 1065658.0 1072015.0 1074092.0 1076169.0 1082526.0 1088883.0 1090960.0 1093037.0 1099394.0 1105751.0 1107828.0 1109905.0 1116262.0 1122619.0 1124696.0 1126773.0 1133130.0 1139487.0 1141564.0 1143641.0 1149998.0 1156355.0
# CHECK: 1084960.0 1087165.0 1093906.0 1100647.0 1102852.0 1105057.0 1111798.0 1118539.0 1120744.0 1122949.0 1129690.0 1136431.0 1138636.0 1140841.0 1147582.0 1154323.0 1156528.0 1158733.0 1165474.0 1172215.0 1174420.0 1176625.0 1183366.0 1190107.0 1192312.0 1194517.0 1201258.0 1207999.0 1210204.0 1212409.0 1219150.0 1225891.0
# CHECK: 1146432.0 1148765.0 1155890.0 1163015.0 1165348.0 1167681.0 1174806.0 1181931.0 1184264.0 1186597.0 1193722.0 1200847.0 1203180.0 1205513.0 1212638.0 1219763.0 1222096.0 1224429.0 1231554.0 1238679.0 1241012.0 1243345.0 1250470.0 1257595.0 1259928.0 1262261.0 1269386.0 1276511.0 1278844.0 1281177.0 1288302.0 1295427.0
# CHECK: 1207904.0 1210365.0 1217874.0 1225383.0 1227844.0 1230305.0 1237814.0 1245323.0 1247784.0 1250245.0 1257754.0 1265263.0 1267724.0 1270185.0 1277694.0 1285203.0 1287664.0 1290125.0 1297634.0 1305143.0 1307604.0 1310065.0 1317574.0 1325083.0 1327544.0 1330005.0 1337514.0 1345023.0 1347484.0 1349945.0 1357454.0 1364963.0
# CHECK: 1269376.0 1271965.0 1279858.0 1287751.0 1290340.0 1292929.0 1300822.0 1308715.0 1311304.0 1313893.0 1321786.0 1329679.0 1332268.0 1334857.0 1342750.0 1350643.0 1353232.0 1355821.0 1363714.0 1371607.0 1374196.0 1376785.0 1384678.0 1392571.0 1395160.0 1397749.0 1405642.0 1413535.0 1416124.0 1418713.0 1426606.0 1434499.0
# CHECK: 1330848.0 1333565.0 1341842.0 1350119.0 1352836.0 1355553.0 1363830.0 1372107.0 1374824.0 1377541.0 1385818.0 1394095.0 1396812.0 1399529.0 1407806.0 1416083.0 1418800.0 1421517.0 1429794.0 1438071.0 1440788.0 1443505.0 1451782.0 1460059.0 1462776.0 1465493.0 1473770.0 1482047.0 1484764.0 1487481.0 1495758.0 1504035.0
# CHECK: 1392320.0 1395165.0 1403826.0 1412487.0 1415332.0 1418177.0 1426838.0 1435499.0 1438344.0 1441189.0 1449850.0 1458511.0 1461356.0 1464201.0 1472862.0 1481523.0 1484368.0 1487213.0 1495874.0 1504535.0 1507380.0 1510225.0 1518886.0 1527547.0 1530392.0 1533237.0 1541898.0 1550559.0 1553404.0 1556249.0 1564910.0 1573571.0
# CHECK: 1453792.0 1456765.0 1465810.0 1474855.0 1477828.0 1480801.0 1489846.0 1498891.0 1501864.0 1504837.0 1513882.0 1522927.0 1525900.0 1528873.0 1537918.0 1546963.0 1549936.0 1552909.0 1561954.0 1570999.0 1573972.0 1576945.0 1585990.0 1595035.0 1598008.0 1600981.0 1610026.0 1619071.0 1622044.0 1625017.0 1634062.0 1643107.0
# CHECK: 1515264.0 1518365.0 1527794.0 1537223.0 1540324.0 1543425.0 1552854.0 1562283.0 1565384.0 1568485.0 1577914.0 1587343.0 1590444.0 1593545.0 1602974.0 1612403.0 1615504.0 1618605.0 1628034.0 1637463.0 1640564.0 1643665.0 1653094.0 1662523.0 1665624.0 1668725.0 1678154.0 1687583.0 1690684.0 1693785.0 1703214.0 1712643.0
# CHECK: 1576736.0 1579965.0 1589778.0 1599591.0 1602820.0 1606049.0 1615862.0 1625675.0 1628904.0 1632133.0 1641946.0 1651759.0 1654988.0 1658217.0 1668030.0 1677843.0 1681072.0 1684301.0 1694114.0 1703927.0 1707156.0 1710385.0 1720198.0 1730011.0 1733240.0 1736469.0 1746282.0 1756095.0 1759324.0 1762553.0 1772366.0 1782179.0
# CHECK: 1638208.0 1641565.0 1651762.0 1661959.0 1665316.0 1668673.0 1678870.0 1689067.0 1692424.0 1695781.0 1705978.0 1716175.0 1719532.0 1722889.0 1733086.0 1743283.0 1746640.0 1749997.0 1760194.0 1770391.0 1773748.0 1777105.0 1787302.0 1797499.0 1800856.0 1804213.0 1814410.0 1824607.0 1827964.0 1831321.0 1841518.0 1851715.0
# CHECK: 1699680.0 1703165.0 1713746.0 1724327.0 1727812.0 1731297.0 1741878.0 1752459.0 1755944.0 1759429.0 1770010.0 1780591.0 1784076.0 1787561.0 1798142.0 1808723.0 1812208.0 1815693.0 1826274.0 1836855.0 1840340.0 1843825.0 1854406.0 1864987.0 1868472.0 1871957.0 1882538.0 1893119.0 1896604.0 1900089.0 1910670.0 1921251.0
# CHECK: 1761152.0 1764765.0 1775730.0 1786695.0 1790308.0 1793921.0 1804886.0 1815851.0 1819464.0 1823077.0 1834042.0 1845007.0 1848620.0 1852233.0 1863198.0 1874163.0 1877776.0 1881389.0 1892354.0 1903319.0 1906932.0 1910545.0 1921510.0 1932475.0 1936088.0 1939701.0 1950666.0 1961631.0 1965244.0 1968857.0 1979822.0 1990787.0
# CHECK: 1822624.0 1826365.0 1837714.0 1849063.0 1852804.0 1856545.0 1867894.0 1879243.0 1882984.0 1886725.0 1898074.0 1909423.0 1913164.0 1916905.0 1928254.0 1939603.0 1943344.0 1947085.0 1958434.0 1969783.0 1973524.0 1977265.0 1988614.0 1999963.0 2003704.0 2007445.0 2018794.0 2030143.0 2033884.0 2037625.0 2048974.0 2060323.0
# CHECK: 1884096.0 1887965.0 1899698.0 1911431.0 1915300.0 1919169.0 1930902.0 1942635.0 1946504.0 1950373.0 1962106.0 1973839.0 1977708.0 1981577.0 1993310.0 2005043.0 2008912.0 2012781.0 2024514.0 2036247.0 2040116.0 2043985.0 2055718.0 2067451.0 2071320.0 2075189.0 2086922.0 2098655.0 2102524.0 2106393.0 2118126.0 2129859.0
# CHECK: 1945568.0 1949565.0 1961682.0 1973799.0 1977796.0 1981793.0 1993910.0 2006027.0 2010024.0 2014021.0 2026138.0 2038255.0 2042252.0 2046249.0 2058366.0 2070483.0 2074480.0 2078477.0 2090594.0 2102711.0 2106708.0 2110705.0 2122822.0 2134939.0 2138936.0 2142933.0 2155050.0 2167167.0 2171164.0 2175161.0 2187278.0 2199395.0


def test_load_and_mma_f32_bf16_32x32x16(ctx: DeviceContext):
    print("== test_load_and_mma_f32_bf16_32x32x16")
    test_load_and_mma_and_multiply_operands[
        DType.float32, DType.bfloat16, Index(32, 32, 16), False
    ](ctx)


# CHECK-LABEL: == test_load_and_mma_f32_bf16_32x32x16_transpose
# CHECK-LABEL: == test_load_a
# CHECK: 0.0 16.0 32.0 48.0 64.0 80.0 96.0 112.0 128.0 144.0 160.0 176.0 192.0 208.0 224.0 240.0 256.0 272.0 288.0 304.0 320.0 336.0 352.0 368.0 384.0 400.0 416.0 432.0 448.0 464.0 480.0 496.0 8.0 24.0 40.0 56.0 72.0 88.0 104.0 120.0 136.0 152.0 168.0 184.0 200.0 216.0 232.0 248.0 264.0 280.0 296.0 312.0 328.0 344.0 360.0 376.0 392.0 408.0 424.0 440.0 456.0 472.0 488.0 504.0
# CHECK-LABEL: == test_load_b
# CHECK: 0.0 16.0 32.0 48.0 64.0 80.0 96.0 112.0 128.0 144.0 160.0 176.0 192.0 208.0 224.0 240.0 256.0 272.0 288.0 304.0 320.0 336.0 352.0 368.0 384.0 400.0 416.0 432.0 448.0 464.0 480.0 496.0 8.0 24.0 40.0 56.0 72.0 88.0 104.0 120.0 136.0 152.0 168.0 184.0 200.0 216.0 232.0 248.0 264.0 280.0 296.0 312.0 328.0 344.0 360.0 376.0 392.0 408.0 424.0 440.0 456.0 472.0 488.0 504.0
# CHECK-LABEL: == test_load_c
# CHECK: 0.0 32.0 64.0 96.0
# CHECK: 1.0 33.0 65.0 97.0
# CHECK: 2.0 34.0 66.0 98.0
# CHECK: 3.0 35.0 67.0 99.0
# CHECK: 4.0 36.0 68.0 100.0
# CHECK: 5.0 37.0 69.0 101.0
# CHECK: 6.0 38.0 70.0 102.0
# CHECK: 7.0 39.0 71.0 103.0
# CHECK: 8.0 40.0 72.0 104.0
# CHECK: 9.0 41.0 73.0 105.0
# CHECK: 10.0 42.0 74.0 106.0
# CHECK: 11.0 43.0 75.0 107.0
# CHECK: 12.0 44.0 76.0 108.0
# CHECK: 13.0 45.0 77.0 109.0
# CHECK: 14.0 46.0 78.0 110.0
# CHECK: 15.0 47.0 79.0 111.0
# CHECK: 16.0 48.0 80.0 112.0
# CHECK: 17.0 49.0 81.0 113.0
# CHECK: 18.0 50.0 82.0 114.0
# CHECK: 19.0 51.0 83.0 115.0
# CHECK: 20.0 52.0 84.0 116.0
# CHECK: 21.0 53.0 85.0 117.0
# CHECK: 22.0 54.0 86.0 118.0
# CHECK: 23.0 55.0 87.0 119.0
# CHECK: 24.0 56.0 88.0 120.0
# CHECK: 25.0 57.0 89.0 121.0
# CHECK: 26.0 58.0 90.0 122.0
# CHECK: 27.0 59.0 91.0 123.0
# CHECK: 28.0 60.0 92.0 124.0
# CHECK: 29.0 61.0 93.0 125.0
# CHECK: 30.0 62.0 94.0 126.0
# CHECK: 31.0 63.0 95.0 127.0
# CHECK: 128.0 160.0 192.0 224.0
# CHECK: 129.0 161.0 193.0 225.0
# CHECK: 130.0 162.0 194.0 226.0
# CHECK: 131.0 163.0 195.0 227.0
# CHECK: 132.0 164.0 196.0 228.0
# CHECK: 133.0 165.0 197.0 229.0
# CHECK: 134.0 166.0 198.0 230.0
# CHECK: 135.0 167.0 199.0 231.0
# CHECK: 136.0 168.0 200.0 232.0
# CHECK: 137.0 169.0 201.0 233.0
# CHECK: 138.0 170.0 202.0 234.0
# CHECK: 139.0 171.0 203.0 235.0
# CHECK: 140.0 172.0 204.0 236.0
# CHECK: 141.0 173.0 205.0 237.0
# CHECK: 142.0 174.0 206.0 238.0
# CHECK: 143.0 175.0 207.0 239.0
# CHECK: 144.0 176.0 208.0 240.0
# CHECK: 145.0 177.0 209.0 241.0
# CHECK: 146.0 178.0 210.0 242.0
# CHECK: 147.0 179.0 211.0 243.0
# CHECK: 148.0 180.0 212.0 244.0
# CHECK: 149.0 181.0 213.0 245.0
# CHECK: 150.0 182.0 214.0 246.0
# CHECK: 151.0 183.0 215.0 247.0
# CHECK: 152.0 184.0 216.0 248.0
# CHECK: 153.0 185.0 217.0 249.0
# CHECK: 154.0 186.0 218.0 250.0
# CHECK: 155.0 187.0 219.0 251.0
# CHECK: 156.0 188.0 220.0 252.0
# CHECK: 157.0 189.0 221.0 253.0
# CHECK: 158.0 190.0 222.0 254.0
# CHECK: 159.0 191.0 223.0 255.0
# CHECK-LABEL: == test_load_d
# CHECK: 0.0 1.0 2.0 3.0 4.0 5.0 6.0 7.0 8.0 9.0 10.0 11.0 12.0 13.0 14.0 15.0 16.0 17.0 18.0 19.0 20.0 21.0 22.0 23.0 24.0 25.0 26.0 27.0 28.0 29.0 30.0 31.0
# CHECK: 0.0 1.0 2.0 3.0 4.0 5.0 6.0 7.0 8.0 9.0 10.0 11.0 12.0 13.0 14.0 15.0 16.0 17.0 18.0 19.0 20.0 21.0 22.0 23.0 24.0 25.0 26.0 27.0 28.0 29.0 30.0 31.0
# CHECK: 0.0 1.0 2.0 3.0 4.0 5.0 6.0 7.0 8.0 9.0 10.0 11.0 12.0 13.0 14.0 15.0 16.0 17.0 18.0 19.0 20.0 21.0 22.0 23.0 24.0 25.0 26.0 27.0 28.0 29.0 30.0 31.0
# CHECK: 0.0 1.0 2.0 3.0 4.0 5.0 6.0 7.0 8.0 9.0 10.0 11.0 12.0 13.0 14.0 15.0 16.0 17.0 18.0 19.0 20.0 21.0 22.0 23.0 24.0 25.0 26.0 27.0 28.0 29.0 30.0 31.0
# CHECK: 32.0 33.0 34.0 35.0 36.0 37.0 38.0 39.0 40.0 41.0 42.0 43.0 44.0 45.0 46.0 47.0 48.0 49.0 50.0 51.0 52.0 53.0 54.0 55.0 56.0 57.0 58.0 59.0 60.0 61.0 62.0 63.0
# CHECK: 32.0 33.0 34.0 35.0 36.0 37.0 38.0 39.0 40.0 41.0 42.0 43.0 44.0 45.0 46.0 47.0 48.0 49.0 50.0 51.0 52.0 53.0 54.0 55.0 56.0 57.0 58.0 59.0 60.0 61.0 62.0 63.0
# CHECK: 32.0 33.0 34.0 35.0 36.0 37.0 38.0 39.0 40.0 41.0 42.0 43.0 44.0 45.0 46.0 47.0 48.0 49.0 50.0 51.0 52.0 53.0 54.0 55.0 56.0 57.0 58.0 59.0 60.0 61.0 62.0 63.0
# CHECK: 32.0 33.0 34.0 35.0 36.0 37.0 38.0 39.0 40.0 41.0 42.0 43.0 44.0 45.0 46.0 47.0 48.0 49.0 50.0 51.0 52.0 53.0 54.0 55.0 56.0 57.0 58.0 59.0 60.0 61.0 62.0 63.0
# CHECK: 0.0 1.0 2.0 3.0 4.0 5.0 6.0 7.0 8.0 9.0 10.0 11.0 12.0 13.0 14.0 15.0 16.0 17.0 18.0 19.0 20.0 21.0 22.0 23.0 24.0 25.0 26.0 27.0 28.0 29.0 30.0 31.0
# CHECK: 0.0 1.0 2.0 3.0 4.0 5.0 6.0 7.0 8.0 9.0 10.0 11.0 12.0 13.0 14.0 15.0 16.0 17.0 18.0 19.0 20.0 21.0 22.0 23.0 24.0 25.0 26.0 27.0 28.0 29.0 30.0 31.0
# CHECK: 0.0 1.0 2.0 3.0 4.0 5.0 6.0 7.0 8.0 9.0 10.0 11.0 12.0 13.0 14.0 15.0 16.0 17.0 18.0 19.0 20.0 21.0 22.0 23.0 24.0 25.0 26.0 27.0 28.0 29.0 30.0 31.0
# CHECK: 0.0 1.0 2.0 3.0 4.0 5.0 6.0 7.0 8.0 9.0 10.0 11.0 12.0 13.0 14.0 15.0 16.0 17.0 18.0 19.0 20.0 21.0 22.0 23.0 24.0 25.0 26.0 27.0 28.0 29.0 30.0 31.0
# CHECK: 32.0 33.0 34.0 35.0 36.0 37.0 38.0 39.0 40.0 41.0 42.0 43.0 44.0 45.0 46.0 47.0 48.0 49.0 50.0 51.0 52.0 53.0 54.0 55.0 56.0 57.0 58.0 59.0 60.0 61.0 62.0 63.0
# CHECK: 32.0 33.0 34.0 35.0 36.0 37.0 38.0 39.0 40.0 41.0 42.0 43.0 44.0 45.0 46.0 47.0 48.0 49.0 50.0 51.0 52.0 53.0 54.0 55.0 56.0 57.0 58.0 59.0 60.0 61.0 62.0 63.0
# CHECK: 32.0 33.0 34.0 35.0 36.0 37.0 38.0 39.0 40.0 41.0 42.0 43.0 44.0 45.0 46.0 47.0 48.0 49.0 50.0 51.0 52.0 53.0 54.0 55.0 56.0 57.0 58.0 59.0 60.0 61.0 62.0 63.0
# CHECK: 32.0 33.0 34.0 35.0 36.0 37.0 38.0 39.0 40.0 41.0 42.0 43.0 44.0 45.0 46.0 47.0 48.0 49.0 50.0 51.0 52.0 53.0 54.0 55.0 56.0 57.0 58.0 59.0 60.0 61.0 62.0 63.0
# CHECK: 0.0 1.0 2.0 3.0 4.0 5.0 6.0 7.0 8.0 9.0 10.0 11.0 12.0 13.0 14.0 15.0 16.0 17.0 18.0 19.0 20.0 21.0 22.0 23.0 24.0 25.0 26.0 27.0 28.0 29.0 30.0 31.0
# CHECK: 0.0 1.0 2.0 3.0 4.0 5.0 6.0 7.0 8.0 9.0 10.0 11.0 12.0 13.0 14.0 15.0 16.0 17.0 18.0 19.0 20.0 21.0 22.0 23.0 24.0 25.0 26.0 27.0 28.0 29.0 30.0 31.0
# CHECK: 0.0 1.0 2.0 3.0 4.0 5.0 6.0 7.0 8.0 9.0 10.0 11.0 12.0 13.0 14.0 15.0 16.0 17.0 18.0 19.0 20.0 21.0 22.0 23.0 24.0 25.0 26.0 27.0 28.0 29.0 30.0 31.0
# CHECK: 0.0 1.0 2.0 3.0 4.0 5.0 6.0 7.0 8.0 9.0 10.0 11.0 12.0 13.0 14.0 15.0 16.0 17.0 18.0 19.0 20.0 21.0 22.0 23.0 24.0 25.0 26.0 27.0 28.0 29.0 30.0 31.0
# CHECK: 32.0 33.0 34.0 35.0 36.0 37.0 38.0 39.0 40.0 41.0 42.0 43.0 44.0 45.0 46.0 47.0 48.0 49.0 50.0 51.0 52.0 53.0 54.0 55.0 56.0 57.0 58.0 59.0 60.0 61.0 62.0 63.0
# CHECK: 32.0 33.0 34.0 35.0 36.0 37.0 38.0 39.0 40.0 41.0 42.0 43.0 44.0 45.0 46.0 47.0 48.0 49.0 50.0 51.0 52.0 53.0 54.0 55.0 56.0 57.0 58.0 59.0 60.0 61.0 62.0 63.0
# CHECK: 32.0 33.0 34.0 35.0 36.0 37.0 38.0 39.0 40.0 41.0 42.0 43.0 44.0 45.0 46.0 47.0 48.0 49.0 50.0 51.0 52.0 53.0 54.0 55.0 56.0 57.0 58.0 59.0 60.0 61.0 62.0 63.0
# CHECK: 32.0 33.0 34.0 35.0 36.0 37.0 38.0 39.0 40.0 41.0 42.0 43.0 44.0 45.0 46.0 47.0 48.0 49.0 50.0 51.0 52.0 53.0 54.0 55.0 56.0 57.0 58.0 59.0 60.0 61.0 62.0 63.0
# CHECK: 0.0 1.0 2.0 3.0 4.0 5.0 6.0 7.0 8.0 9.0 10.0 11.0 12.0 13.0 14.0 15.0 16.0 17.0 18.0 19.0 20.0 21.0 22.0 23.0 24.0 25.0 26.0 27.0 28.0 29.0 30.0 31.0
# CHECK: 0.0 1.0 2.0 3.0 4.0 5.0 6.0 7.0 8.0 9.0 10.0 11.0 12.0 13.0 14.0 15.0 16.0 17.0 18.0 19.0 20.0 21.0 22.0 23.0 24.0 25.0 26.0 27.0 28.0 29.0 30.0 31.0
# CHECK: 0.0 1.0 2.0 3.0 4.0 5.0 6.0 7.0 8.0 9.0 10.0 11.0 12.0 13.0 14.0 15.0 16.0 17.0 18.0 19.0 20.0 21.0 22.0 23.0 24.0 25.0 26.0 27.0 28.0 29.0 30.0 31.0
# CHECK: 0.0 1.0 2.0 3.0 4.0 5.0 6.0 7.0 8.0 9.0 10.0 11.0 12.0 13.0 14.0 15.0 16.0 17.0 18.0 19.0 20.0 21.0 22.0 23.0 24.0 25.0 26.0 27.0 28.0 29.0 30.0 31.0
# CHECK: 32.0 33.0 34.0 35.0 36.0 37.0 38.0 39.0 40.0 41.0 42.0 43.0 44.0 45.0 46.0 47.0 48.0 49.0 50.0 51.0 52.0 53.0 54.0 55.0 56.0 57.0 58.0 59.0 60.0 61.0 62.0 63.0
# CHECK: 32.0 33.0 34.0 35.0 36.0 37.0 38.0 39.0 40.0 41.0 42.0 43.0 44.0 45.0 46.0 47.0 48.0 49.0 50.0 51.0 52.0 53.0 54.0 55.0 56.0 57.0 58.0 59.0 60.0 61.0 62.0 63.0
# CHECK: 32.0 33.0 34.0 35.0 36.0 37.0 38.0 39.0 40.0 41.0 42.0 43.0 44.0 45.0 46.0 47.0 48.0 49.0 50.0 51.0 52.0 53.0 54.0 55.0 56.0 57.0 58.0 59.0 60.0 61.0 62.0 63.0
# CHECK: 32.0 33.0 34.0 35.0 36.0 37.0 38.0 39.0 40.0 41.0 42.0 43.0 44.0 45.0 46.0 47.0 48.0 49.0 50.0 51.0 52.0 53.0 54.0 55.0 56.0 57.0 58.0 59.0 60.0 61.0 62.0 63.0
# CHECK-LABEL: == test_mma
# CHECK: 1240.0 3161.0 5082.0 7003.0 8924.0 10845.0 12766.0 14687.0 16608.0 18529.0 20450.0 22371.0 24292.0 26213.0 28134.0 30055.0 31984.0 33905.0 35826.0 37747.0 39668.0 41589.0 43510.0 45431.0 47352.0 49273.0 51194.0 53115.0 55036.0 56957.0 58878.0 60799.0
# CHECK: 3192.0 9209.0 15226.0 21243.0 27260.0 33277.0 39294.0 45311.0 51328.0 57345.0 63362.0 69379.0 75396.0 81413.0 87430.0 93447.0 99472.0 105489.0 111506.0 117523.0 123540.0 129557.0 135574.0 141591.0 147608.0 153625.0 159642.0 165659.0 171676.0 177693.0 183710.0 189727.0
# CHECK: 5144.0 15257.0 25370.0 35483.0 45596.0 55709.0 65822.0 75935.0 86048.0 96161.0 106274.0 116387.0 126500.0 136613.0 146726.0 156839.0 166960.0 177073.0 187186.0 197299.0 207412.0 217525.0 227638.0 237751.0 247864.0 257977.0 268090.0 278203.0 288316.0 298429.0 308542.0 318655.0
# CHECK: 7096.0 21305.0 35514.0 49723.0 63932.0 78141.0 92350.0 106559.0 120768.0 134977.0 149186.0 163395.0 177604.0 191813.0 206022.0 220231.0 234448.0 248657.0 262866.0 277075.0 291284.0 305493.0 319702.0 333911.0 348120.0 362329.0 376538.0 390747.0 404956.0 419165.0 433374.0 447583.0
# CHECK: 9048.0 27353.0 45658.0 63963.0 82268.0 100573.0 118878.0 137183.0 155488.0 173793.0 192098.0 210403.0 228708.0 247013.0 265318.0 283623.0 301936.0 320241.0 338546.0 356851.0 375156.0 393461.0 411766.0 430071.0 448376.0 466681.0 484986.0 503291.0 521596.0 539901.0 558206.0 576511.0
# CHECK: 11000.0 33401.0 55802.0 78203.0 100604.0 123005.0 145406.0 167807.0 190208.0 212609.0 235010.0 257411.0 279812.0 302213.0 324614.0 347015.0 369424.0 391825.0 414226.0 436627.0 459028.0 481429.0 503830.0 526231.0 548632.0 571033.0 593434.0 615835.0 638236.0 660637.0 683038.0 705439.0
# CHECK: 12952.0 39449.0 65946.0 92443.0 118940.0 145437.0 171934.0 198431.0 224928.0 251425.0 277922.0 304419.0 330916.0 357413.0 383910.0 410407.0 436912.0 463409.0 489906.0 516403.0 542900.0 569397.0 595894.0 622391.0 648888.0 675385.0 701882.0 728379.0 754876.0 781373.0 807870.0 834367.0
# CHECK: 14904.0 45497.0 76090.0 106683.0 137276.0 167869.0 198462.0 229055.0 259648.0 290241.0 320834.0 351427.0 382020.0 412613.0 443206.0 473799.0 504400.0 534993.0 565586.0 596179.0 626772.0 657365.0 687958.0 718551.0 749144.0 779737.0 810330.0 840923.0 871516.0 902109.0 932702.0 963295.0
# CHECK: 16856.0 51545.0 86234.0 120923.0 155612.0 190301.0 224990.0 259679.0 294368.0 329057.0 363746.0 398435.0 433124.0 467813.0 502502.0 537191.0 571888.0 606577.0 641266.0 675955.0 710644.0 745333.0 780022.0 814711.0 849400.0 884089.0 918778.0 953467.0 988156.0 1022845.0 1057534.0 1092223.0
# CHECK: 18808.0 57593.0 96378.0 135163.0 173948.0 212733.0 251518.0 290303.0 329088.0 367873.0 406658.0 445443.0 484228.0 523013.0 561798.0 600583.0 639376.0 678161.0 716946.0 755731.0 794516.0 833301.0 872086.0 910871.0 949656.0 988441.0 1027226.0 1066011.0 1104796.0 1143581.0 1182366.0 1221151.0
# CHECK: 20760.0 63641.0 106522.0 149403.0 192284.0 235165.0 278046.0 320927.0 363808.0 406689.0 449570.0 492451.0 535332.0 578213.0 621094.0 663975.0 706864.0 749745.0 792626.0 835507.0 878388.0 921269.0 964150.0 1007031.0 1049912.0 1092793.0 1135674.0 1178555.0 1221436.0 1264317.0 1307198.0 1350079.0
# CHECK: 22712.0 69689.0 116666.0 163643.0 210620.0 257597.0 304574.0 351551.0 398528.0 445505.0 492482.0 539459.0 586436.0 633413.0 680390.0 727367.0 774352.0 821329.0 868306.0 915283.0 962260.0 1009237.0 1056214.0 1103191.0 1150168.0 1197145.0 1244122.0 1291099.0 1338076.0 1385053.0 1432030.0 1479007.0
# CHECK: 24664.0 75737.0 126810.0 177883.0 228956.0 280029.0 331102.0 382175.0 433248.0 484321.0 535394.0 586467.0 637540.0 688613.0 739686.0 790759.0 841840.0 892913.0 943986.0 995059.0 1046132.0 1097205.0 1148278.0 1199351.0 1250424.0 1301497.0 1352570.0 1403643.0 1454716.0 1505789.0 1556862.0 1607935.0
# CHECK: 26616.0 81785.0 136954.0 192123.0 247292.0 302461.0 357630.0 412799.0 467968.0 523137.0 578306.0 633475.0 688644.0 743813.0 798982.0 854151.0 909328.0 964497.0 1019666.0 1074835.0 1130004.0 1185173.0 1240342.0 1295511.0 1350680.0 1405849.0 1461018.0 1516187.0 1571356.0 1626525.0 1681694.0 1736863.0
# CHECK: 28568.0 87833.0 147098.0 206363.0 265628.0 324893.0 384158.0 443423.0 502688.0 561953.0 621218.0 680483.0 739748.0 799013.0 858278.0 917543.0 976816.0 1036081.0 1095346.0 1154611.0 1213876.0 1273141.0 1332406.0 1391671.0 1450936.0 1510201.0 1569466.0 1628731.0 1687996.0 1747261.0 1806526.0 1865791.0
# CHECK: 30520.0 93881.0 157242.0 220603.0 283964.0 347325.0 410686.0 474047.0 537408.0 600769.0 664130.0 727491.0 790852.0 854213.0 917574.0 980935.0 1044304.0 1107665.0 1171026.0 1234387.0 1297748.0 1361109.0 1424470.0 1487831.0 1551192.0 1614553.0 1677914.0 1741275.0 1804636.0 1867997.0 1931358.0 1994719.0
# CHECK: 32480.0 99937.0 167394.0 234851.0 302308.0 369765.0 437222.0 504679.0 572136.0 639593.0 707050.0 774507.0 841964.0 909421.0 976878.0 1044335.0 1111808.0 1179265.0 1246722.0 1314179.0 1381636.0 1449093.0 1516550.0 1584007.0 1651464.0 1718921.0 1786378.0 1853835.0 1921292.0 1988749.0 2056206.0 2123663.0
# CHECK: 34432.0 105985.0 177538.0 249091.0 320644.0 392197.0 463750.0 535303.0 606856.0 678409.0 749962.0 821515.0 893068.0 964621.0 1036174.0 1107727.0 1179296.0 1250849.0 1322402.0 1393955.0 1465508.0 1537061.0 1608614.0 1680167.0 1751720.0 1823273.0 1894826.0 1966379.0 2037932.0 2109485.0 2181038.0 2252591.0
# CHECK: 36384.0 112033.0 187682.0 263331.0 338980.0 414629.0 490278.0 565927.0 641576.0 717225.0 792874.0 868523.0 944172.0 1019821.0 1095470.0 1171119.0 1246784.0 1322433.0 1398082.0 1473731.0 1549380.0 1625029.0 1700678.0 1776327.0 1851976.0 1927625.0 2003274.0 2078923.0 2154572.0 2230221.0 2305870.0 2381519.0
# CHECK: 38336.0 118081.0 197826.0 277571.0 357316.0 437061.0 516806.0 596551.0 676296.0 756041.0 835786.0 915531.0 995276.0 1075021.0 1154766.0 1234511.0 1314272.0 1394017.0 1473762.0 1553507.0 1633252.0 1712997.0 1792742.0 1872487.0 1952232.0 2031977.0 2111722.0 2191467.0 2271212.0 2350957.0 2430702.0 2510447.0
# CHECK: 40288.0 124129.0 207970.0 291811.0 375652.0 459493.0 543334.0 627175.0 711016.0 794857.0 878698.0 962539.0 1046380.0 1130221.0 1214062.0 1297903.0 1381760.0 1465601.0 1549442.0 1633283.0 1717124.0 1800965.0 1884806.0 1968647.0 2052488.0 2136329.0 2220170.0 2304011.0 2387852.0 2471693.0 2555534.0 2639375.0
# CHECK: 42240.0 130177.0 218114.0 306051.0 393988.0 481925.0 569862.0 657799.0 745736.0 833673.0 921610.0 1009547.0 1097484.0 1185421.0 1273358.0 1361295.0 1449248.0 1537185.0 1625122.0 1713059.0 1800996.0 1888933.0 1976870.0 2064807.0 2152744.0 2240681.0 2328618.0 2416555.0 2504492.0 2592429.0 2680366.0 2768303.0
# CHECK: 44192.0 136225.0 228258.0 320291.0 412324.0 504357.0 596390.0 688423.0 780456.0 872489.0 964522.0 1056555.0 1148588.0 1240621.0 1332654.0 1424687.0 1516736.0 1608769.0 1700802.0 1792835.0 1884868.0 1976901.0 2068934.0 2160967.0 2253000.0 2345033.0 2437066.0 2529099.0 2621132.0 2713165.0 2805198.0 2897231.0
# CHECK: 46144.0 142273.0 238402.0 334531.0 430660.0 526789.0 622918.0 719047.0 815176.0 911305.0 1007434.0 1103563.0 1199692.0 1295821.0 1391950.0 1488079.0 1584224.0 1680353.0 1776482.0 1872611.0 1968740.0 2064869.0 2160998.0 2257127.0 2353256.0 2449385.0 2545514.0 2641643.0 2737772.0 2833901.0 2930030.0 3026159.0
# CHECK: 48096.0 148321.0 248546.0 348771.0 448996.0 549221.0 649446.0 749671.0 849896.0 950121.0 1050346.0 1150571.0 1250796.0 1351021.0 1451246.0 1551471.0 1651712.0 1751937.0 1852162.0 1952387.0 2052612.0 2152837.0 2253062.0 2353287.0 2453512.0 2553737.0 2653962.0 2754187.0 2854412.0 2954637.0 3054862.0 3155087.0
# CHECK: 50048.0 154369.0 258690.0 363011.0 467332.0 571653.0 675974.0 780295.0 884616.0 988937.0 1093258.0 1197579.0 1301900.0 1406221.0 1510542.0 1614863.0 1719200.0 1823521.0 1927842.0 2032163.0 2136484.0 2240805.0 2345126.0 2449447.0 2553768.0 2658089.0 2762410.0 2866731.0 2971052.0 3075373.0 3179694.0 3284015.0
# CHECK: 52000.0 160417.0 268834.0 377251.0 485668.0 594085.0 702502.0 810919.0 919336.0 1027753.0 1136170.0 1244587.0 1353004.0 1461421.0 1569838.0 1678255.0 1786688.0 1895105.0 2003522.0 2111939.0 2220356.0 2328773.0 2437190.0 2545607.0 2654024.0 2762441.0 2870858.0 2979275.0 3087692.0 3196109.0 3304526.0 3412943.0
# CHECK: 53952.0 166465.0 278978.0 391491.0 504004.0 616517.0 729030.0 841543.0 954056.0 1066569.0 1179082.0 1291595.0 1404108.0 1516621.0 1629134.0 1741647.0 1854176.0 1966689.0 2079202.0 2191715.0 2304228.0 2416741.0 2529254.0 2641767.0 2754280.0 2866793.0 2979306.0 3091819.0 3204332.0 3316845.0 3429358.0 3541871.0
# CHECK: 55904.0 172513.0 289122.0 405731.0 522340.0 638949.0 755558.0 872167.0 988776.0 1105385.0 1221994.0 1338603.0 1455212.0 1571821.0 1688430.0 1805039.0 1921664.0 2038273.0 2154882.0 2271491.0 2388100.0 2504709.0 2621318.0 2737927.0 2854536.0 2971145.0 3087754.0 3204363.0 3320972.0 3437581.0 3554190.0 3670799.0
# CHECK: 57856.0 178561.0 299266.0 419971.0 540676.0 661381.0 782086.0 902791.0 1023496.0 1144201.0 1264906.0 1385611.0 1506316.0 1627021.0 1747726.0 1868431.0 1989152.0 2109857.0 2230562.0 2351267.0 2471972.0 2592677.0 2713382.0 2834087.0 2954792.0 3075497.0 3196202.0 3316907.0 3437612.0 3558317.0 3679022.0 3799727.0
# CHECK: 59808.0 184609.0 309410.0 434211.0 559012.0 683813.0 808614.0 933415.0 1058216.0 1183017.0 1307818.0 1432619.0 1557420.0 1682221.0 1807022.0 1931823.0 2056640.0 2181441.0 2306242.0 2431043.0 2555844.0 2680645.0 2805446.0 2930247.0 3055048.0 3179849.0 3304650.0 3429451.0 3554252.0 3679053.0 3803854.0 3928655.0
# CHECK: 61760.0 190657.0 319554.0 448451.0 577348.0 706245.0 835142.0 964039.0 1092936.0 1221833.0 1350730.0 1479627.0 1608524.0 1737421.0 1866318.0 1995215.0 2124128.0 2253025.0 2381922.0 2510819.0 2639716.0 2768613.0 2897510.0 3026407.0 3155304.0 3284201.0 3413098.0 3541995.0 3670892.0 3799789.0 3928686.0 4057583.0


def test_load_and_mma_f32_bf16_32x32x16_transpose(ctx: DeviceContext):
    print("== test_load_and_mma_f32_bf16_32x32x16_transpose")
    test_load_and_mma_and_multiply_operands[
        DType.float32, DType.bfloat16, Index(32, 32, 16), True
    ](ctx)


# CHECK-LABEL: test_load_and_mma_f32_f16_32x32x16
# CHECK-LABEL: test_load_a
# CHECK: 0.0 16.0 32.0 48.0 64.0 80.0 96.0 112.0 128.0 144.0 160.0 176.0 192.0 208.0 224.0 240.0 256.0 272.0 288.0 304.0 320.0 336.0 352.0 368.0 384.0 400.0 416.0 432.0 448.0 464.0 480.0 496.0 8.0 24.0 40.0 56.0 72.0 88.0 104.0 120.0 136.0 152.0 168.0 184.0 200.0 216.0 232.0 248.0 264.0 280.0 296.0 312.0 328.0 344.0 360.0 376.0 392.0 408.0 424.0 440.0 456.0 472.0 488.0 504.0
# CHECK-LABEL: test_load_b
# CHECK: 0.0 1.0 2.0 3.0 4.0 5.0 6.0 7.0 8.0 9.0 10.0 11.0 12.0 13.0 14.0 15.0 16.0 17.0 18.0 19.0 20.0 21.0 22.0 23.0 24.0 25.0 26.0 27.0 28.0 29.0 30.0 31.0 256.0 257.0 258.0 259.0 260.0 261.0 262.0 263.0 264.0 265.0 266.0 267.0 268.0 269.0 270.0 271.0 272.0 273.0 274.0 275.0 276.0 277.0 278.0 279.0 280.0 281.0 282.0 283.0 284.0 285.0 286.0 287.0
# CHECK-LABEL: test_load_c
# CHECK: 0.0 32.0 64.0 96.0
# CHECK: 1.0 33.0 65.0 97.0
# CHECK: 2.0 34.0 66.0 98.0
# CHECK: 3.0 35.0 67.0 99.0
# CHECK: 4.0 36.0 68.0 100.0
# CHECK: 5.0 37.0 69.0 101.0
# CHECK: 6.0 38.0 70.0 102.0
# CHECK: 7.0 39.0 71.0 103.0
# CHECK: 8.0 40.0 72.0 104.0
# CHECK: 9.0 41.0 73.0 105.0
# CHECK: 10.0 42.0 74.0 106.0
# CHECK: 11.0 43.0 75.0 107.0
# CHECK: 12.0 44.0 76.0 108.0
# CHECK: 13.0 45.0 77.0 109.0
# CHECK: 14.0 46.0 78.0 110.0
# CHECK: 15.0 47.0 79.0 111.0
# CHECK: 16.0 48.0 80.0 112.0
# CHECK: 17.0 49.0 81.0 113.0
# CHECK: 18.0 50.0 82.0 114.0
# CHECK: 19.0 51.0 83.0 115.0
# CHECK: 20.0 52.0 84.0 116.0
# CHECK: 21.0 53.0 85.0 117.0
# CHECK: 22.0 54.0 86.0 118.0
# CHECK: 23.0 55.0 87.0 119.0
# CHECK: 24.0 56.0 88.0 120.0
# CHECK: 25.0 57.0 89.0 121.0
# CHECK: 26.0 58.0 90.0 122.0
# CHECK: 27.0 59.0 91.0 123.0
# CHECK: 28.0 60.0 92.0 124.0
# CHECK: 29.0 61.0 93.0 125.0
# CHECK: 30.0 62.0 94.0 126.0
# CHECK: 31.0 63.0 95.0 127.0
# CHECK: 128.0 160.0 192.0 224.0
# CHECK: 129.0 161.0 193.0 225.0
# CHECK: 130.0 162.0 194.0 226.0
# CHECK: 131.0 163.0 195.0 227.0
# CHECK: 132.0 164.0 196.0 228.0
# CHECK: 133.0 165.0 197.0 229.0
# CHECK: 134.0 166.0 198.0 230.0
# CHECK: 135.0 167.0 199.0 231.0
# CHECK: 136.0 168.0 200.0 232.0
# CHECK: 137.0 169.0 201.0 233.0
# CHECK: 138.0 170.0 202.0 234.0
# CHECK: 139.0 171.0 203.0 235.0
# CHECK: 140.0 172.0 204.0 236.0
# CHECK: 141.0 173.0 205.0 237.0
# CHECK: 142.0 174.0 206.0 238.0
# CHECK: 143.0 175.0 207.0 239.0
# CHECK: 144.0 176.0 208.0 240.0
# CHECK: 145.0 177.0 209.0 241.0
# CHECK: 146.0 178.0 210.0 242.0
# CHECK: 147.0 179.0 211.0 243.0
# CHECK: 148.0 180.0 212.0 244.0
# CHECK: 149.0 181.0 213.0 245.0
# CHECK: 150.0 182.0 214.0 246.0
# CHECK: 151.0 183.0 215.0 247.0
# CHECK: 152.0 184.0 216.0 248.0
# CHECK: 153.0 185.0 217.0 249.0
# CHECK: 154.0 186.0 218.0 250.0
# CHECK: 155.0 187.0 219.0 251.0
# CHECK: 156.0 188.0 220.0 252.0
# CHECK: 157.0 189.0 221.0 253.0
# CHECK: 158.0 190.0 222.0 254.0
# CHECK: 159.0 191.0 223.0 255.0
# CHECK-LABEL: test_load_d
# CHECK: 0.0 1.0 2.0 3.0 4.0 5.0 6.0 7.0 8.0 9.0 10.0 11.0 12.0 13.0 14.0 15.0 16.0 17.0 18.0 19.0 20.0 21.0 22.0 23.0 24.0 25.0 26.0 27.0 28.0 29.0 30.0 31.0
# CHECK: 0.0 1.0 2.0 3.0 4.0 5.0 6.0 7.0 8.0 9.0 10.0 11.0 12.0 13.0 14.0 15.0 16.0 17.0 18.0 19.0 20.0 21.0 22.0 23.0 24.0 25.0 26.0 27.0 28.0 29.0 30.0 31.0
# CHECK: 0.0 1.0 2.0 3.0 4.0 5.0 6.0 7.0 8.0 9.0 10.0 11.0 12.0 13.0 14.0 15.0 16.0 17.0 18.0 19.0 20.0 21.0 22.0 23.0 24.0 25.0 26.0 27.0 28.0 29.0 30.0 31.0
# CHECK: 0.0 1.0 2.0 3.0 4.0 5.0 6.0 7.0 8.0 9.0 10.0 11.0 12.0 13.0 14.0 15.0 16.0 17.0 18.0 19.0 20.0 21.0 22.0 23.0 24.0 25.0 26.0 27.0 28.0 29.0 30.0 31.0
# CHECK: 32.0 33.0 34.0 35.0 36.0 37.0 38.0 39.0 40.0 41.0 42.0 43.0 44.0 45.0 46.0 47.0 48.0 49.0 50.0 51.0 52.0 53.0 54.0 55.0 56.0 57.0 58.0 59.0 60.0 61.0 62.0 63.0
# CHECK: 32.0 33.0 34.0 35.0 36.0 37.0 38.0 39.0 40.0 41.0 42.0 43.0 44.0 45.0 46.0 47.0 48.0 49.0 50.0 51.0 52.0 53.0 54.0 55.0 56.0 57.0 58.0 59.0 60.0 61.0 62.0 63.0
# CHECK: 32.0 33.0 34.0 35.0 36.0 37.0 38.0 39.0 40.0 41.0 42.0 43.0 44.0 45.0 46.0 47.0 48.0 49.0 50.0 51.0 52.0 53.0 54.0 55.0 56.0 57.0 58.0 59.0 60.0 61.0 62.0 63.0
# CHECK: 32.0 33.0 34.0 35.0 36.0 37.0 38.0 39.0 40.0 41.0 42.0 43.0 44.0 45.0 46.0 47.0 48.0 49.0 50.0 51.0 52.0 53.0 54.0 55.0 56.0 57.0 58.0 59.0 60.0 61.0 62.0 63.0
# CHECK: 0.0 1.0 2.0 3.0 4.0 5.0 6.0 7.0 8.0 9.0 10.0 11.0 12.0 13.0 14.0 15.0 16.0 17.0 18.0 19.0 20.0 21.0 22.0 23.0 24.0 25.0 26.0 27.0 28.0 29.0 30.0 31.0
# CHECK: 0.0 1.0 2.0 3.0 4.0 5.0 6.0 7.0 8.0 9.0 10.0 11.0 12.0 13.0 14.0 15.0 16.0 17.0 18.0 19.0 20.0 21.0 22.0 23.0 24.0 25.0 26.0 27.0 28.0 29.0 30.0 31.0
# CHECK: 0.0 1.0 2.0 3.0 4.0 5.0 6.0 7.0 8.0 9.0 10.0 11.0 12.0 13.0 14.0 15.0 16.0 17.0 18.0 19.0 20.0 21.0 22.0 23.0 24.0 25.0 26.0 27.0 28.0 29.0 30.0 31.0
# CHECK: 0.0 1.0 2.0 3.0 4.0 5.0 6.0 7.0 8.0 9.0 10.0 11.0 12.0 13.0 14.0 15.0 16.0 17.0 18.0 19.0 20.0 21.0 22.0 23.0 24.0 25.0 26.0 27.0 28.0 29.0 30.0 31.0
# CHECK: 32.0 33.0 34.0 35.0 36.0 37.0 38.0 39.0 40.0 41.0 42.0 43.0 44.0 45.0 46.0 47.0 48.0 49.0 50.0 51.0 52.0 53.0 54.0 55.0 56.0 57.0 58.0 59.0 60.0 61.0 62.0 63.0
# CHECK: 32.0 33.0 34.0 35.0 36.0 37.0 38.0 39.0 40.0 41.0 42.0 43.0 44.0 45.0 46.0 47.0 48.0 49.0 50.0 51.0 52.0 53.0 54.0 55.0 56.0 57.0 58.0 59.0 60.0 61.0 62.0 63.0
# CHECK: 32.0 33.0 34.0 35.0 36.0 37.0 38.0 39.0 40.0 41.0 42.0 43.0 44.0 45.0 46.0 47.0 48.0 49.0 50.0 51.0 52.0 53.0 54.0 55.0 56.0 57.0 58.0 59.0 60.0 61.0 62.0 63.0
# CHECK: 32.0 33.0 34.0 35.0 36.0 37.0 38.0 39.0 40.0 41.0 42.0 43.0 44.0 45.0 46.0 47.0 48.0 49.0 50.0 51.0 52.0 53.0 54.0 55.0 56.0 57.0 58.0 59.0 60.0 61.0 62.0 63.0
# CHECK: 0.0 1.0 2.0 3.0 4.0 5.0 6.0 7.0 8.0 9.0 10.0 11.0 12.0 13.0 14.0 15.0 16.0 17.0 18.0 19.0 20.0 21.0 22.0 23.0 24.0 25.0 26.0 27.0 28.0 29.0 30.0 31.0
# CHECK: 0.0 1.0 2.0 3.0 4.0 5.0 6.0 7.0 8.0 9.0 10.0 11.0 12.0 13.0 14.0 15.0 16.0 17.0 18.0 19.0 20.0 21.0 22.0 23.0 24.0 25.0 26.0 27.0 28.0 29.0 30.0 31.0
# CHECK: 0.0 1.0 2.0 3.0 4.0 5.0 6.0 7.0 8.0 9.0 10.0 11.0 12.0 13.0 14.0 15.0 16.0 17.0 18.0 19.0 20.0 21.0 22.0 23.0 24.0 25.0 26.0 27.0 28.0 29.0 30.0 31.0
# CHECK: 0.0 1.0 2.0 3.0 4.0 5.0 6.0 7.0 8.0 9.0 10.0 11.0 12.0 13.0 14.0 15.0 16.0 17.0 18.0 19.0 20.0 21.0 22.0 23.0 24.0 25.0 26.0 27.0 28.0 29.0 30.0 31.0
# CHECK: 32.0 33.0 34.0 35.0 36.0 37.0 38.0 39.0 40.0 41.0 42.0 43.0 44.0 45.0 46.0 47.0 48.0 49.0 50.0 51.0 52.0 53.0 54.0 55.0 56.0 57.0 58.0 59.0 60.0 61.0 62.0 63.0
# CHECK: 32.0 33.0 34.0 35.0 36.0 37.0 38.0 39.0 40.0 41.0 42.0 43.0 44.0 45.0 46.0 47.0 48.0 49.0 50.0 51.0 52.0 53.0 54.0 55.0 56.0 57.0 58.0 59.0 60.0 61.0 62.0 63.0
# CHECK: 32.0 33.0 34.0 35.0 36.0 37.0 38.0 39.0 40.0 41.0 42.0 43.0 44.0 45.0 46.0 47.0 48.0 49.0 50.0 51.0 52.0 53.0 54.0 55.0 56.0 57.0 58.0 59.0 60.0 61.0 62.0 63.0
# CHECK: 32.0 33.0 34.0 35.0 36.0 37.0 38.0 39.0 40.0 41.0 42.0 43.0 44.0 45.0 46.0 47.0 48.0 49.0 50.0 51.0 52.0 53.0 54.0 55.0 56.0 57.0 58.0 59.0 60.0 61.0 62.0 63.0
# CHECK: 0.0 1.0 2.0 3.0 4.0 5.0 6.0 7.0 8.0 9.0 10.0 11.0 12.0 13.0 14.0 15.0 16.0 17.0 18.0 19.0 20.0 21.0 22.0 23.0 24.0 25.0 26.0 27.0 28.0 29.0 30.0 31.0
# CHECK: 0.0 1.0 2.0 3.0 4.0 5.0 6.0 7.0 8.0 9.0 10.0 11.0 12.0 13.0 14.0 15.0 16.0 17.0 18.0 19.0 20.0 21.0 22.0 23.0 24.0 25.0 26.0 27.0 28.0 29.0 30.0 31.0
# CHECK: 0.0 1.0 2.0 3.0 4.0 5.0 6.0 7.0 8.0 9.0 10.0 11.0 12.0 13.0 14.0 15.0 16.0 17.0 18.0 19.0 20.0 21.0 22.0 23.0 24.0 25.0 26.0 27.0 28.0 29.0 30.0 31.0
# CHECK: 0.0 1.0 2.0 3.0 4.0 5.0 6.0 7.0 8.0 9.0 10.0 11.0 12.0 13.0 14.0 15.0 16.0 17.0 18.0 19.0 20.0 21.0 22.0 23.0 24.0 25.0 26.0 27.0 28.0 29.0 30.0 31.0
# CHECK: 32.0 33.0 34.0 35.0 36.0 37.0 38.0 39.0 40.0 41.0 42.0 43.0 44.0 45.0 46.0 47.0 48.0 49.0 50.0 51.0 52.0 53.0 54.0 55.0 56.0 57.0 58.0 59.0 60.0 61.0 62.0 63.0
# CHECK: 32.0 33.0 34.0 35.0 36.0 37.0 38.0 39.0 40.0 41.0 42.0 43.0 44.0 45.0 46.0 47.0 48.0 49.0 50.0 51.0 52.0 53.0 54.0 55.0 56.0 57.0 58.0 59.0 60.0 61.0 62.0 63.0
# CHECK: 32.0 33.0 34.0 35.0 36.0 37.0 38.0 39.0 40.0 41.0 42.0 43.0 44.0 45.0 46.0 47.0 48.0 49.0 50.0 51.0 52.0 53.0 54.0 55.0 56.0 57.0 58.0 59.0 60.0 61.0 62.0 63.0
# CHECK: 32.0 33.0 34.0 35.0 36.0 37.0 38.0 39.0 40.0 41.0 42.0 43.0 44.0 45.0 46.0 47.0 48.0 49.0 50.0 51.0 52.0 53.0 54.0 55.0 56.0 57.0 58.0 59.0 60.0 61.0 62.0 63.0
# CHECK-LABEL: test_mma
# CHECK: 39680.0 39801.0 39922.0 40043.0 40164.0 40285.0 40406.0 40527.0 40648.0 40769.0 40890.0 41011.0 41132.0 41253.0 41374.0 41495.0 41616.0 41737.0 41858.0 41979.0 42100.0 42221.0 42342.0 42463.0 42584.0 42705.0 42826.0 42947.0 43068.0 43189.0 43310.0 43431.0
# CHECK: 101152.0 101529.0 101906.0 102283.0 102660.0 103037.0 103414.0 103791.0 104168.0 104545.0 104922.0 105299.0 105676.0 106053.0 106430.0 106807.0 107184.0 107561.0 107938.0 108315.0 108692.0 109069.0 109446.0 109823.0 110200.0 110577.0 110954.0 111331.0 111708.0 112085.0 112462.0 112839.0
# CHECK: 162624.0 163257.0 163890.0 164523.0 165156.0 165789.0 166422.0 167055.0 167688.0 168321.0 168954.0 169587.0 170220.0 170853.0 171486.0 172119.0 172752.0 173385.0 174018.0 174651.0 175284.0 175917.0 176550.0 177183.0 177816.0 178449.0 179082.0 179715.0 180348.0 180981.0 181614.0 182247.0
# CHECK: 224096.0 224985.0 225874.0 226763.0 227652.0 228541.0 229430.0 230319.0 231208.0 232097.0 232986.0 233875.0 234764.0 235653.0 236542.0 237431.0 238320.0 239209.0 240098.0 240987.0 241876.0 242765.0 243654.0 244543.0 245432.0 246321.0 247210.0 248099.0 248988.0 249877.0 250766.0 251655.0
# CHECK: 285568.0 286713.0 287858.0 289003.0 290148.0 291293.0 292438.0 293583.0 294728.0 295873.0 297018.0 298163.0 299308.0 300453.0 301598.0 302743.0 303888.0 305033.0 306178.0 307323.0 308468.0 309613.0 310758.0 311903.0 313048.0 314193.0 315338.0 316483.0 317628.0 318773.0 319918.0 321063.0
# CHECK: 347040.0 348441.0 349842.0 351243.0 352644.0 354045.0 355446.0 356847.0 358248.0 359649.0 361050.0 362451.0 363852.0 365253.0 366654.0 368055.0 369456.0 370857.0 372258.0 373659.0 375060.0 376461.0 377862.0 379263.0 380664.0 382065.0 383466.0 384867.0 386268.0 387669.0 389070.0 390471.0
# CHECK: 408512.0 410169.0 411826.0 413483.0 415140.0 416797.0 418454.0 420111.0 421768.0 423425.0 425082.0 426739.0 428396.0 430053.0 431710.0 433367.0 435024.0 436681.0 438338.0 439995.0 441652.0 443309.0 444966.0 446623.0 448280.0 449937.0 451594.0 453251.0 454908.0 456565.0 458222.0 459879.0
# CHECK: 469984.0 471897.0 473810.0 475723.0 477636.0 479549.0 481462.0 483375.0 485288.0 487201.0 489114.0 491027.0 492940.0 494853.0 496766.0 498679.0 500592.0 502505.0 504418.0 506331.0 508244.0 510157.0 512070.0 513983.0 515896.0 517809.0 519722.0 521635.0 523548.0 525461.0 527374.0 529287.0
# CHECK: 531456.0 533625.0 535794.0 537963.0 540132.0 542301.0 544470.0 546639.0 548808.0 550977.0 553146.0 555315.0 557484.0 559653.0 561822.0 563991.0 566160.0 568329.0 570498.0 572667.0 574836.0 577005.0 579174.0 581343.0 583512.0 585681.0 587850.0 590019.0 592188.0 594357.0 596526.0 598695.0
# CHECK: 592928.0 595353.0 597778.0 600203.0 602628.0 605053.0 607478.0 609903.0 612328.0 614753.0 617178.0 619603.0 622028.0 624453.0 626878.0 629303.0 631728.0 634153.0 636578.0 639003.0 641428.0 643853.0 646278.0 648703.0 651128.0 653553.0 655978.0 658403.0 660828.0 663253.0 665678.0 668103.0
# CHECK: 654400.0 657081.0 659762.0 662443.0 665124.0 667805.0 670486.0 673167.0 675848.0 678529.0 681210.0 683891.0 686572.0 689253.0 691934.0 694615.0 697296.0 699977.0 702658.0 705339.0 708020.0 710701.0 713382.0 716063.0 718744.0 721425.0 724106.0 726787.0 729468.0 732149.0 734830.0 737511.0
# CHECK: 715872.0 718809.0 721746.0 724683.0 727620.0 730557.0 733494.0 736431.0 739368.0 742305.0 745242.0 748179.0 751116.0 754053.0 756990.0 759927.0 762864.0 765801.0 768738.0 771675.0 774612.0 777549.0 780486.0 783423.0 786360.0 789297.0 792234.0 795171.0 798108.0 801045.0 803982.0 806919.0
# CHECK: 777344.0 780537.0 783730.0 786923.0 790116.0 793309.0 796502.0 799695.0 802888.0 806081.0 809274.0 812467.0 815660.0 818853.0 822046.0 825239.0 828432.0 831625.0 834818.0 838011.0 841204.0 844397.0 847590.0 850783.0 853976.0 857169.0 860362.0 863555.0 866748.0 869941.0 873134.0 876327.0
# CHECK: 838816.0 842265.0 845714.0 849163.0 852612.0 856061.0 859510.0 862959.0 866408.0 869857.0 873306.0 876755.0 880204.0 883653.0 887102.0 890551.0 894000.0 897449.0 900898.0 904347.0 907796.0 911245.0 914694.0 918143.0 921592.0 925041.0 928490.0 931939.0 935388.0 938837.0 942286.0 945735.0
# CHECK: 900288.0 903993.0 907698.0 911403.0 915108.0 918813.0 922518.0 926223.0 929928.0 933633.0 937338.0 941043.0 944748.0 948453.0 952158.0 955863.0 959568.0 963273.0 966978.0 970683.0 974388.0 978093.0 981798.0 985503.0 989208.0 992913.0 996618.0 1000323.0 1004028.0 1007733.0 1011438.0 1015143.0
# CHECK: 961760.0 965721.0 969682.0 973643.0 977604.0 981565.0 985526.0 989487.0 993448.0 997409.0 1001370.0 1005331.0 1009292.0 1013253.0 1017214.0 1021175.0 1025136.0 1029097.0 1033058.0 1037019.0 1040980.0 1044941.0 1048902.0 1052863.0 1056824.0 1060785.0 1064746.0 1068707.0 1072668.0 1076629.0 1080590.0 1084551.0
# CHECK: 1023232.0 1027449.0 1031666.0 1035883.0 1040100.0 1044317.0 1048534.0 1052751.0 1056968.0 1061185.0 1065402.0 1069619.0 1073836.0 1078053.0 1082270.0 1086487.0 1090704.0 1094921.0 1099138.0 1103355.0 1107572.0 1111789.0 1116006.0 1120223.0 1124440.0 1128657.0 1132874.0 1137091.0 1141308.0 1145525.0 1149742.0 1153959.0
# CHECK: 1084704.0 1089177.0 1093650.0 1098123.0 1102596.0 1107069.0 1111542.0 1116015.0 1120488.0 1124961.0 1129434.0 1133907.0 1138380.0 1142853.0 1147326.0 1151799.0 1156272.0 1160745.0 1165218.0 1169691.0 1174164.0 1178637.0 1183110.0 1187583.0 1192056.0 1196529.0 1201002.0 1205475.0 1209948.0 1214421.0 1218894.0 1223367.0
# CHECK: 1146176.0 1150905.0 1155634.0 1160363.0 1165092.0 1169821.0 1174550.0 1179279.0 1184008.0 1188737.0 1193466.0 1198195.0 1202924.0 1207653.0 1212382.0 1217111.0 1221840.0 1226569.0 1231298.0 1236027.0 1240756.0 1245485.0 1250214.0 1254943.0 1259672.0 1264401.0 1269130.0 1273859.0 1278588.0 1283317.0 1288046.0 1292775.0
# CHECK: 1207648.0 1212633.0 1217618.0 1222603.0 1227588.0 1232573.0 1237558.0 1242543.0 1247528.0 1252513.0 1257498.0 1262483.0 1267468.0 1272453.0 1277438.0 1282423.0 1287408.0 1292393.0 1297378.0 1302363.0 1307348.0 1312333.0 1317318.0 1322303.0 1327288.0 1332273.0 1337258.0 1342243.0 1347228.0 1352213.0 1357198.0 1362183.0
# CHECK: 1269120.0 1274361.0 1279602.0 1284843.0 1290084.0 1295325.0 1300566.0 1305807.0 1311048.0 1316289.0 1321530.0 1326771.0 1332012.0 1337253.0 1342494.0 1347735.0 1352976.0 1358217.0 1363458.0 1368699.0 1373940.0 1379181.0 1384422.0 1389663.0 1394904.0 1400145.0 1405386.0 1410627.0 1415868.0 1421109.0 1426350.0 1431591.0
# CHECK: 1330592.0 1336089.0 1341586.0 1347083.0 1352580.0 1358077.0 1363574.0 1369071.0 1374568.0 1380065.0 1385562.0 1391059.0 1396556.0 1402053.0 1407550.0 1413047.0 1418544.0 1424041.0 1429538.0 1435035.0 1440532.0 1446029.0 1451526.0 1457023.0 1462520.0 1468017.0 1473514.0 1479011.0 1484508.0 1490005.0 1495502.0 1500999.0
# CHECK: 1392064.0 1397817.0 1403570.0 1409323.0 1415076.0 1420829.0 1426582.0 1432335.0 1438088.0 1443841.0 1449594.0 1455347.0 1461100.0 1466853.0 1472606.0 1478359.0 1484112.0 1489865.0 1495618.0 1501371.0 1507124.0 1512877.0 1518630.0 1524383.0 1530136.0 1535889.0 1541642.0 1547395.0 1553148.0 1558901.0 1564654.0 1570407.0
# CHECK: 1453536.0 1459545.0 1465554.0 1471563.0 1477572.0 1483581.0 1489590.0 1495599.0 1501608.0 1507617.0 1513626.0 1519635.0 1525644.0 1531653.0 1537662.0 1543671.0 1549680.0 1555689.0 1561698.0 1567707.0 1573716.0 1579725.0 1585734.0 1591743.0 1597752.0 1603761.0 1609770.0 1615779.0 1621788.0 1627797.0 1633806.0 1639815.0
# CHECK: 1515008.0 1521273.0 1527538.0 1533803.0 1540068.0 1546333.0 1552598.0 1558863.0 1565128.0 1571393.0 1577658.0 1583923.0 1590188.0 1596453.0 1602718.0 1608983.0 1615248.0 1621513.0 1627778.0 1634043.0 1640308.0 1646573.0 1652838.0 1659103.0 1665368.0 1671633.0 1677898.0 1684163.0 1690428.0 1696693.0 1702958.0 1709223.0
# CHECK: 1576480.0 1583001.0 1589522.0 1596043.0 1602564.0 1609085.0 1615606.0 1622127.0 1628648.0 1635169.0 1641690.0 1648211.0 1654732.0 1661253.0 1667774.0 1674295.0 1680816.0 1687337.0 1693858.0 1700379.0 1706900.0 1713421.0 1719942.0 1726463.0 1732984.0 1739505.0 1746026.0 1752547.0 1759068.0 1765589.0 1772110.0 1778631.0
# CHECK: 1637952.0 1644729.0 1651506.0 1658283.0 1665060.0 1671837.0 1678614.0 1685391.0 1692168.0 1698945.0 1705722.0 1712499.0 1719276.0 1726053.0 1732830.0 1739607.0 1746384.0 1753161.0 1759938.0 1766715.0 1773492.0 1780269.0 1787046.0 1793823.0 1800600.0 1807377.0 1814154.0 1820931.0 1827708.0 1834485.0 1841262.0 1848039.0
# CHECK: 1699424.0 1706457.0 1713490.0 1720523.0 1727556.0 1734589.0 1741622.0 1748655.0 1755688.0 1762721.0 1769754.0 1776787.0 1783820.0 1790853.0 1797886.0 1804919.0 1811952.0 1818985.0 1826018.0 1833051.0 1840084.0 1847117.0 1854150.0 1861183.0 1868216.0 1875249.0 1882282.0 1889315.0 1896348.0 1903381.0 1910414.0 1917447.0
# CHECK: 1760896.0 1768185.0 1775474.0 1782763.0 1790052.0 1797341.0 1804630.0 1811919.0 1819208.0 1826497.0 1833786.0 1841075.0 1848364.0 1855653.0 1862942.0 1870231.0 1877520.0 1884809.0 1892098.0 1899387.0 1906676.0 1913965.0 1921254.0 1928543.0 1935832.0 1943121.0 1950410.0 1957699.0 1964988.0 1972277.0 1979566.0 1986855.0
# CHECK: 1822368.0 1829913.0 1837458.0 1845003.0 1852548.0 1860093.0 1867638.0 1875183.0 1882728.0 1890273.0 1897818.0 1905363.0 1912908.0 1920453.0 1927998.0 1935543.0 1943088.0 1950633.0 1958178.0 1965723.0 1973268.0 1980813.0 1988358.0 1995903.0 2003448.0 2010993.0 2018538.0 2026083.0 2033628.0 2041173.0 2048718.0 2056263.0
# CHECK: 1883840.0 1891641.0 1899442.0 1907243.0 1915044.0 1922845.0 1930646.0 1938447.0 1946248.0 1954049.0 1961850.0 1969651.0 1977452.0 1985253.0 1993054.0 2000855.0 2008656.0 2016457.0 2024258.0 2032059.0 2039860.0 2047661.0 2055462.0 2063263.0 2071064.0 2078865.0 2086666.0 2094467.0 2102268.0 2110069.0 2117870.0 2125671.0
# CHECK: 1945312.0 1953369.0 1961426.0 1969483.0 1977540.0 1985597.0 1993654.0 2001711.0 2009768.0 2017825.0 2025882.0 2033939.0 2041996.0 2050053.0 2058110.0 2066167.0 2074224.0 2082281.0 2090338.0 2098395.0 2106452.0 2114509.0 2122566.0 2130623.0 2138680.0 2146737.0 2154794.0 2162851.0 2170908.0 2178965.0 2187022.0 2195079.0


def test_load_and_mma_f32_f16_32x32x16(ctx: DeviceContext):
    print("== test_load_and_mma_f32_f16_32x32x16")
    test_load_and_mma_and_multiply_operands[
        DType.float32, DType.float16, Index(32, 32, 16), False
    ](ctx)


# CHECK-LABEL: == test_load_and_mma_f32_f16_32x32x16_transpose
# CHECK-LABEL: == test_load_a
# CHECK: 0.0 16.0 32.0 48.0 64.0 80.0 96.0 112.0 128.0 144.0 160.0 176.0 192.0 208.0 224.0 240.0 256.0 272.0 288.0 304.0 320.0 336.0 352.0 368.0 384.0 400.0 416.0 432.0 448.0 464.0 480.0 496.0 8.0 24.0 40.0 56.0 72.0 88.0 104.0 120.0 136.0 152.0 168.0 184.0 200.0 216.0 232.0 248.0 264.0 280.0 296.0 312.0 328.0 344.0 360.0 376.0 392.0 408.0 424.0 440.0 456.0 472.0 488.0 504.0
# CHECK-LABEL: == test_load_b
# CHECK: 0.0 16.0 32.0 48.0 64.0 80.0 96.0 112.0 128.0 144.0 160.0 176.0 192.0 208.0 224.0 240.0 256.0 272.0 288.0 304.0 320.0 336.0 352.0 368.0 384.0 400.0 416.0 432.0 448.0 464.0 480.0 496.0 8.0 24.0 40.0 56.0 72.0 88.0 104.0 120.0 136.0 152.0 168.0 184.0 200.0 216.0 232.0 248.0 264.0 280.0 296.0 312.0 328.0 344.0 360.0 376.0 392.0 408.0 424.0 440.0 456.0 472.0 488.0 504.0
# CHECK-LABEL: == test_load_c
# CHECK 0.0 32.0 64.0 96.0
# CHECK 1.0 33.0 65.0 97.0
# CHECK 2.0 34.0 66.0 98.0
# CHECK 3.0 35.0 67.0 99.0
# CHECK 4.0 36.0 68.0 100.0
# CHECK 5.0 37.0 69.0 101.0
# CHECK 6.0 38.0 70.0 102.0
# CHECK 7.0 39.0 71.0 103.0
# CHECK 8.0 40.0 72.0 104.0
# CHECK 9.0 41.0 73.0 105.0
# CHECK 10.0 42.0 74.0 106.0
# CHECK 11.0 43.0 75.0 107.0
# CHECK 12.0 44.0 76.0 108.0
# CHECK 13.0 45.0 77.0 109.0
# CHECK 14.0 46.0 78.0 110.0
# CHECK 15.0 47.0 79.0 111.0
# CHECK 16.0 48.0 80.0 112.0
# CHECK 17.0 49.0 81.0 113.0
# CHECK 18.0 50.0 82.0 114.0
# CHECK 19.0 51.0 83.0 115.0
# CHECK 20.0 52.0 84.0 116.0
# CHECK 21.0 53.0 85.0 117.0
# CHECK 22.0 54.0 86.0 118.0
# CHECK 23.0 55.0 87.0 119.0
# CHECK 24.0 56.0 88.0 120.0
# CHECK 25.0 57.0 89.0 121.0
# CHECK 26.0 58.0 90.0 122.0
# CHECK 27.0 59.0 91.0 123.0
# CHECK 28.0 60.0 92.0 124.0
# CHECK 29.0 61.0 93.0 125.0
# CHECK 30.0 62.0 94.0 126.0
# CHECK 31.0 63.0 95.0 127.0
# CHECK 128.0 160.0 192.0 224.0
# CHECK 129.0 161.0 193.0 225.0
# CHECK 130.0 162.0 194.0 226.0
# CHECK 131.0 163.0 195.0 227.0
# CHECK 132.0 164.0 196.0 228.0
# CHECK 133.0 165.0 197.0 229.0
# CHECK 134.0 166.0 198.0 230.0
# CHECK 135.0 167.0 199.0 231.0
# CHECK 136.0 168.0 200.0 232.0
# CHECK 137.0 169.0 201.0 233.0
# CHECK 138.0 170.0 202.0 234.0
# CHECK 139.0 171.0 203.0 235.0
# CHECK 140.0 172.0 204.0 236.0
# CHECK 141.0 173.0 205.0 237.0
# CHECK 142.0 174.0 206.0 238.0
# CHECK 143.0 175.0 207.0 239.0
# CHECK 144.0 176.0 208.0 240.0
# CHECK 145.0 177.0 209.0 241.0
# CHECK 146.0 178.0 210.0 242.0
# CHECK 147.0 179.0 211.0 243.0
# CHECK 148.0 180.0 212.0 244.0
# CHECK 149.0 181.0 213.0 245.0
# CHECK 150.0 182.0 214.0 246.0
# CHECK 151.0 183.0 215.0 247.0
# CHECK 152.0 184.0 216.0 248.0
# CHECK 153.0 185.0 217.0 249.0
# CHECK 154.0 186.0 218.0 250.0
# CHECK 155.0 187.0 219.0 251.0
# CHECK 156.0 188.0 220.0 252.0
# CHECK 157.0 189.0 221.0 253.0
# CHECK 158.0 190.0 222.0 254.0
# CHECK 159.0 191.0 223.0 255.0
# CHECK-LABEL: == test_load_d
# CHECK: 0.0 1.0 2.0 3.0 4.0 5.0 6.0 7.0 8.0 9.0 10.0 11.0 12.0 13.0 14.0 15.0 16.0 17.0 18.0 19.0 20.0 21.0 22.0 23.0 24.0 25.0 26.0 27.0 28.0 29.0 30.0 31.0
# CHECK: 0.0 1.0 2.0 3.0 4.0 5.0 6.0 7.0 8.0 9.0 10.0 11.0 12.0 13.0 14.0 15.0 16.0 17.0 18.0 19.0 20.0 21.0 22.0 23.0 24.0 25.0 26.0 27.0 28.0 29.0 30.0 31.0
# CHECK: 0.0 1.0 2.0 3.0 4.0 5.0 6.0 7.0 8.0 9.0 10.0 11.0 12.0 13.0 14.0 15.0 16.0 17.0 18.0 19.0 20.0 21.0 22.0 23.0 24.0 25.0 26.0 27.0 28.0 29.0 30.0 31.0
# CHECK: 0.0 1.0 2.0 3.0 4.0 5.0 6.0 7.0 8.0 9.0 10.0 11.0 12.0 13.0 14.0 15.0 16.0 17.0 18.0 19.0 20.0 21.0 22.0 23.0 24.0 25.0 26.0 27.0 28.0 29.0 30.0 31.0
# CHECK: 32.0 33.0 34.0 35.0 36.0 37.0 38.0 39.0 40.0 41.0 42.0 43.0 44.0 45.0 46.0 47.0 48.0 49.0 50.0 51.0 52.0 53.0 54.0 55.0 56.0 57.0 58.0 59.0 60.0 61.0 62.0 63.0
# CHECK: 32.0 33.0 34.0 35.0 36.0 37.0 38.0 39.0 40.0 41.0 42.0 43.0 44.0 45.0 46.0 47.0 48.0 49.0 50.0 51.0 52.0 53.0 54.0 55.0 56.0 57.0 58.0 59.0 60.0 61.0 62.0 63.0
# CHECK: 32.0 33.0 34.0 35.0 36.0 37.0 38.0 39.0 40.0 41.0 42.0 43.0 44.0 45.0 46.0 47.0 48.0 49.0 50.0 51.0 52.0 53.0 54.0 55.0 56.0 57.0 58.0 59.0 60.0 61.0 62.0 63.0
# CHECK: 32.0 33.0 34.0 35.0 36.0 37.0 38.0 39.0 40.0 41.0 42.0 43.0 44.0 45.0 46.0 47.0 48.0 49.0 50.0 51.0 52.0 53.0 54.0 55.0 56.0 57.0 58.0 59.0 60.0 61.0 62.0 63.0
# CHECK: 0.0 1.0 2.0 3.0 4.0 5.0 6.0 7.0 8.0 9.0 10.0 11.0 12.0 13.0 14.0 15.0 16.0 17.0 18.0 19.0 20.0 21.0 22.0 23.0 24.0 25.0 26.0 27.0 28.0 29.0 30.0 31.0
# CHECK: 0.0 1.0 2.0 3.0 4.0 5.0 6.0 7.0 8.0 9.0 10.0 11.0 12.0 13.0 14.0 15.0 16.0 17.0 18.0 19.0 20.0 21.0 22.0 23.0 24.0 25.0 26.0 27.0 28.0 29.0 30.0 31.0
# CHECK: 0.0 1.0 2.0 3.0 4.0 5.0 6.0 7.0 8.0 9.0 10.0 11.0 12.0 13.0 14.0 15.0 16.0 17.0 18.0 19.0 20.0 21.0 22.0 23.0 24.0 25.0 26.0 27.0 28.0 29.0 30.0 31.0
# CHECK: 0.0 1.0 2.0 3.0 4.0 5.0 6.0 7.0 8.0 9.0 10.0 11.0 12.0 13.0 14.0 15.0 16.0 17.0 18.0 19.0 20.0 21.0 22.0 23.0 24.0 25.0 26.0 27.0 28.0 29.0 30.0 31.0
# CHECK: 32.0 33.0 34.0 35.0 36.0 37.0 38.0 39.0 40.0 41.0 42.0 43.0 44.0 45.0 46.0 47.0 48.0 49.0 50.0 51.0 52.0 53.0 54.0 55.0 56.0 57.0 58.0 59.0 60.0 61.0 62.0 63.0
# CHECK: 32.0 33.0 34.0 35.0 36.0 37.0 38.0 39.0 40.0 41.0 42.0 43.0 44.0 45.0 46.0 47.0 48.0 49.0 50.0 51.0 52.0 53.0 54.0 55.0 56.0 57.0 58.0 59.0 60.0 61.0 62.0 63.0
# CHECK: 32.0 33.0 34.0 35.0 36.0 37.0 38.0 39.0 40.0 41.0 42.0 43.0 44.0 45.0 46.0 47.0 48.0 49.0 50.0 51.0 52.0 53.0 54.0 55.0 56.0 57.0 58.0 59.0 60.0 61.0 62.0 63.0
# CHECK: 32.0 33.0 34.0 35.0 36.0 37.0 38.0 39.0 40.0 41.0 42.0 43.0 44.0 45.0 46.0 47.0 48.0 49.0 50.0 51.0 52.0 53.0 54.0 55.0 56.0 57.0 58.0 59.0 60.0 61.0 62.0 63.0
# CHECK: 0.0 1.0 2.0 3.0 4.0 5.0 6.0 7.0 8.0 9.0 10.0 11.0 12.0 13.0 14.0 15.0 16.0 17.0 18.0 19.0 20.0 21.0 22.0 23.0 24.0 25.0 26.0 27.0 28.0 29.0 30.0 31.0
# CHECK: 0.0 1.0 2.0 3.0 4.0 5.0 6.0 7.0 8.0 9.0 10.0 11.0 12.0 13.0 14.0 15.0 16.0 17.0 18.0 19.0 20.0 21.0 22.0 23.0 24.0 25.0 26.0 27.0 28.0 29.0 30.0 31.0
# CHECK: 0.0 1.0 2.0 3.0 4.0 5.0 6.0 7.0 8.0 9.0 10.0 11.0 12.0 13.0 14.0 15.0 16.0 17.0 18.0 19.0 20.0 21.0 22.0 23.0 24.0 25.0 26.0 27.0 28.0 29.0 30.0 31.0
# CHECK: 0.0 1.0 2.0 3.0 4.0 5.0 6.0 7.0 8.0 9.0 10.0 11.0 12.0 13.0 14.0 15.0 16.0 17.0 18.0 19.0 20.0 21.0 22.0 23.0 24.0 25.0 26.0 27.0 28.0 29.0 30.0 31.0
# CHECK: 32.0 33.0 34.0 35.0 36.0 37.0 38.0 39.0 40.0 41.0 42.0 43.0 44.0 45.0 46.0 47.0 48.0 49.0 50.0 51.0 52.0 53.0 54.0 55.0 56.0 57.0 58.0 59.0 60.0 61.0 62.0 63.0
# CHECK: 32.0 33.0 34.0 35.0 36.0 37.0 38.0 39.0 40.0 41.0 42.0 43.0 44.0 45.0 46.0 47.0 48.0 49.0 50.0 51.0 52.0 53.0 54.0 55.0 56.0 57.0 58.0 59.0 60.0 61.0 62.0 63.0
# CHECK: 32.0 33.0 34.0 35.0 36.0 37.0 38.0 39.0 40.0 41.0 42.0 43.0 44.0 45.0 46.0 47.0 48.0 49.0 50.0 51.0 52.0 53.0 54.0 55.0 56.0 57.0 58.0 59.0 60.0 61.0 62.0 63.0
# CHECK: 32.0 33.0 34.0 35.0 36.0 37.0 38.0 39.0 40.0 41.0 42.0 43.0 44.0 45.0 46.0 47.0 48.0 49.0 50.0 51.0 52.0 53.0 54.0 55.0 56.0 57.0 58.0 59.0 60.0 61.0 62.0 63.0
# CHECK: 0.0 1.0 2.0 3.0 4.0 5.0 6.0 7.0 8.0 9.0 10.0 11.0 12.0 13.0 14.0 15.0 16.0 17.0 18.0 19.0 20.0 21.0 22.0 23.0 24.0 25.0 26.0 27.0 28.0 29.0 30.0 31.0
# CHECK: 0.0 1.0 2.0 3.0 4.0 5.0 6.0 7.0 8.0 9.0 10.0 11.0 12.0 13.0 14.0 15.0 16.0 17.0 18.0 19.0 20.0 21.0 22.0 23.0 24.0 25.0 26.0 27.0 28.0 29.0 30.0 31.0
# CHECK: 0.0 1.0 2.0 3.0 4.0 5.0 6.0 7.0 8.0 9.0 10.0 11.0 12.0 13.0 14.0 15.0 16.0 17.0 18.0 19.0 20.0 21.0 22.0 23.0 24.0 25.0 26.0 27.0 28.0 29.0 30.0 31.0
# CHECK: 0.0 1.0 2.0 3.0 4.0 5.0 6.0 7.0 8.0 9.0 10.0 11.0 12.0 13.0 14.0 15.0 16.0 17.0 18.0 19.0 20.0 21.0 22.0 23.0 24.0 25.0 26.0 27.0 28.0 29.0 30.0 31.0
# CHECK: 32.0 33.0 34.0 35.0 36.0 37.0 38.0 39.0 40.0 41.0 42.0 43.0 44.0 45.0 46.0 47.0 48.0 49.0 50.0 51.0 52.0 53.0 54.0 55.0 56.0 57.0 58.0 59.0 60.0 61.0 62.0 63.0
# CHECK: 32.0 33.0 34.0 35.0 36.0 37.0 38.0 39.0 40.0 41.0 42.0 43.0 44.0 45.0 46.0 47.0 48.0 49.0 50.0 51.0 52.0 53.0 54.0 55.0 56.0 57.0 58.0 59.0 60.0 61.0 62.0 63.0
# CHECK: 32.0 33.0 34.0 35.0 36.0 37.0 38.0 39.0 40.0 41.0 42.0 43.0 44.0 45.0 46.0 47.0 48.0 49.0 50.0 51.0 52.0 53.0 54.0 55.0 56.0 57.0 58.0 59.0 60.0 61.0 62.0 63.0
# CHECK: 32.0 33.0 34.0 35.0 36.0 37.0 38.0 39.0 40.0 41.0 42.0 43.0 44.0 45.0 46.0 47.0 48.0 49.0 50.0 51.0 52.0 53.0 54.0 55.0 56.0 57.0 58.0 59.0 60.0 61.0 62.0 63.0
# CHECK-LABEL: == test_mma
# CHECK: 1240.0 3161.0 5082.0 7003.0 8924.0 10845.0 12766.0 14687.0 16608.0 18529.0 20450.0 22371.0 24292.0 26213.0 28134.0 30055.0 31976.0 33897.0 35818.0 37739.0 39660.0 41581.0 43502.0 45423.0 47344.0 49265.0 51186.0 53107.0 55028.0 56949.0 58870.0 60791.0
# CHECK: 3192.0 9209.0 15226.0 21243.0 27260.0 33277.0 39294.0 45311.0 51328.0 57345.0 63362.0 69379.0 75396.0 81413.0 87430.0 93447.0 99464.0 105481.0 111498.0 117515.0 123532.0 129549.0 135566.0 141583.0 147600.0 153617.0 159634.0 165651.0 171668.0 177685.0 183702.0 189719.0
# CHECK: 5144.0 15257.0 25370.0 35483.0 45596.0 55709.0 65822.0 75935.0 86048.0 96161.0 106274.0 116387.0 126500.0 136613.0 146726.0 156839.0 166952.0 177065.0 187178.0 197291.0 207404.0 217517.0 227630.0 237743.0 247856.0 257969.0 268082.0 278195.0 288308.0 298421.0 308534.0 318647.0
# CHECK: 7096.0 21305.0 35514.0 49723.0 63932.0 78141.0 92350.0 106559.0 120768.0 134977.0 149186.0 163395.0 177604.0 191813.0 206022.0 220231.0 234440.0 248649.0 262858.0 277067.0 291276.0 305485.0 319694.0 333903.0 348112.0 362321.0 376530.0 390739.0 404948.0 419157.0 433366.0 447575.0
# CHECK: 9048.0 27353.0 45658.0 63963.0 82268.0 100573.0 118878.0 137183.0 155488.0 173793.0 192098.0 210403.0 228708.0 247013.0 265318.0 283623.0 301928.0 320233.0 338538.0 356843.0 375148.0 393453.0 411758.0 430063.0 448368.0 466673.0 484978.0 503283.0 521588.0 539893.0 558198.0 576503.0
# CHECK: 11000.0 33401.0 55802.0 78203.0 100604.0 123005.0 145406.0 167807.0 190208.0 212609.0 235010.0 257411.0 279812.0 302213.0 324614.0 347015.0 369416.0 391817.0 414218.0 436619.0 459020.0 481421.0 503822.0 526223.0 548624.0 571025.0 593426.0 615827.0 638228.0 660629.0 683030.0 705431.0
# CHECK: 12952.0 39449.0 65946.0 92443.0 118940.0 145437.0 171934.0 198431.0 224928.0 251425.0 277922.0 304419.0 330916.0 357413.0 383910.0 410407.0 436904.0 463401.0 489898.0 516395.0 542892.0 569389.0 595886.0 622383.0 648880.0 675377.0 701874.0 728371.0 754868.0 781365.0 807862.0 834359.0
# CHECK: 14904.0 45497.0 76090.0 106683.0 137276.0 167869.0 198462.0 229055.0 259648.0 290241.0 320834.0 351427.0 382020.0 412613.0 443206.0 473799.0 504392.0 534985.0 565578.0 596171.0 626764.0 657357.0 687950.0 718543.0 749136.0 779729.0 810322.0 840915.0 871508.0 902101.0 932694.0 963287.0
# CHECK: 16856.0 51545.0 86234.0 120923.0 155612.0 190301.0 224990.0 259679.0 294368.0 329057.0 363746.0 398435.0 433124.0 467813.0 502502.0 537191.0 571880.0 606569.0 641258.0 675947.0 710636.0 745325.0 780014.0 814703.0 849392.0 884081.0 918770.0 953459.0 988148.0 1022837.0 1057526.0 1092215.0
# CHECK: 18808.0 57593.0 96378.0 135163.0 173948.0 212733.0 251518.0 290303.0 329088.0 367873.0 406658.0 445443.0 484228.0 523013.0 561798.0 600583.0 639368.0 678153.0 716938.0 755723.0 794508.0 833293.0 872078.0 910863.0 949648.0 988433.0 1027218.0 1066003.0 1104788.0 1143573.0 1182358.0 1221143.0
# CHECK: 20760.0 63641.0 106522.0 149403.0 192284.0 235165.0 278046.0 320927.0 363808.0 406689.0 449570.0 492451.0 535332.0 578213.0 621094.0 663975.0 706856.0 749737.0 792618.0 835499.0 878380.0 921261.0 964142.0 1007023.0 1049904.0 1092785.0 1135666.0 1178547.0 1221428.0 1264309.0 1307190.0 1350071.0
# CHECK: 22712.0 69689.0 116666.0 163643.0 210620.0 257597.0 304574.0 351551.0 398528.0 445505.0 492482.0 539459.0 586436.0 633413.0 680390.0 727367.0 774344.0 821321.0 868298.0 915275.0 962252.0 1009229.0 1056206.0 1103183.0 1150160.0 1197137.0 1244114.0 1291091.0 1338068.0 1385045.0 1432022.0 1478999.0
# CHECK: 24664.0 75737.0 126810.0 177883.0 228956.0 280029.0 331102.0 382175.0 433248.0 484321.0 535394.0 586467.0 637540.0 688613.0 739686.0 790759.0 841832.0 892905.0 943978.0 995051.0 1046124.0 1097197.0 1148270.0 1199343.0 1250416.0 1301489.0 1352562.0 1403635.0 1454708.0 1505781.0 1556854.0 1607927.0
# CHECK: 26616.0 81785.0 136954.0 192123.0 247292.0 302461.0 357630.0 412799.0 467968.0 523137.0 578306.0 633475.0 688644.0 743813.0 798982.0 854151.0 909320.0 964489.0 1019658.0 1074827.0 1129996.0 1185165.0 1240334.0 1295503.0 1350672.0 1405841.0 1461010.0 1516179.0 1571348.0 1626517.0 1681686.0 1736855.0
# CHECK: 28568.0 87833.0 147098.0 206363.0 265628.0 324893.0 384158.0 443423.0 502688.0 561953.0 621218.0 680483.0 739748.0 799013.0 858278.0 917543.0 976808.0 1036073.0 1095338.0 1154603.0 1213868.0 1273133.0 1332398.0 1391663.0 1450928.0 1510193.0 1569458.0 1628723.0 1687988.0 1747253.0 1806518.0 1865783.0
# CHECK: 30520.0 93881.0 157242.0 220603.0 283964.0 347325.0 410686.0 474047.0 537408.0 600769.0 664130.0 727491.0 790852.0 854213.0 917574.0 980935.0 1044296.0 1107657.0 1171018.0 1234379.0 1297740.0 1361101.0 1424462.0 1487823.0 1551184.0 1614545.0 1677906.0 1741267.0 1804628.0 1867989.0 1931350.0 1994711.0
# CHECK: 32472.0 99929.0 167386.0 234843.0 302300.0 369757.0 437214.0 504671.0 572128.0 639585.0 707042.0 774499.0 841956.0 909413.0 976870.0 1044327.0 1111784.0 1179241.0 1246698.0 1314155.0 1381612.0 1449069.0 1516526.0 1583983.0 1651440.0 1718897.0 1786354.0 1853811.0 1921268.0 1988725.0 2056182.0 2123639.0
# CHECK: 34424.0 105977.0 177530.0 249083.0 320636.0 392189.0 463742.0 535295.0 606848.0 678401.0 749954.0 821507.0 893060.0 964613.0 1036166.0 1107719.0 1179272.0 1250825.0 1322378.0 1393931.0 1465484.0 1537037.0 1608590.0 1680143.0 1751696.0 1823249.0 1894802.0 1966355.0 2037908.0 2109461.0 2181014.0 2252567.0
# CHECK: 36376.0 112025.0 187674.0 263323.0 338972.0 414621.0 490270.0 565919.0 641568.0 717217.0 792866.0 868515.0 944164.0 1019813.0 1095462.0 1171111.0 1246760.0 1322409.0 1398058.0 1473707.0 1549356.0 1625005.0 1700654.0 1776303.0 1851952.0 1927601.0 2003250.0 2078899.0 2154548.0 2230197.0 2305846.0 2381495.0
# CHECK: 38328.0 118073.0 197818.0 277563.0 357308.0 437053.0 516798.0 596543.0 676288.0 756033.0 835778.0 915523.0 995268.0 1075013.0 1154758.0 1234503.0 1314248.0 1393993.0 1473738.0 1553483.0 1633228.0 1712973.0 1792718.0 1872463.0 1952208.0 2031953.0 2111698.0 2191443.0 2271188.0 2350933.0 2430678.0 2510423.0
# CHECK: 40280.0 124121.0 207962.0 291803.0 375644.0 459485.0 543326.0 627167.0 711008.0 794849.0 878690.0 962531.0 1046372.0 1130213.0 1214054.0 1297895.0 1381736.0 1465577.0 1549418.0 1633259.0 1717100.0 1800941.0 1884782.0 1968623.0 2052464.0 2136305.0 2220146.0 2303987.0 2387828.0 2471669.0 2555510.0 2639351.0
# CHECK: 42232.0 130169.0 218106.0 306043.0 393980.0 481917.0 569854.0 657791.0 745728.0 833665.0 921602.0 1009539.0 1097476.0 1185413.0 1273350.0 1361287.0 1449224.0 1537161.0 1625098.0 1713035.0 1800972.0 1888909.0 1976846.0 2064783.0 2152720.0 2240657.0 2328594.0 2416531.0 2504468.0 2592405.0 2680342.0 2768279.0
# CHECK: 44184.0 136217.0 228250.0 320283.0 412316.0 504349.0 596382.0 688415.0 780448.0 872481.0 964514.0 1056547.0 1148580.0 1240613.0 1332646.0 1424679.0 1516712.0 1608745.0 1700778.0 1792811.0 1884844.0 1976877.0 2068910.0 2160943.0 2252976.0 2345009.0 2437042.0 2529075.0 2621108.0 2713141.0 2805174.0 2897207.0
# CHECK: 46136.0 142265.0 238394.0 334523.0 430652.0 526781.0 622910.0 719039.0 815168.0 911297.0 1007426.0 1103555.0 1199684.0 1295813.0 1391942.0 1488071.0 1584200.0 1680329.0 1776458.0 1872587.0 1968716.0 2064845.0 2160974.0 2257103.0 2353232.0 2449361.0 2545490.0 2641619.0 2737748.0 2833877.0 2930006.0 3026135.0
# CHECK: 48088.0 148313.0 248538.0 348763.0 448988.0 549213.0 649438.0 749663.0 849888.0 950113.0 1050338.0 1150563.0 1250788.0 1351013.0 1451238.0 1551463.0 1651688.0 1751913.0 1852138.0 1952363.0 2052588.0 2152813.0 2253038.0 2353263.0 2453488.0 2553713.0 2653938.0 2754163.0 2854388.0 2954613.0 3054838.0 3155063.0
# CHECK: 50040.0 154361.0 258682.0 363003.0 467324.0 571645.0 675966.0 780287.0 884608.0 988929.0 1093250.0 1197571.0 1301892.0 1406213.0 1510534.0 1614855.0 1719176.0 1823497.0 1927818.0 2032139.0 2136460.0 2240781.0 2345102.0 2449423.0 2553744.0 2658065.0 2762386.0 2866707.0 2971028.0 3075349.0 3179670.0 3283991.0
# CHECK: 51992.0 160409.0 268826.0 377243.0 485660.0 594077.0 702494.0 810911.0 919328.0 1027745.0 1136162.0 1244579.0 1352996.0 1461413.0 1569830.0 1678247.0 1786664.0 1895081.0 2003498.0 2111915.0 2220332.0 2328749.0 2437166.0 2545583.0 2654000.0 2762417.0 2870834.0 2979251.0 3087668.0 3196085.0 3304502.0 3412919.0
# CHECK: 53944.0 166457.0 278970.0 391483.0 503996.0 616509.0 729022.0 841535.0 954048.0 1066561.0 1179074.0 1291587.0 1404100.0 1516613.0 1629126.0 1741639.0 1854152.0 1966665.0 2079178.0 2191691.0 2304204.0 2416717.0 2529230.0 2641743.0 2754256.0 2866769.0 2979282.0 3091795.0 3204308.0 3316821.0 3429334.0 3541847.0
# CHECK: 55896.0 172505.0 289114.0 405723.0 522332.0 638941.0 755550.0 872159.0 988768.0 1105377.0 1221986.0 1338595.0 1455204.0 1571813.0 1688422.0 1805031.0 1921640.0 2038249.0 2154858.0 2271467.0 2388076.0 2504685.0 2621294.0 2737903.0 2854512.0 2971121.0 3087730.0 3204339.0 3320948.0 3437557.0 3554166.0 3670775.0
# CHECK: 57848.0 178553.0 299258.0 419963.0 540668.0 661373.0 782078.0 902783.0 1023488.0 1144193.0 1264898.0 1385603.0 1506308.0 1627013.0 1747718.0 1868423.0 1989128.0 2109833.0 2230538.0 2351243.0 2471948.0 2592653.0 2713358.0 2834063.0 2954768.0 3075473.0 3196178.0 3316883.0 3437588.0 3558293.0 3678998.0 3799703.0
# CHECK: 59800.0 184601.0 309402.0 434203.0 559004.0 683805.0 808606.0 933407.0 1058208.0 1183009.0 1307810.0 1432611.0 1557412.0 1682213.0 1807014.0 1931815.0 2056616.0 2181417.0 2306218.0 2431019.0 2555820.0 2680621.0 2805422.0 2930223.0 3055024.0 3179825.0 3304626.0 3429427.0 3554228.0 3679029.0 3803830.0 3928631.0
# CHECK: 61752.0 190649.0 319546.0 448443.0 577340.0 706237.0 835134.0 964031.0 1092928.0 1221825.0 1350722.0 1479619.0 1608516.0 1737413.0 1866310.0 1995207.0 2124104.0 2253001.0 2381898.0 2510795.0 2639692.0 2768589.0 2897486.0 3026383.0 3155280.0 3284177.0 3413074.0 3541971.0 3670868.0 3799765.0 3928662.0 4057559.0


def test_load_and_mma_f32_f16_32x32x16_transpose(ctx: DeviceContext):
    print("== test_load_and_mma_f32_f16_32x32x16_transpose")
    test_load_and_mma_and_multiply_operands[
        DType.float32, DType.float16, Index(32, 32, 16), True
    ](ctx)


# CHECK-LABEL: == test_load_and_mma_f32_f8_16x16x32
# CHECK-LABEL: == test_load_a
# CHECK: 0.0 0.1015625 0.203125 0.3125 0.40625 0.5 0.625 0.6875 0.8125 0.875 1.0 1.125 1.25 1.25 1.375 1.5 1.625 1.75 1.75 1.875 2.0 2.0 2.25 2.25 2.5 2.5 2.5 2.75 2.75 3.0 3.0 3.0 3.25 3.25 3.5 3.5 3.5 3.75 3.75 4.0 4.0 4.0 4.0 4.5 4.5 4.5 4.5 4.5 5.0 5.0 5.0 5.0 5.0 5.5 5.5 5.5 5.5 5.5 6.0 6.0 6.0 6.0 6.0 6.5
# CHECK-LABEL: == test_load_b
# CHECK: 0.0 0.203125 0.40625 0.625 0.8125 1.0 1.25 1.375 1.625 1.75 2.0 2.25 2.5 2.5 2.75 3.0 0.8125 1.0 1.25 1.375 1.625 1.75 2.0 2.25 2.5 2.5 2.75 3.0 3.25 3.5 3.5 3.75 1.625 1.75 2.0 2.25 2.5 2.5 2.75 3.0 3.25 3.5 3.5 3.75 4.0 4.0 4.5 4.5 2.5 2.5 2.75 3.0 3.25 3.5 3.5 3.75 4.0 4.0 4.5 4.5 5.0 5.0 5.0 5.5
# CHECK-LABEL: == test_load_c
# CHECK: 0.0 16.0 32.0 48.0
# CHECK: 1.0 17.0 33.0 49.0
# CHECK: 2.0 18.0 34.0 50.0
# CHECK: 3.0 19.0 35.0 51.0
# CHECK: 4.0 20.0 36.0 52.0
# CHECK: 5.0 21.0 37.0 53.0
# CHECK: 6.0 22.0 38.0 54.0
# CHECK: 7.0 23.0 39.0 55.0
# CHECK: 8.0 24.0 40.0 56.0
# CHECK: 9.0 25.0 41.0 57.0
# CHECK: 10.0 26.0 42.0 58.0
# CHECK: 11.0 27.0 43.0 59.0
# CHECK: 12.0 28.0 44.0 60.0
# CHECK: 13.0 29.0 45.0 61.0
# CHECK: 14.0 30.0 46.0 62.0
# CHECK: 15.0 31.0 47.0 63.0
# CHECK: 64.0 80.0 96.0 112.0
# CHECK: 65.0 81.0 97.0 113.0
# CHECK: 66.0 82.0 98.0 114.0
# CHECK: 67.0 83.0 99.0 115.0
# CHECK: 68.0 84.0 100.0 116.0
# CHECK: 69.0 85.0 101.0 117.0
# CHECK: 70.0 86.0 102.0 118.0
# CHECK: 71.0 87.0 103.0 119.0
# CHECK: 72.0 88.0 104.0 120.0
# CHECK: 73.0 89.0 105.0 121.0
# CHECK: 74.0 90.0 106.0 122.0
# CHECK: 75.0 91.0 107.0 123.0
# CHECK: 76.0 92.0 108.0 124.0
# CHECK: 77.0 93.0 109.0 125.0
# CHECK: 78.0 94.0 110.0 126.0
# CHECK: 79.0 95.0 111.0 127.0
# CHECK: 128.0 144.0 160.0 176.0
# CHECK: 129.0 145.0 161.0 177.0
# CHECK: 130.0 146.0 162.0 178.0
# CHECK: 131.0 147.0 163.0 179.0
# CHECK: 132.0 148.0 164.0 180.0
# CHECK: 133.0 149.0 165.0 181.0
# CHECK: 134.0 150.0 166.0 182.0
# CHECK: 135.0 151.0 167.0 183.0
# CHECK: 136.0 152.0 168.0 184.0
# CHECK: 137.0 153.0 169.0 185.0
# CHECK: 138.0 154.0 170.0 186.0
# CHECK: 139.0 155.0 171.0 187.0
# CHECK: 140.0 156.0 172.0 188.0
# CHECK: 141.0 157.0 173.0 189.0
# CHECK: 142.0 158.0 174.0 190.0
# CHECK: 143.0 159.0 175.0 191.0
# CHECK: 192.0 208.0 224.0 240.0
# CHECK: 193.0 209.0 225.0 241.0
# CHECK: 194.0 210.0 226.0 242.0
# CHECK: 195.0 211.0 227.0 243.0
# CHECK: 196.0 212.0 228.0 244.0
# CHECK: 197.0 213.0 229.0 245.0
# CHECK: 198.0 214.0 230.0 246.0
# CHECK: 199.0 215.0 231.0 247.0
# CHECK: 200.0 216.0 232.0 248.0
# CHECK: 201.0 217.0 233.0 249.0
# CHECK: 202.0 218.0 234.0 250.0
# CHECK: 203.0 219.0 235.0 251.0
# CHECK: 204.0 220.0 236.0 252.0
# CHECK: 205.0 221.0 237.0 253.0
# CHECK: 206.0 222.0 238.0 254.0
# CHECK: 207.0 223.0 239.0 255.0
# CHECK-LABEL: == test_load_d
# CHECK: 0.0 1.0 2.0 3.0 4.0 5.0 6.0 7.0 8.0 9.0 10.0 11.0 12.0 13.0 14.0 15.0
# CHECK: 0.0 1.0 2.0 3.0 4.0 5.0 6.0 7.0 8.0 9.0 10.0 11.0 12.0 13.0 14.0 15.0
# CHECK: 0.0 1.0 2.0 3.0 4.0 5.0 6.0 7.0 8.0 9.0 10.0 11.0 12.0 13.0 14.0 15.0
# CHECK: 0.0 1.0 2.0 3.0 4.0 5.0 6.0 7.0 8.0 9.0 10.0 11.0 12.0 13.0 14.0 15.0
# CHECK: 16.0 17.0 18.0 19.0 20.0 21.0 22.0 23.0 24.0 25.0 26.0 27.0 28.0 29.0 30.0 31.0
# CHECK: 16.0 17.0 18.0 19.0 20.0 21.0 22.0 23.0 24.0 25.0 26.0 27.0 28.0 29.0 30.0 31.0
# CHECK: 16.0 17.0 18.0 19.0 20.0 21.0 22.0 23.0 24.0 25.0 26.0 27.0 28.0 29.0 30.0 31.0
# CHECK: 16.0 17.0 18.0 19.0 20.0 21.0 22.0 23.0 24.0 25.0 26.0 27.0 28.0 29.0 30.0 31.0
# CHECK: 32.0 33.0 34.0 35.0 36.0 37.0 38.0 39.0 40.0 41.0 42.0 43.0 44.0 45.0 46.0 47.0
# CHECK: 32.0 33.0 34.0 35.0 36.0 37.0 38.0 39.0 40.0 41.0 42.0 43.0 44.0 45.0 46.0 47.0
# CHECK: 32.0 33.0 34.0 35.0 36.0 37.0 38.0 39.0 40.0 41.0 42.0 43.0 44.0 45.0 46.0 47.0
# CHECK: 32.0 33.0 34.0 35.0 36.0 37.0 38.0 39.0 40.0 41.0 42.0 43.0 44.0 45.0 46.0 47.0
# CHECK: 48.0 49.0 50.0 51.0 52.0 53.0 54.0 55.0 56.0 57.0 58.0 59.0 60.0 61.0 62.0 63.0
# CHECK: 48.0 49.0 50.0 51.0 52.0 53.0 54.0 55.0 56.0 57.0 58.0 59.0 60.0 61.0 62.0 63.0
# CHECK: 48.0 49.0 50.0 51.0 52.0 53.0 54.0 55.0 56.0 57.0 58.0 59.0 60.0 61.0 62.0 63.0
# CHECK: 48.0 49.0 50.0 51.0 52.0 53.0 54.0 55.0 56.0 57.0 58.0 59.0 60.0 61.0 62.0 63.0
# CHECK-LABEL: == test_mma
# CHECK: 207.33166 228.01758 249.39844 269.90723 291.13086 311.44726 332.21094 353.69922 372.70703 395.33398 415.6328 436.3789 458.0078 477.01953 499.53125 519.6797
# CHECK: 229.07861 250.54797 272.70923 293.98926 315.9419 336.6875 358.25195 380.4209 400.00098 423.54492 444.3125 466.11914 488.17578 507.61328 531.06055 551.91406
# CHECK: 249.3518 271.4768 294.28174 316.25 338.60644 359.97266 382.23047 404.98242 425.2832 449.3047 470.92188 493.1836 515.6953 535.90625 559.96484 581.59375
# CHECK: 270.95996 293.81152 317.38476 339.6914 362.7539 384.90625 407.8203 431.35938 452.10156 477.01563 499.17187 521.8594 545.34375 566.1094 591.1406 613.1719
# CHECK: 291.01758 314.56104 338.4541 361.42188 385.14258 407.95312 431.46875 455.45703 476.89453 502.35156 524.9531 548.47656 572.4219 594.0 619.46094 641.9219
# CHECK: 312.42725 336.29688 360.9297 384.63672 409.08594 432.58594 456.48438 481.23437 503.3125 529.28906 552.78125 576.7344 601.6875 623.6406 649.5 672.84375
# CHECK: 333.53174 358.18555 383.5586 407.9961 433.21875 457.08594 481.8125 507.21875 529.84375 556.7422 580.6875 605.7031 631.0625 653.4219 680.28125 704.1875
# CHECK: 354.44238 379.78418 405.8418 431.0078 456.52734 481.0625 506.53125 532.5547 555.9297 583.21875 608.03125 633.5469 659.28125 682.5625 709.9531 734.78125
# CHECK: 375.39844 401.4541 428.2832 453.72656 479.98828 505.26562 531.34375 558.1797 581.96094 610.1406 635.46875 661.3906 688.15625 711.84375 740.2656 765.46875
# CHECK: 396.12598 422.85742 449.98047 476.1328 503.10156 529.0781 555.8125 583.0 607.5156 636.2969 662.125 688.90625 716.0625 740.71875 769.5 795.0625
# CHECK: 416.875 443.94922 471.8047 498.64844 526.2969 553.0 580.0469 608.0156 633.1406 662.40625 689.125 716.3125 744.46875 769.46875 798.625 825.125
# CHECK: 438.63086 466.47852 495.1211 522.75 551.22656 578.2031 606.1406 634.8281 660.5469 690.78125 717.875 746.15625 774.78125 800.125 830.4375 857.4375
# CHECK: 458.90723 487.42187 516.72656 545.0781 573.78125 601.4531 630.0781 659.3281 685.8125 716.3906 744.34375 773.09375 802.0625 828.375 859.0625 887.03125
# CHECK: 480.48438 509.76172 539.8281 568.4375 597.9375 626.40625 655.6875 685.8125 712.6094 744.125 772.65625 801.875 831.90625 858.5625 890.4375 918.71875
# CHECK: 500.60644 530.49805 560.85547 590.14844 620.28906 649.3906 679.34375 709.7344 737.2656 769.3281 798.3125 828.375 858.75 886.34375 918.53125 947.125
# CHECK: 521.9414 552.2539 583.3594 613.41406 644.3125 674.21875 704.4219 735.6719 763.90625 796.53125 826.46875 856.875 888.3125 916.34375 948.875 978.59375


def test_load_and_mma_f32_f8_16x16x32(ctx: DeviceContext):
    print("== test_load_and_mma_f32_f8_16x16x32")
    test_load_and_mma_and_multiply_operands[
        DType.float32, fp8_dtype, Index(16, 16, 32), False
    ](ctx)


# CHECK-LABEL: == test_load_and_mma_f32_f8_16x16x32_transpose
# CHECK-LABEL: == test_load_a
# CHECK: 0.0 0.1015625 0.203125 0.3125 0.40625 0.5 0.625 0.6875 0.8125 0.875 1.0 1.125 1.25 1.25 1.375 1.5 1.625 1.75 1.75 1.875 2.0 2.0 2.25 2.25 2.5 2.5 2.5 2.75 2.75 3.0 3.0 3.0 3.25 3.25 3.5 3.5 3.5 3.75 3.75 4.0 4.0 4.0 4.0 4.5 4.5 4.5 4.5 4.5 5.0 5.0 5.0 5.0 5.0 5.5 5.5 5.5 5.5 5.5 6.0 6.0 6.0 6.0 6.0 6.
# CHECK-LABEL: == test_load_b
# CHECK: 0.0 0.1015625 0.203125 0.3125 0.40625 0.5 0.625 0.6875 0.8125 0.875 1.0 1.125 1.25 1.25 1.375 1.5 1.625 1.75 1.75 1.875 2.0 2.0 2.25 2.25 2.5 2.5 2.5 2.75 2.75 3.0 3.0 3.0 3.25 3.25 3.5 3.5 3.5 3.75 3.75 4.0 4.0 4.0 4.0 4.5 4.5 4.5 4.5 4.5 5.0 5.0 5.0 5.0 5.0 5.5 5.5 5.5 5.5 5.5 6.0 6.0 6.0 6.0 6.0 6.
# CHECK-LABEL: == test_load_c
# CHECK: 0.0 16.0 32.0 48.0
# CHECK: 1.0 17.0 33.0 49.0
# CHECK: 2.0 18.0 34.0 50.0
# CHECK: 3.0 19.0 35.0 51.0
# CHECK: 4.0 20.0 36.0 52.0
# CHECK: 5.0 21.0 37.0 53.0
# CHECK: 6.0 22.0 38.0 54.0
# CHECK: 7.0 23.0 39.0 55.0
# CHECK: 8.0 24.0 40.0 56.0
# CHECK: 9.0 25.0 41.0 57.0
# CHECK: 10.0 26.0 42.0 58.0
# CHECK: 11.0 27.0 43.0 59.0
# CHECK: 12.0 28.0 44.0 60.0
# CHECK: 13.0 29.0 45.0 61.0
# CHECK: 14.0 30.0 46.0 62.0
# CHECK: 15.0 31.0 47.0 63.0
# CHECK: 64.0 80.0 96.0 112.0
# CHECK: 65.0 81.0 97.0 113.0
# CHECK: 66.0 82.0 98.0 114.0
# CHECK: 67.0 83.0 99.0 115.0
# CHECK: 68.0 84.0 100.0 116.0
# CHECK: 69.0 85.0 101.0 117.0
# CHECK: 70.0 86.0 102.0 118.0
# CHECK: 71.0 87.0 103.0 119.0
# CHECK: 72.0 88.0 104.0 120.0
# CHECK: 73.0 89.0 105.0 121.0
# CHECK: 74.0 90.0 106.0 122.0
# CHECK: 75.0 91.0 107.0 123.0
# CHECK: 76.0 92.0 108.0 124.0
# CHECK: 77.0 93.0 109.0 125.0
# CHECK: 78.0 94.0 110.0 126.0
# CHECK: 79.0 95.0 111.0 127.0
# CHECK: 128.0 144.0 160.0 176.0
# CHECK: 129.0 145.0 161.0 177.0
# CHECK: 130.0 146.0 162.0 178.0
# CHECK: 131.0 147.0 163.0 179.0
# CHECK: 132.0 148.0 164.0 180.0
# CHECK: 133.0 149.0 165.0 181.0
# CHECK: 134.0 150.0 166.0 182.0
# CHECK: 135.0 151.0 167.0 183.0
# CHECK: 136.0 152.0 168.0 184.0
# CHECK: 137.0 153.0 169.0 185.0
# CHECK: 138.0 154.0 170.0 186.0
# CHECK: 139.0 155.0 171.0 187.0
# CHECK: 140.0 156.0 172.0 188.0
# CHECK: 141.0 157.0 173.0 189.0
# CHECK: 142.0 158.0 174.0 190.0
# CHECK: 143.0 159.0 175.0 191.0
# CHECK: 192.0 208.0 224.0 240.0
# CHECK: 193.0 209.0 225.0 241.0
# CHECK: 194.0 210.0 226.0 242.0
# CHECK: 195.0 211.0 227.0 243.0
# CHECK: 196.0 212.0 228.0 244.0
# CHECK: 197.0 213.0 229.0 245.0
# CHECK: 198.0 214.0 230.0 246.0
# CHECK: 199.0 215.0 231.0 247.0
# CHECK: 200.0 216.0 232.0 248.0
# CHECK: 201.0 217.0 233.0 249.0
# CHECK: 202.0 218.0 234.0 250.0
# CHECK: 203.0 219.0 235.0 251.0
# CHECK: 204.0 220.0 236.0 252.0
# CHECK: 205.0 221.0 237.0 253.0
# CHECK: 206.0 222.0 238.0 254.0
# CHECK: 207.0 223.0 239.0 255.0
# CHECK-LABEL: == test_load_d
# CHECK: 0.0 1.0 2.0 3.0 4.0 5.0 6.0 7.0 8.0 9.0 10.0 11.0 12.0 13.0 14.0 15.0
# CHECK: 0.0 1.0 2.0 3.0 4.0 5.0 6.0 7.0 8.0 9.0 10.0 11.0 12.0 13.0 14.0 15.0
# CHECK: 0.0 1.0 2.0 3.0 4.0 5.0 6.0 7.0 8.0 9.0 10.0 11.0 12.0 13.0 14.0 15.0
# CHECK: 0.0 1.0 2.0 3.0 4.0 5.0 6.0 7.0 8.0 9.0 10.0 11.0 12.0 13.0 14.0 15.0
# CHECK: 16.0 17.0 18.0 19.0 20.0 21.0 22.0 23.0 24.0 25.0 26.0 27.0 28.0 29.0 30.0 31.0
# CHECK: 16.0 17.0 18.0 19.0 20.0 21.0 22.0 23.0 24.0 25.0 26.0 27.0 28.0 29.0 30.0 31.0
# CHECK: 16.0 17.0 18.0 19.0 20.0 21.0 22.0 23.0 24.0 25.0 26.0 27.0 28.0 29.0 30.0 31.0
# CHECK: 16.0 17.0 18.0 19.0 20.0 21.0 22.0 23.0 24.0 25.0 26.0 27.0 28.0 29.0 30.0 31.0
# CHECK: 32.0 33.0 34.0 35.0 36.0 37.0 38.0 39.0 40.0 41.0 42.0 43.0 44.0 45.0 46.0 47.0
# CHECK: 32.0 33.0 34.0 35.0 36.0 37.0 38.0 39.0 40.0 41.0 42.0 43.0 44.0 45.0 46.0 47.0
# CHECK: 32.0 33.0 34.0 35.0 36.0 37.0 38.0 39.0 40.0 41.0 42.0 43.0 44.0 45.0 46.0 47.0
# CHECK: 32.0 33.0 34.0 35.0 36.0 37.0 38.0 39.0 40.0 41.0 42.0 43.0 44.0 45.0 46.0 47.0
# CHECK: 48.0 49.0 50.0 51.0 52.0 53.0 54.0 55.0 56.0 57.0 58.0 59.0 60.0 61.0 62.0 63.0
# CHECK: 48.0 49.0 50.0 51.0 52.0 53.0 54.0 55.0 56.0 57.0 58.0 59.0 60.0 61.0 62.0 63.0
# CHECK: 48.0 49.0 50.0 51.0 52.0 53.0 54.0 55.0 56.0 57.0 58.0 59.0 60.0 61.0 62.0 63.0
# CHECK: 48.0 49.0 50.0 51.0 52.0 53.0 54.0 55.0 56.0 57.0 58.0 59.0 60.0 61.0 62.0 63.0
# CHECK-LABEL: == test_mma
# CHECK: 414.66333 427.15723 436.7036 448.91992 458.03516 469.8545 481.06348 491.88477 502.79687 513.25195 523.75 536.2617 545.81445 557.96875 567.2129 578.8828
# CHECK: 442.15723 455.75244 465.39368 477.80518 487.09595 499.10156 511.333 522.32764 533.41846 544.01856 554.7344 568.22363 577.9785 590.291 599.64746 611.6367
# CHECK: 466.7036 480.39368 490.91333 503.40723 512.9536 525.1699 537.53516 549.3545 560.5635 571.38477 582.2969 596.00195 606.5 619.0117 628.56445 640.71875
# CHECK: 493.91992 507.80518 518.4072 531.9922 541.62305 554.02344 566.5547 578.5508 590.7695 601.7578 612.83594 626.6797 637.3828 650.8594 660.60156 672.91406
# CHECK: 518.03516 532.09595 542.9536 556.62305 567.1221 579.59375 592.3711 604.56836 616.9082 628.71484 639.89844 653.95703 664.84375 678.52344 688.9961 701.5078
# CHECK: 544.8545 559.10156 570.1699 584.02344 594.59375 608.1445 620.9961 633.3672 645.8594 657.83594 670.0156 684.2344 695.27344 709.0781 719.7422 733.21875
# CHECK: 571.0635 586.333 597.53516 611.5547 622.3711 635.9961 649.957 662.3906 675.1172 687.28906 699.5781 714.8594 725.9922 740.0 750.83594 764.5156
# CHECK: 596.88477 612.32764 624.3545 638.5508 649.56836 663.3672 677.3906 690.89453 703.6836 716.02344 728.4531 743.89844 756.0156 770.1719 781.14844 794.9531
# CHECK: 622.7969 638.41846 650.5635 665.76953 676.9082 690.8594 705.1172 718.6836 732.5664 744.96094 757.6094 773.2422 785.4531 800.65625 811.71094 825.71875
# CHECK: 648.25195 664.01856 676.38477 691.7578 703.71484 717.83594 732.28906 746.02344 759.96094 773.4219 786.125 801.9219 814.2656 829.625 841.65625 855.8125
# CHECK: 673.75 689.7344 702.2969 717.83594 729.89844 745.0156 759.5781 773.4531 787.6094 801.125 814.90625 830.75 843.2969 858.8281 870.9375 886.1406
# CHECK: 701.2617 718.22363 731.00195 746.6797 758.957 774.2344 789.8594 803.89844 818.2422 831.9219 845.75 862.90625 875.5 891.1875 903.4219 918.78125
# CHECK: 725.81445 742.9785 756.5 772.3828 784.84375 800.27344 815.9922 831.0156 845.4531 859.2656 873.2969 890.5 904.15625 919.875 932.2969 947.8281
# CHECK: 752.96875 770.291 784.0117 800.8594 813.52344 829.0781 845.0 860.1719 875.65625 889.625 903.8281 921.1875 934.875 951.8906 964.34375 980.03125
# CHECK: 777.2129 794.64746 808.56445 825.60156 838.9961 854.7422 870.83594 886.14844 901.71094 916.65625 930.9375 948.4219 962.2969 979.34375 992.84375 1008.5625
# CHECK: 803.8828 821.6367 835.71875 852.91406 866.5078 883.21875 899.5156 914.9531 930.71875 945.8125 961.1406 978.78125 992.8281 1010.03125 1023.5625 1040.5781


def test_load_and_mma_f32_f8_16x16x32_transpose(ctx: DeviceContext):
    print("== test_load_and_mma_f32_f8_16x16x32_transpose")
    test_load_and_mma_and_multiply_operands[
        DType.float32, fp8_dtype, Index(16, 16, 32), True
    ](ctx)


def main():
    with DeviceContext() as ctx:
        test_load_and_mma_f32_bf16_32x32x16(ctx)
        test_load_and_mma_f32_bf16_32x32x16_transpose(ctx)
        test_load_and_mma_f32_f16_32x32x16(ctx)
        test_load_and_mma_f32_f16_32x32x16_transpose(ctx)

        test_load_and_mma_f32_f8_16x16x32(ctx)
        test_load_and_mma_f32_f8_16x16x32_transpose(ctx)
