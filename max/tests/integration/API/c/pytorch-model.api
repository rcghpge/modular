// REQUIRES: mtorch
// RUN: MODEL=%S/../../Inputs/relu3x100x100.torchscript
// RUN: modular-api-executor --compile-specs=?x3x100x100xf32 --print-metadata $MODEL | FileCheck %s
// RUN: modular-api-executor --compile-specs=?x3x100x100xf32 --input-specs=1x3x100x100xf32 --print-metadata $MODEL | FileCheck %s --check-prefix=CHECK-PREFER-COMPILE-SPECS
// RUN: modular-api-executor --compile-specs=?x3x100x100xf32 --input-dim-names="batch;-;-;-" --print-metadata $MODEL | FileCheck %s --check-prefix=CHECK-INPUT-DIM-NAMES
// RUN: modular-api-executor --input-specs=1x3x100x100xf32 --print-metadata $MODEL | FileCheck %s --check-prefix=CHECK-FALLBACK-INPUT-SPECS
// RUN: modular-api-executor --compile-specs=?x3x100x100xf32 --input-specs=1x3x100x100xf32 --input-names=x --result-output-style=full $MODEL | FileCheck %s --check-prefix=CHECK-EXECUTE

// CHECK: Inputs:
// CHECK: - name: x
// CHECK:   spec: -1x3x100x100xf32
// CHECK: Outputs:
// CHECK: - name: result0
// CHECK:   spec: -1x3x100x100xf32


// CHECK-PREFER-COMPILE-SPECS: Inputs:
// CHECK-PREFER-COMPILE-SPECS: - name: x
// CHECK-PREFER-COMPILE-SPECS:   spec: -1x3x100x100xf32
// CHECK-PREFER-COMPILE-SPECS: Outputs:
// CHECK-PREFER-COMPILE-SPECS: - name: result0
// CHECK-PREFER-COMPILE-SPECS:   spec: -1x3x100x100xf32

// CHECK-INPUT-DIM-NAMES: Inputs:
// CHECK-INPUT-DIM-NAMES: - name: x
// CHECK-INPUT-DIM-NAMES:   spec: -1x3x100x100xf32
// CHECK-INPUT-DIM-NAMES: Outputs:
// CHECK-INPUT-DIM-NAMES: - name: result0
// CHECK-INPUT-DIM-NAMES:   spec: -1x3x100x100xf32

// CHECK-FALLBACK-INPUT-SPECS: Inputs:
// CHECK-FALLBACK-INPUT-SPECS: - name: x
// CHECK-FALLBACK-INPUT-SPECS:   spec: 1x3x100x100xf32
// CHECK-FALLBACK-INPUT-SPECS: Outputs:
// CHECK-FALLBACK-INPUT-SPECS: - name: result0
// CHECK-FALLBACK-INPUT-SPECS:   spec: 1x3x100x100xf32

// CHECK-EXECUTE: 'benchmark' returned tensor{{.*}}1x3x100x100xf32
