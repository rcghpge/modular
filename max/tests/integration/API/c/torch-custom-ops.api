// REQUIRES: mtorch
// REQUIRES: pytorch-generated-tests
// RUN: modular-api-executor --torch-library-paths="%libpython" --torch-library-paths="%libtorch_python" --torch-library-paths="%libtorchvision" --compile-specs=2xf32 --print-metadata %pytorch_generated_tests_dir/TorchVisionOps.pt | FileCheck %s --check-prefix=CHECK-METADATA
// RUN: modular-api-executor --torch-library-paths="%libpython" --torch-library-paths="%libtorch_python" --torch-library-paths="%libtorchvision" --model-inputs=ones --input-specs=2xf32 --result-output-style=full %pytorch_generated_tests_dir/TorchVisionOps.pt | FileCheck %s --check-prefix=CHECK-EXECUTE

// CHECK-METADATA: Inputs:
// CHECK-METADATA: - name: scores
// CHECK-METADATA:   spec: 2xf32
// CHECK-METADATA: Outputs:
// CHECK-METADATA: - name: result0
// CHECK-METADATA:   spec: *xf32

// Test if the `torchvision.ops.nms` custom operation works.
// CHECK-EXECUTE: 'benchmark' returned tensor{{.*}}<2xf32>
