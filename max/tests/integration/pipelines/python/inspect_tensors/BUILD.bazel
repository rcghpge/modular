load("//bazel:api.bzl", "modular_py_binary", "requirement")

package(
    default_visibility = ["//visibility:public"],
)

modular_py_binary(
    name = "inspect_tensors",
    testonly = True,
    srcs = [
        "__init__.py",
        "cli.py",
        "inspect_tensors.py",
    ],
    imports = [
        "../../../..",
        "//SDK/integration-test/pipelines/python",
    ],
    main = "cli.py",
    deps = [
        "//SDK/integration-test/pipelines/python/test_common",
        "//SDK/lib/API/python/max",
        "//SDK/lib/API/python/max/driver",
        "//SDK/lib/API/python/max/entrypoints",
        "//SDK/lib/API/python/max/interfaces",
        "//SDK/lib/API/python/max/nn",
        "//SDK/lib/API/python/max/nn/hooks",
        "//SDK/lib/API/python/max/pipelines",
        requirement("click"),
        requirement("torch"),
        requirement("transformers"),
        requirement("safetensors"),
    ],
)
